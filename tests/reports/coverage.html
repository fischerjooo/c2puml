<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Code Coverage Report</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f9f9f9;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            line-height: 1.6;
            color: #333;
        }
        pre {
            background-color: #fff;
            color: #111;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: Consolas, Monaco, 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            margin: 1rem 0;
            border: 1px solid #eee;
        }
        code {
            white-space: pre;
        }
        .line-number {
            color: #858585;
            margin-right: 1rem;
            user-select: none;
        }
        .covered {
            color: #111;
        }
        .uncovered {
            color: #f44336;
        }
        .context {
            background-color: #ffeaea;
        }
        .legend {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 0.5rem;
            border-radius: 3px;
        }
        .footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: #7f8c8d;
            border-top: 1px solid #ecf0f1;
        }
    </style>
</head>
<body>
    <h1>Code Coverage Report</h1>
    <p>Generated on 2025-07-25 15:08:29</p>
<h1>ðŸ“Š Detailed Coverage Report</h1>
<p>This report shows all uncovered code lines with context, highlighting which lines are covered and which are not.</p>
<div class="stats">

    <div class="stat">
        <div class="stat-number">84.34%</div>
        <div class="stat-label">Total Coverage</div>
    </div>

    <div class="stat">
        <div class="stat-number">2,963</div>
        <div class="stat-label">Total Statements</div>
    </div>

    <div class="stat">
        <div class="stat-number">464</div>
        <div class="stat-label">Missing Statements</div>
    </div>

    <div class="stat">
        <div class="stat-number">10</div>
        <div class="stat-label">Files with Issues</div>
    </div>
</div>
<div class="legend">
<h3>Legend</h3>
<div class="legend-item">
<div class="legend-color" style="background-color: #4caf50;"></div>
<span>Covered lines: Code that was executed during testing</span>
</div>
<div class="legend-item">
<div class="legend-color" style="background-color: #f44336;"></div>
<span>Uncovered lines: Code that was not executed during testing</span>
</div>
<div class="legend-item">
<div class="legend-color" style="background-color: #858585;"></div>
<span>Context lines: Code before and after uncovered lines</span>
</div>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/preprocessor.py - 65.76% coverage (194/295 lines)
</div>
<h4>Function: add_define - Lines 54-56</h4>
<pre>
<span class="line-number"> 49</span><span class="context">        self.blocks: List[PreprocessorBlock] = []</span>
<span class="line-number"> 50</span><span class="context">        self.current_block_stack: List[PreprocessorBlock] = []</span>
<span class="line-number"> 51</span><span class="context"></span>
<span class="line-number"> 52</span><span class="context">    def add_define(self, name: str, value: str = &quot;&quot;):</span>
<span class="line-number"> 53</span><span class="context">        &quot;&quot;&quot;Add a defined macro.&quot;&quot;&quot;</span>
<span class="line-number"> 54</span><span class="uncovered">        self.defined_macros.add(name)</span>
<span class="line-number"> 55</span><span class="uncovered">        if value:</span>
<span class="line-number"> 56</span><span class="uncovered">            self.macro_values[name] = value</span>
<span class="line-number"> 57</span><span class="context"></span>
<span class="line-number"> 58</span><span class="context">    def add_undef(self, name: str):</span>
<span class="line-number"> 59</span><span class="context">        &quot;&quot;&quot;Remove a defined macro.&quot;&quot;&quot;</span>
<span class="line-number"> 60</span><span class="context">        self.defined_macros.discard(name)</span>
<span class="line-number"> 61</span><span class="context">        self.macro_values.pop(name, None)</span>
</pre>
<h4>Function: add_undef - Lines 60-61</h4>
<pre>
<span class="line-number"> 55</span><span class="context">        if value:</span>
<span class="line-number"> 56</span><span class="context">            self.macro_values[name] = value</span>
<span class="line-number"> 57</span><span class="context"></span>
<span class="line-number"> 58</span><span class="context">    def add_undef(self, name: str):</span>
<span class="line-number"> 59</span><span class="context">        &quot;&quot;&quot;Remove a defined macro.&quot;&quot;&quot;</span>
<span class="line-number"> 60</span><span class="uncovered">        self.defined_macros.discard(name)</span>
<span class="line-number"> 61</span><span class="uncovered">        self.macro_values.pop(name, None)</span>
<span class="line-number"> 62</span><span class="context"></span>
<span class="line-number"> 63</span><span class="context">    def is_defined(self, name: str) -&gt; bool:</span>
<span class="line-number"> 64</span><span class="context">        &quot;&quot;&quot;Check if a macro is defined.&quot;&quot;&quot;</span>
<span class="line-number"> 65</span><span class="context">        return name in self.defined_macros</span>
<span class="line-number"> 66</span><span class="context"></span>
</pre>
<h4>Function: get_macro_value - Line 69</h4>
<pre>
<span class="line-number"> 64</span><span class="context">        &quot;&quot;&quot;Check if a macro is defined.&quot;&quot;&quot;</span>
<span class="line-number"> 65</span><span class="context">        return name in self.defined_macros</span>
<span class="line-number"> 66</span><span class="context"></span>
<span class="line-number"> 67</span><span class="context">    def get_macro_value(self, name: str) -&gt; str:</span>
<span class="line-number"> 68</span><span class="context">        &quot;&quot;&quot;Get the value of a defined macro.&quot;&quot;&quot;</span>
<span class="line-number"> 69</span><span class="uncovered">        return self.macro_values.get(name, &quot;&quot;)</span>
<span class="line-number"> 70</span><span class="context"></span>
<span class="line-number"> 71</span><span class="context">    def evaluate_condition(self, condition: str) -&gt; bool:</span>
<span class="line-number"> 72</span><span class="context">        &quot;&quot;&quot;Evaluate a preprocessor condition.&quot;&quot;&quot;</span>
<span class="line-number"> 73</span><span class="context">        if not condition.strip():</span>
<span class="line-number"> 74</span><span class="context">            return True</span>
</pre>
<h4>Function: _expand_macros - Lines 103-104</h4>
<pre>
<span class="line-number"> 98</span><span class="context">    def _expand_macros(self, condition: str) -&gt; str:</span>
<span class="line-number"> 99</span><span class="context">        &quot;&quot;&quot;Expand macros in the condition.&quot;&quot;&quot;</span>
<span class="line-number">100</span><span class="context">        # Simple macro expansion for common cases</span>
<span class="line-number">101</span><span class="context">        for macro_name, macro_value in self.macro_values.items():</span>
<span class="line-number">102</span><span class="context">            # Replace macro name with its value</span>
<span class="line-number">103</span><span class="uncovered">            pattern = r&quot;\b&quot; + re.escape(macro_name) + r&quot;\b&quot;</span>
<span class="line-number">104</span><span class="uncovered">            condition = re.sub(pattern, macro_value, condition)</span>
<span class="line-number">105</span><span class="context">        return condition</span>
<span class="line-number">106</span><span class="context"></span>
<span class="line-number">107</span><span class="context">    def _evaluate_simple_expression(self, condition: str) -&gt; bool:</span>
<span class="line-number">108</span><span class="context">        &quot;&quot;&quot;Evaluate simple expressions like comparisons and logical operators.&quot;&quot;&quot;</span>
<span class="line-number">109</span><span class="context">        try:</span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 115</h4>
<pre>
<span class="line-number">110</span><span class="context">            # Handle common comparison operators</span>
<span class="line-number">111</span><span class="context">            condition = condition.strip()</span>
<span class="line-number">112</span><span class="context"></span>
<span class="line-number">113</span><span class="context">            # Handle simple boolean values</span>
<span class="line-number">114</span><span class="context">            if condition.lower() in [&quot;1&quot;, &quot;true&quot;, &quot;yes&quot;]:</span>
<span class="line-number">115</span><span class="uncovered">                return True</span>
<span class="line-number">116</span><span class="context">            if condition.lower() in [&quot;0&quot;, &quot;false&quot;, &quot;no&quot;]:</span>
<span class="line-number">117</span><span class="context">                return False</span>
<span class="line-number">118</span><span class="context"></span>
<span class="line-number">119</span><span class="context">            # Handle simple comparisons</span>
<span class="line-number">120</span><span class="context">            if &quot;==&quot; in condition:</span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 127</h4>
<pre>
<span class="line-number">122</span><span class="context">                left_val = left.strip()</span>
<span class="line-number">123</span><span class="context">                right_val = right.strip()</span>
<span class="line-number">124</span><span class="context"></span>
<span class="line-number">125</span><span class="context">                # If both sides are known macros, compare their values</span>
<span class="line-number">126</span><span class="context">                if left_val in self.defined_macros and right_val in self.defined_macros:</span>
<span class="line-number">127</span><span class="uncovered">                    return self.get_macro_value(left_val) == self.get_macro_value(</span>
<span class="line-number">128</span><span class="context">                        right_val</span>
<span class="line-number">129</span><span class="context">                    )</span>
<span class="line-number">130</span><span class="context">                # If one side is a known macro, compare with the other side</span>
<span class="line-number">131</span><span class="context">                elif left_val in self.defined_macros:</span>
<span class="line-number">132</span><span class="context">                    return self.get_macro_value(left_val) == right_val</span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 132</h4>
<pre>
<span class="line-number">127</span><span class="context">                    return self.get_macro_value(left_val) == self.get_macro_value(</span>
<span class="line-number">128</span><span class="context">                        right_val</span>
<span class="line-number">129</span><span class="context">                    )</span>
<span class="line-number">130</span><span class="context">                # If one side is a known macro, compare with the other side</span>
<span class="line-number">131</span><span class="context">                elif left_val in self.defined_macros:</span>
<span class="line-number">132</span><span class="uncovered">                    return self.get_macro_value(left_val) == right_val</span>
<span class="line-number">133</span><span class="context">                elif right_val in self.defined_macros:</span>
<span class="line-number">134</span><span class="context">                    return left_val == self.get_macro_value(right_val)</span>
<span class="line-number">135</span><span class="context">                # If neither side is a known macro, both are undefined, so they&#x27;re equal</span>
<span class="line-number">136</span><span class="context">                else:</span>
<span class="line-number">137</span><span class="context">                    return True  # Both undefined macros are considered equal</span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 134</h4>
<pre>
<span class="line-number">129</span><span class="context">                    )</span>
<span class="line-number">130</span><span class="context">                # If one side is a known macro, compare with the other side</span>
<span class="line-number">131</span><span class="context">                elif left_val in self.defined_macros:</span>
<span class="line-number">132</span><span class="context">                    return self.get_macro_value(left_val) == right_val</span>
<span class="line-number">133</span><span class="context">                elif right_val in self.defined_macros:</span>
<span class="line-number">134</span><span class="uncovered">                    return left_val == self.get_macro_value(right_val)</span>
<span class="line-number">135</span><span class="context">                # If neither side is a known macro, both are undefined, so they&#x27;re equal</span>
<span class="line-number">136</span><span class="context">                else:</span>
<span class="line-number">137</span><span class="context">                    return True  # Both undefined macros are considered equal</span>
<span class="line-number">138</span><span class="context"></span>
<span class="line-number">139</span><span class="context">            if &quot;!=&quot; in condition:</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 140-142</h4>
<pre>
<span class="line-number">135</span><span class="context">                # If neither side is a known macro, both are undefined, so they&#x27;re equal</span>
<span class="line-number">136</span><span class="context">                else:</span>
<span class="line-number">137</span><span class="context">                    return True  # Both undefined macros are considered equal</span>
<span class="line-number">138</span><span class="context"></span>
<span class="line-number">139</span><span class="context">            if &quot;!=&quot; in condition:</span>
<span class="line-number">140</span><span class="uncovered">                left, right = condition.split(&quot;!=&quot;, 1)</span>
<span class="line-number">141</span><span class="uncovered">                left_val = left.strip()</span>
<span class="line-number">142</span><span class="uncovered">                right_val = right.strip()</span>
<span class="line-number">143</span><span class="context"></span>
<span class="line-number">144</span><span class="context">                # If both sides are known macros, compare their values</span>
<span class="line-number">145</span><span class="context">                if left_val in self.defined_macros and right_val in self.defined_macros:</span>
<span class="line-number">146</span><span class="context">                    return self.get_macro_value(left_val) != self.get_macro_value(</span>
<span class="line-number">147</span><span class="context">                        right_val</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 145-146</h4>
<pre>
<span class="line-number">140</span><span class="context">                left, right = condition.split(&quot;!=&quot;, 1)</span>
<span class="line-number">141</span><span class="context">                left_val = left.strip()</span>
<span class="line-number">142</span><span class="context">                right_val = right.strip()</span>
<span class="line-number">143</span><span class="context"></span>
<span class="line-number">144</span><span class="context">                # If both sides are known macros, compare their values</span>
<span class="line-number">145</span><span class="uncovered">                if left_val in self.defined_macros and right_val in self.defined_macros:</span>
<span class="line-number">146</span><span class="uncovered">                    return self.get_macro_value(left_val) != self.get_macro_value(</span>
<span class="line-number">147</span><span class="context">                        right_val</span>
<span class="line-number">148</span><span class="context">                    )</span>
<span class="line-number">149</span><span class="context">                # If one side is a known macro, compare with the other side</span>
<span class="line-number">150</span><span class="context">                elif left_val in self.defined_macros:</span>
<span class="line-number">151</span><span class="context">                    return self.get_macro_value(left_val) != right_val</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 150-153</h4>
<pre>
<span class="line-number">145</span><span class="context">                if left_val in self.defined_macros and right_val in self.defined_macros:</span>
<span class="line-number">146</span><span class="context">                    return self.get_macro_value(left_val) != self.get_macro_value(</span>
<span class="line-number">147</span><span class="context">                        right_val</span>
<span class="line-number">148</span><span class="context">                    )</span>
<span class="line-number">149</span><span class="context">                # If one side is a known macro, compare with the other side</span>
<span class="line-number">150</span><span class="uncovered">                elif left_val in self.defined_macros:</span>
<span class="line-number">151</span><span class="uncovered">                    return self.get_macro_value(left_val) != right_val</span>
<span class="line-number">152</span><span class="uncovered">                elif right_val in self.defined_macros:</span>
<span class="line-number">153</span><span class="uncovered">                    return left_val != self.get_macro_value(right_val)</span>
<span class="line-number">154</span><span class="context">                # If neither side is a known macro, do string comparison</span>
<span class="line-number">155</span><span class="context">                else:</span>
<span class="line-number">156</span><span class="context">                    return left_val != right_val</span>
<span class="line-number">157</span><span class="context"></span>
<span class="line-number">158</span><span class="context">            if &quot;&gt;&quot; in condition:</span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 156</h4>
<pre>
<span class="line-number">151</span><span class="context">                    return self.get_macro_value(left_val) != right_val</span>
<span class="line-number">152</span><span class="context">                elif right_val in self.defined_macros:</span>
<span class="line-number">153</span><span class="context">                    return left_val != self.get_macro_value(right_val)</span>
<span class="line-number">154</span><span class="context">                # If neither side is a known macro, do string comparison</span>
<span class="line-number">155</span><span class="context">                else:</span>
<span class="line-number">156</span><span class="uncovered">                    return left_val != right_val</span>
<span class="line-number">157</span><span class="context"></span>
<span class="line-number">158</span><span class="context">            if &quot;&gt;&quot; in condition:</span>
<span class="line-number">159</span><span class="context">                left, right = condition.split(&quot;&gt;&quot;, 1)</span>
<span class="line-number">160</span><span class="context">                try:</span>
<span class="line-number">161</span><span class="context">                    left_val = self._evaluate_operand(left.strip())</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 166-189</h4>
<pre>
<span class="line-number">161</span><span class="context">                    left_val = self._evaluate_operand(left.strip())</span>
<span class="line-number">162</span><span class="context">                    right_val = self._evaluate_operand(right.strip())</span>
<span class="line-number">163</span><span class="context">                    return float(left_val) &gt; float(right_val)</span>
<span class="line-number">164</span><span class="context">                except ValueError:</span>
<span class="line-number">165</span><span class="context">                    return False</span>
<span class="line-number">166</span><span class="uncovered">            if &quot;&lt;&quot; in condition:</span>
<span class="line-number">167</span><span class="uncovered">                left, right = condition.split(&quot;&lt;&quot;, 1)</span>
<span class="line-number">168</span><span class="uncovered">                try:</span>
<span class="line-number">169</span><span class="uncovered">                    left_val = self._evaluate_operand(left.strip())</span>
<span class="line-number">170</span><span class="uncovered">                    right_val = self._evaluate_operand(right.strip())</span>
<span class="line-number">171</span><span class="uncovered">                    return float(left_val) &lt; float(right_val)</span>
<span class="line-number">172</span><span class="uncovered">                except ValueError:</span>
<span class="line-number">173</span><span class="uncovered">                    return False</span>
<span class="line-number">174</span><span class="uncovered">            if &quot;&gt;=&quot; in condition:</span>
<span class="line-number">175</span><span class="uncovered">                left, right = condition.split(&quot;&gt;=&quot;, 1)</span>
<span class="line-number">176</span><span class="uncovered">                try:</span>
<span class="line-number">177</span><span class="uncovered">                    left_val = self._evaluate_operand(left.strip())</span>
<span class="line-number">178</span><span class="uncovered">                    right_val = self._evaluate_operand(right.strip())</span>
<span class="line-number">179</span><span class="uncovered">                    return float(left_val) &gt;= float(right_val)</span>
<span class="line-number">180</span><span class="uncovered">                except ValueError:</span>
<span class="line-number">181</span><span class="uncovered">                    return False</span>
<span class="line-number">182</span><span class="uncovered">            if &quot;&lt;=&quot; in condition:</span>
<span class="line-number">183</span><span class="uncovered">                left, right = condition.split(&quot;&lt;=&quot;, 1)</span>
<span class="line-number">184</span><span class="uncovered">                try:</span>
<span class="line-number">185</span><span class="uncovered">                    left_val = self._evaluate_operand(left.strip())</span>
<span class="line-number">186</span><span class="uncovered">                    right_val = self._evaluate_operand(right.strip())</span>
<span class="line-number">187</span><span class="uncovered">                    return float(left_val) &lt;= float(right_val)</span>
<span class="line-number">188</span><span class="uncovered">                except ValueError:</span>
<span class="line-number">189</span><span class="uncovered">                    return False</span>
<span class="line-number">190</span><span class="context"></span>
<span class="line-number">191</span><span class="context">            # Handle logical operators</span>
<span class="line-number">192</span><span class="context">            if &quot;&amp;&amp;&quot; in condition:</span>
<span class="line-number">193</span><span class="context">                parts = condition.split(&quot;&amp;&amp;&quot;)</span>
<span class="line-number">194</span><span class="context">                return all(</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 192-194</h4>
<pre>
<span class="line-number">187</span><span class="context">                    return float(left_val) &lt;= float(right_val)</span>
<span class="line-number">188</span><span class="context">                except ValueError:</span>
<span class="line-number">189</span><span class="context">                    return False</span>
<span class="line-number">190</span><span class="context"></span>
<span class="line-number">191</span><span class="context">            # Handle logical operators</span>
<span class="line-number">192</span><span class="uncovered">            if &quot;&amp;&amp;&quot; in condition:</span>
<span class="line-number">193</span><span class="uncovered">                parts = condition.split(&quot;&amp;&amp;&quot;)</span>
<span class="line-number">194</span><span class="uncovered">                return all(</span>
<span class="line-number">195</span><span class="context">                    self._evaluate_simple_expression(part.strip()) for part in parts</span>
<span class="line-number">196</span><span class="context">                )</span>
<span class="line-number">197</span><span class="context">            if &quot;||&quot; in condition:</span>
<span class="line-number">198</span><span class="context">                parts = condition.split(&quot;||&quot;)</span>
<span class="line-number">199</span><span class="context">                return any(</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 197-199</h4>
<pre>
<span class="line-number">192</span><span class="context">            if &quot;&amp;&amp;&quot; in condition:</span>
<span class="line-number">193</span><span class="context">                parts = condition.split(&quot;&amp;&amp;&quot;)</span>
<span class="line-number">194</span><span class="context">                return all(</span>
<span class="line-number">195</span><span class="context">                    self._evaluate_simple_expression(part.strip()) for part in parts</span>
<span class="line-number">196</span><span class="context">                )</span>
<span class="line-number">197</span><span class="uncovered">            if &quot;||&quot; in condition:</span>
<span class="line-number">198</span><span class="uncovered">                parts = condition.split(&quot;||&quot;)</span>
<span class="line-number">199</span><span class="uncovered">                return any(</span>
<span class="line-number">200</span><span class="context">                    self._evaluate_simple_expression(part.strip()) for part in parts</span>
<span class="line-number">201</span><span class="context">                )</span>
<span class="line-number">202</span><span class="context">            if &quot;!&quot; in condition:</span>
<span class="line-number">203</span><span class="context">                # Simple negation</span>
<span class="line-number">204</span><span class="context">                negated = condition.replace(&quot;!&quot;, &quot;&quot;).strip()</span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 202</h4>
<pre>
<span class="line-number">197</span><span class="context">            if &quot;||&quot; in condition:</span>
<span class="line-number">198</span><span class="context">                parts = condition.split(&quot;||&quot;)</span>
<span class="line-number">199</span><span class="context">                return any(</span>
<span class="line-number">200</span><span class="context">                    self._evaluate_simple_expression(part.strip()) for part in parts</span>
<span class="line-number">201</span><span class="context">                )</span>
<span class="line-number">202</span><span class="uncovered">            if &quot;!&quot; in condition:</span>
<span class="line-number">203</span><span class="context">                # Simple negation</span>
<span class="line-number">204</span><span class="context">                negated = condition.replace(&quot;!&quot;, &quot;&quot;).strip()</span>
<span class="line-number">205</span><span class="context">                return not self._evaluate_simple_expression(negated)</span>
<span class="line-number">206</span><span class="context"></span>
<span class="line-number">207</span><span class="context">            # If it&#x27;s just a macro name, check if it&#x27;s defined</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 204-205</h4>
<pre>
<span class="line-number">199</span><span class="context">                return any(</span>
<span class="line-number">200</span><span class="context">                    self._evaluate_simple_expression(part.strip()) for part in parts</span>
<span class="line-number">201</span><span class="context">                )</span>
<span class="line-number">202</span><span class="context">            if &quot;!&quot; in condition:</span>
<span class="line-number">203</span><span class="context">                # Simple negation</span>
<span class="line-number">204</span><span class="uncovered">                negated = condition.replace(&quot;!&quot;, &quot;&quot;).strip()</span>
<span class="line-number">205</span><span class="uncovered">                return not self._evaluate_simple_expression(negated)</span>
<span class="line-number">206</span><span class="context"></span>
<span class="line-number">207</span><span class="context">            # If it&#x27;s just a macro name, check if it&#x27;s defined</span>
<span class="line-number">208</span><span class="context">            if condition in self.defined_macros:</span>
<span class="line-number">209</span><span class="context">                return True</span>
<span class="line-number">210</span><span class="context"></span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 208-209</h4>
<pre>
<span class="line-number">203</span><span class="context">                # Simple negation</span>
<span class="line-number">204</span><span class="context">                negated = condition.replace(&quot;!&quot;, &quot;&quot;).strip()</span>
<span class="line-number">205</span><span class="context">                return not self._evaluate_simple_expression(negated)</span>
<span class="line-number">206</span><span class="context"></span>
<span class="line-number">207</span><span class="context">            # If it&#x27;s just a macro name, check if it&#x27;s defined</span>
<span class="line-number">208</span><span class="uncovered">            if condition in self.defined_macros:</span>
<span class="line-number">209</span><span class="uncovered">                return True</span>
<span class="line-number">210</span><span class="context"></span>
<span class="line-number">211</span><span class="context">            # Try to evaluate as a number</span>
<span class="line-number">212</span><span class="context">            try:</span>
<span class="line-number">213</span><span class="context">                return bool(int(condition))</span>
<span class="line-number">214</span><span class="context">            except ValueError:</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 212-215</h4>
<pre>
<span class="line-number">207</span><span class="context">            # If it&#x27;s just a macro name, check if it&#x27;s defined</span>
<span class="line-number">208</span><span class="context">            if condition in self.defined_macros:</span>
<span class="line-number">209</span><span class="context">                return True</span>
<span class="line-number">210</span><span class="context"></span>
<span class="line-number">211</span><span class="context">            # Try to evaluate as a number</span>
<span class="line-number">212</span><span class="uncovered">            try:</span>
<span class="line-number">213</span><span class="uncovered">                return bool(int(condition))</span>
<span class="line-number">214</span><span class="uncovered">            except ValueError:</span>
<span class="line-number">215</span><span class="uncovered">                pass</span>
<span class="line-number">216</span><span class="context"></span>
<span class="line-number">217</span><span class="context">            # Default to True for unknown conditions (backward compatibility)</span>
<span class="line-number">218</span><span class="context">            # This ensures existing tests continue to work</span>
<span class="line-number">219</span><span class="context">            return True</span>
<span class="line-number">220</span><span class="context"></span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 219</h4>
<pre>
<span class="line-number">214</span><span class="context">            except ValueError:</span>
<span class="line-number">215</span><span class="context">                pass</span>
<span class="line-number">216</span><span class="context"></span>
<span class="line-number">217</span><span class="context">            # Default to True for unknown conditions (backward compatibility)</span>
<span class="line-number">218</span><span class="context">            # This ensures existing tests continue to work</span>
<span class="line-number">219</span><span class="uncovered">            return True</span>
<span class="line-number">220</span><span class="context"></span>
<span class="line-number">221</span><span class="context">        except ValueError as e:</span>
<span class="line-number">222</span><span class="context">            self.logger.warning(</span>
<span class="line-number">223</span><span class="context">                &quot;Error evaluating preprocessor condition &#x27;%s&#x27;: %s&quot;, condition, e</span>
<span class="line-number">224</span><span class="context">            )</span>
</pre>
<h4>Function: _evaluate_simple_expression - Lines 221-222</h4>
<pre>
<span class="line-number">216</span><span class="context"></span>
<span class="line-number">217</span><span class="context">            # Default to True for unknown conditions (backward compatibility)</span>
<span class="line-number">218</span><span class="context">            # This ensures existing tests continue to work</span>
<span class="line-number">219</span><span class="context">            return True</span>
<span class="line-number">220</span><span class="context"></span>
<span class="line-number">221</span><span class="uncovered">        except ValueError as e:</span>
<span class="line-number">222</span><span class="uncovered">            self.logger.warning(</span>
<span class="line-number">223</span><span class="context">                &quot;Error evaluating preprocessor condition &#x27;%s&#x27;: %s&quot;, condition, e</span>
<span class="line-number">224</span><span class="context">            )</span>
<span class="line-number">225</span><span class="context">            # Default to True for unknown conditions (backward compatibility)</span>
<span class="line-number">226</span><span class="context">            return True</span>
<span class="line-number">227</span><span class="context"></span>
</pre>
<h4>Function: _evaluate_simple_expression - Line 226</h4>
<pre>
<span class="line-number">221</span><span class="context">        except ValueError as e:</span>
<span class="line-number">222</span><span class="context">            self.logger.warning(</span>
<span class="line-number">223</span><span class="context">                &quot;Error evaluating preprocessor condition &#x27;%s&#x27;: %s&quot;, condition, e</span>
<span class="line-number">224</span><span class="context">            )</span>
<span class="line-number">225</span><span class="context">            # Default to True for unknown conditions (backward compatibility)</span>
<span class="line-number">226</span><span class="uncovered">            return True</span>
<span class="line-number">227</span><span class="context"></span>
<span class="line-number">228</span><span class="context">    def _evaluate_operand(self, operand: str) -&gt; str:</span>
<span class="line-number">229</span><span class="context">        &quot;&quot;&quot;Evaluate an operand, expanding macros if they are defined.&quot;&quot;&quot;</span>
<span class="line-number">230</span><span class="context">        operand = operand.strip()</span>
<span class="line-number">231</span><span class="context"></span>
</pre>
<h4>Function: _evaluate_operand - Line 234</h4>
<pre>
<span class="line-number">229</span><span class="context">        &quot;&quot;&quot;Evaluate an operand, expanding macros if they are defined.&quot;&quot;&quot;</span>
<span class="line-number">230</span><span class="context">        operand = operand.strip()</span>
<span class="line-number">231</span><span class="context"></span>
<span class="line-number">232</span><span class="context">        # If it&#x27;s a defined macro, return its value</span>
<span class="line-number">233</span><span class="context">        if operand in self.defined_macros:</span>
<span class="line-number">234</span><span class="uncovered">            return self.get_macro_value(operand)</span>
<span class="line-number">235</span><span class="context"></span>
<span class="line-number">236</span><span class="context">        # Otherwise, return the operand as-is</span>
<span class="line-number">237</span><span class="context">        return operand</span>
<span class="line-number">238</span><span class="context"></span>
<span class="line-number">239</span><span class="context">    def parse_preprocessor_blocks(self, tokens: List[Token]) -&gt; List[PreprocessorBlock]:</span>
</pre>
<h4>Function: parse_preprocessor_blocks - Line 300</h4>
<pre>
<span class="line-number">295</span><span class="context">                    if stack:</span>
<span class="line-number">296</span><span class="context">                        # End current block</span>
<span class="line-number">297</span><span class="context">                        current_block = stack.pop()</span>
<span class="line-number">298</span><span class="context">                        current_block.end_token = i</span>
<span class="line-number">299</span><span class="context"></span>
<span class="line-number">300</span><span class="uncovered">                elif directive == PreprocessorDirective.DEFINE:</span>
<span class="line-number">301</span><span class="context">                    # Handle #define</span>
<span class="line-number">302</span><span class="context">                    macro_name, macro_value = self._parse_define(token.value)</span>
<span class="line-number">303</span><span class="context">                    self.add_define(macro_name, macro_value)</span>
<span class="line-number">304</span><span class="context"></span>
<span class="line-number">305</span><span class="context">                elif directive == PreprocessorDirective.UNDEF:</span>
</pre>
<h4>Function: parse_preprocessor_blocks - Lines 302-303</h4>
<pre>
<span class="line-number">297</span><span class="context">                        current_block = stack.pop()</span>
<span class="line-number">298</span><span class="context">                        current_block.end_token = i</span>
<span class="line-number">299</span><span class="context"></span>
<span class="line-number">300</span><span class="context">                elif directive == PreprocessorDirective.DEFINE:</span>
<span class="line-number">301</span><span class="context">                    # Handle #define</span>
<span class="line-number">302</span><span class="uncovered">                    macro_name, macro_value = self._parse_define(token.value)</span>
<span class="line-number">303</span><span class="uncovered">                    self.add_define(macro_name, macro_value)</span>
<span class="line-number">304</span><span class="context"></span>
<span class="line-number">305</span><span class="context">                elif directive == PreprocessorDirective.UNDEF:</span>
<span class="line-number">306</span><span class="context">                    # Handle #undef</span>
<span class="line-number">307</span><span class="context">                    macro_name = self._parse_undef(token.value)</span>
<span class="line-number">308</span><span class="context">                    self.add_undef(macro_name)</span>
</pre>
<h4>Function: parse_preprocessor_blocks - Line 305</h4>
<pre>
<span class="line-number">300</span><span class="context">                elif directive == PreprocessorDirective.DEFINE:</span>
<span class="line-number">301</span><span class="context">                    # Handle #define</span>
<span class="line-number">302</span><span class="context">                    macro_name, macro_value = self._parse_define(token.value)</span>
<span class="line-number">303</span><span class="context">                    self.add_define(macro_name, macro_value)</span>
<span class="line-number">304</span><span class="context"></span>
<span class="line-number">305</span><span class="uncovered">                elif directive == PreprocessorDirective.UNDEF:</span>
<span class="line-number">306</span><span class="context">                    # Handle #undef</span>
<span class="line-number">307</span><span class="context">                    macro_name = self._parse_undef(token.value)</span>
<span class="line-number">308</span><span class="context">                    self.add_undef(macro_name)</span>
<span class="line-number">309</span><span class="context"></span>
<span class="line-number">310</span><span class="context">            i += 1</span>
</pre>
<h4>Function: parse_preprocessor_blocks - Lines 307-308</h4>
<pre>
<span class="line-number">302</span><span class="context">                    macro_name, macro_value = self._parse_define(token.value)</span>
<span class="line-number">303</span><span class="context">                    self.add_define(macro_name, macro_value)</span>
<span class="line-number">304</span><span class="context"></span>
<span class="line-number">305</span><span class="context">                elif directive == PreprocessorDirective.UNDEF:</span>
<span class="line-number">306</span><span class="context">                    # Handle #undef</span>
<span class="line-number">307</span><span class="uncovered">                    macro_name = self._parse_undef(token.value)</span>
<span class="line-number">308</span><span class="uncovered">                    self.add_undef(macro_name)</span>
<span class="line-number">309</span><span class="context"></span>
<span class="line-number">310</span><span class="context">            i += 1</span>
<span class="line-number">311</span><span class="context"></span>
<span class="line-number">312</span><span class="context">        return blocks</span>
<span class="line-number">313</span><span class="context"></span>
</pre>
<h4>Function: _parse_directive - Lines 329-332</h4>
<pre>
<span class="line-number">324</span><span class="context">            return PreprocessorDirective.ELIF</span>
<span class="line-number">325</span><span class="context">        elif value.startswith(&quot;#else&quot;):</span>
<span class="line-number">326</span><span class="context">            return PreprocessorDirective.ELSE</span>
<span class="line-number">327</span><span class="context">        elif value.startswith(&quot;#endif&quot;):</span>
<span class="line-number">328</span><span class="context">            return PreprocessorDirective.ENDIF</span>
<span class="line-number">329</span><span class="uncovered">        elif value.startswith(&quot;#define&quot;):</span>
<span class="line-number">330</span><span class="uncovered">            return PreprocessorDirective.DEFINE</span>
<span class="line-number">331</span><span class="uncovered">        elif value.startswith(&quot;#undef&quot;):</span>
<span class="line-number">332</span><span class="uncovered">            return PreprocessorDirective.UNDEF</span>
<span class="line-number">333</span><span class="context">        else:</span>
<span class="line-number">334</span><span class="context">            return PreprocessorDirective.IF  # Default</span>
<span class="line-number">335</span><span class="context"></span>
<span class="line-number">336</span><span class="context">    def _extract_condition(self, value: str, directive: PreprocessorDirective) -&gt; str:</span>
<span class="line-number">337</span><span class="context">        &quot;&quot;&quot;Extract the condition from a preprocessor directive.&quot;&quot;&quot;</span>
</pre>
<h4>Function: _parse_directive - Line 334</h4>
<pre>
<span class="line-number">329</span><span class="context">        elif value.startswith(&quot;#define&quot;):</span>
<span class="line-number">330</span><span class="context">            return PreprocessorDirective.DEFINE</span>
<span class="line-number">331</span><span class="context">        elif value.startswith(&quot;#undef&quot;):</span>
<span class="line-number">332</span><span class="context">            return PreprocessorDirective.UNDEF</span>
<span class="line-number">333</span><span class="context">        else:</span>
<span class="line-number">334</span><span class="uncovered">            return PreprocessorDirective.IF  # Default</span>
<span class="line-number">335</span><span class="context"></span>
<span class="line-number">336</span><span class="context">    def _extract_condition(self, value: str, directive: PreprocessorDirective) -&gt; str:</span>
<span class="line-number">337</span><span class="context">        &quot;&quot;&quot;Extract the condition from a preprocessor directive.&quot;&quot;&quot;</span>
<span class="line-number">338</span><span class="context">        value = value.strip()</span>
<span class="line-number">339</span><span class="context"></span>
</pre>
<h4>Function: _extract_condition - Line 353</h4>
<pre>
<span class="line-number">348</span><span class="context">            return match.group(1).strip() if match else &quot;&quot;</span>
<span class="line-number">349</span><span class="context">        elif directive == PreprocessorDirective.ELIF:</span>
<span class="line-number">350</span><span class="context">            match = re.search(r&quot;#elif\s+(.+)&quot;, value)</span>
<span class="line-number">351</span><span class="context">            return match.group(1).strip() if match else &quot;&quot;</span>
<span class="line-number">352</span><span class="context">        else:</span>
<span class="line-number">353</span><span class="uncovered">            return &quot;&quot;</span>
<span class="line-number">354</span><span class="context"></span>
<span class="line-number">355</span><span class="context">    def _parse_define(self, value: str) -&gt; Tuple[str, str]:</span>
<span class="line-number">356</span><span class="context">        &quot;&quot;&quot;Parse #define directive.&quot;&quot;&quot;</span>
<span class="line-number">357</span><span class="context">        value = value.strip()</span>
<span class="line-number">358</span><span class="context">        match = re.search(r&quot;#define\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*(.+)&quot;, value)</span>
</pre>
<h4>Function: _parse_define - Lines 357-363</h4>
<pre>
<span class="line-number">352</span><span class="context">        else:</span>
<span class="line-number">353</span><span class="context">            return &quot;&quot;</span>
<span class="line-number">354</span><span class="context"></span>
<span class="line-number">355</span><span class="context">    def _parse_define(self, value: str) -&gt; Tuple[str, str]:</span>
<span class="line-number">356</span><span class="context">        &quot;&quot;&quot;Parse #define directive.&quot;&quot;&quot;</span>
<span class="line-number">357</span><span class="uncovered">        value = value.strip()</span>
<span class="line-number">358</span><span class="uncovered">        match = re.search(r&quot;#define\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*(.+)&quot;, value)</span>
<span class="line-number">359</span><span class="uncovered">        if match:</span>
<span class="line-number">360</span><span class="uncovered">            name = match.group(1)</span>
<span class="line-number">361</span><span class="uncovered">            macro_value = match.group(2).strip()</span>
<span class="line-number">362</span><span class="uncovered">            return name, macro_value</span>
<span class="line-number">363</span><span class="uncovered">        return &quot;&quot;, &quot;&quot;</span>
<span class="line-number">364</span><span class="context"></span>
<span class="line-number">365</span><span class="context">    def _parse_undef(self, value: str) -&gt; str:</span>
<span class="line-number">366</span><span class="context">        &quot;&quot;&quot;Parse #undef directive.&quot;&quot;&quot;</span>
<span class="line-number">367</span><span class="context">        value = value.strip()</span>
<span class="line-number">368</span><span class="context">        match = re.search(r&quot;#undef\s+([a-zA-Z_][a-zA-Z0-9_]*)&quot;, value)</span>
</pre>
<h4>Function: _parse_undef - Lines 367-369</h4>
<pre>
<span class="line-number">362</span><span class="context">            return name, macro_value</span>
<span class="line-number">363</span><span class="context">        return &quot;&quot;, &quot;&quot;</span>
<span class="line-number">364</span><span class="context"></span>
<span class="line-number">365</span><span class="context">    def _parse_undef(self, value: str) -&gt; str:</span>
<span class="line-number">366</span><span class="context">        &quot;&quot;&quot;Parse #undef directive.&quot;&quot;&quot;</span>
<span class="line-number">367</span><span class="uncovered">        value = value.strip()</span>
<span class="line-number">368</span><span class="uncovered">        match = re.search(r&quot;#undef\s+([a-zA-Z_][a-zA-Z0-9_]*)&quot;, value)</span>
<span class="line-number">369</span><span class="uncovered">        return match.group(1) if match else &quot;&quot;</span>
<span class="line-number">370</span><span class="context"></span>
<span class="line-number">371</span><span class="context">    def _should_activate_block(</span>
<span class="line-number">372</span><span class="context">        self,</span>
<span class="line-number">373</span><span class="context">        directive: PreprocessorDirective,</span>
<span class="line-number">374</span><span class="context">        condition: str,</span>
</pre>
<h4>Function: _should_activate_block - Lines 394-395</h4>
<pre>
<span class="line-number">389</span><span class="context">            # For #elif, we need to check if no previous branch was taken</span>
<span class="line-number">390</span><span class="context">            if stack:</span>
<span class="line-number">391</span><span class="context">                parent = stack[-1]</span>
<span class="line-number">392</span><span class="context">                # Check if any previous child was active</span>
<span class="line-number">393</span><span class="context">                for child in parent.children:</span>
<span class="line-number">394</span><span class="uncovered">                    if child.is_active:</span>
<span class="line-number">395</span><span class="uncovered">                        return False</span>
<span class="line-number">396</span><span class="context">                return self.evaluate_condition(condition)</span>
<span class="line-number">397</span><span class="context">            return False</span>
<span class="line-number">398</span><span class="context">        elif directive == PreprocessorDirective.ELSE:</span>
<span class="line-number">399</span><span class="context">            # For #else, we need to check if no previous branch was taken</span>
<span class="line-number">400</span><span class="context">            if stack:</span>
</pre>
<h4>Function: _should_activate_block - Line 397</h4>
<pre>
<span class="line-number">392</span><span class="context">                # Check if any previous child was active</span>
<span class="line-number">393</span><span class="context">                for child in parent.children:</span>
<span class="line-number">394</span><span class="context">                    if child.is_active:</span>
<span class="line-number">395</span><span class="context">                        return False</span>
<span class="line-number">396</span><span class="context">                return self.evaluate_condition(condition)</span>
<span class="line-number">397</span><span class="uncovered">            return False</span>
<span class="line-number">398</span><span class="context">        elif directive == PreprocessorDirective.ELSE:</span>
<span class="line-number">399</span><span class="context">            # For #else, we need to check if no previous branch was taken</span>
<span class="line-number">400</span><span class="context">            if stack:</span>
<span class="line-number">401</span><span class="context">                parent = stack[-1]</span>
<span class="line-number">402</span><span class="context">                # Check if any previous child was active</span>
</pre>
<h4>Function: _should_activate_block - Lines 404-405</h4>
<pre>
<span class="line-number">399</span><span class="context">            # For #else, we need to check if no previous branch was taken</span>
<span class="line-number">400</span><span class="context">            if stack:</span>
<span class="line-number">401</span><span class="context">                parent = stack[-1]</span>
<span class="line-number">402</span><span class="context">                # Check if any previous child was active</span>
<span class="line-number">403</span><span class="context">                for child in parent.children:</span>
<span class="line-number">404</span><span class="uncovered">                    if child.is_active:</span>
<span class="line-number">405</span><span class="uncovered">                        return False</span>
<span class="line-number">406</span><span class="context">                return True</span>
<span class="line-number">407</span><span class="context">            return False</span>
<span class="line-number">408</span><span class="context">        else:</span>
<span class="line-number">409</span><span class="context">            return False</span>
<span class="line-number">410</span><span class="context"></span>
</pre>
<h4>Function: _should_activate_block - Line 407</h4>
<pre>
<span class="line-number">402</span><span class="context">                # Check if any previous child was active</span>
<span class="line-number">403</span><span class="context">                for child in parent.children:</span>
<span class="line-number">404</span><span class="context">                    if child.is_active:</span>
<span class="line-number">405</span><span class="context">                        return False</span>
<span class="line-number">406</span><span class="context">                return True</span>
<span class="line-number">407</span><span class="uncovered">            return False</span>
<span class="line-number">408</span><span class="context">        else:</span>
<span class="line-number">409</span><span class="context">            return False</span>
<span class="line-number">410</span><span class="context"></span>
<span class="line-number">411</span><span class="context">    def filter_tokens(self, tokens: List[Token]) -&gt; List[Token]:</span>
<span class="line-number">412</span><span class="context">        &quot;&quot;&quot;Filter tokens based on preprocessor blocks, keeping only active content.&quot;&quot;&quot;</span>
</pre>
<h4>Function: _should_activate_block - Line 409</h4>
<pre>
<span class="line-number">404</span><span class="context">                    if child.is_active:</span>
<span class="line-number">405</span><span class="context">                        return False</span>
<span class="line-number">406</span><span class="context">                return True</span>
<span class="line-number">407</span><span class="context">            return False</span>
<span class="line-number">408</span><span class="context">        else:</span>
<span class="line-number">409</span><span class="uncovered">            return False</span>
<span class="line-number">410</span><span class="context"></span>
<span class="line-number">411</span><span class="context">    def filter_tokens(self, tokens: List[Token]) -&gt; List[Token]:</span>
<span class="line-number">412</span><span class="context">        &quot;&quot;&quot;Filter tokens based on preprocessor blocks, keeping only active content.&quot;&quot;&quot;</span>
<span class="line-number">413</span><span class="context">        blocks = self.parse_preprocessor_blocks(tokens)</span>
<span class="line-number">414</span><span class="context">        filtered_tokens = []</span>
</pre>
<h4>Function: process_file - Lines 471-472</h4>
<pre>
<span class="line-number">466</span><span class="context">    def process_file(</span>
<span class="line-number">467</span><span class="context">        self, tokens: List[Token], defines: Optional[Dict[str, str]] = None</span>
<span class="line-number">468</span><span class="context">    ) -&gt; List[Token]:</span>
<span class="line-number">469</span><span class="context">        &quot;&quot;&quot;Process a file&#x27;s tokens through the preprocessor.&quot;&quot;&quot;</span>
<span class="line-number">470</span><span class="context">        if defines:</span>
<span class="line-number">471</span><span class="uncovered">            for name, value in defines.items():</span>
<span class="line-number">472</span><span class="uncovered">                self.evaluator.add_define(name, value)</span>
<span class="line-number">473</span><span class="context"></span>
<span class="line-number">474</span><span class="context">        # Filter tokens based on preprocessor directives</span>
<span class="line-number">475</span><span class="context">        filtered_tokens = self.evaluator.filter_tokens(tokens)</span>
<span class="line-number">476</span><span class="context"></span>
<span class="line-number">477</span><span class="context">        self.logger.debug(</span>
</pre>
<h4>Function: add_defines_from_content - Lines 488-491</h4>
<pre>
<span class="line-number">483</span><span class="context">        &quot;&quot;&quot;Extract #define directives from tokens and add them to the evaluator.&quot;&quot;&quot;</span>
<span class="line-number">484</span><span class="context">        for token in tokens:</span>
<span class="line-number">485</span><span class="context">            if token.type == TokenType.PREPROCESSOR and token.value.startswith(</span>
<span class="line-number">486</span><span class="context">                &quot;#define&quot;</span>
<span class="line-number">487</span><span class="context">            ):</span>
<span class="line-number">488</span><span class="uncovered">                name, value = self.evaluator._parse_define(token.value)</span>
<span class="line-number">489</span><span class="uncovered">                if name:</span>
<span class="line-number">490</span><span class="uncovered">                    self.evaluator.add_define(name, value)</span>
<span class="line-number">491</span><span class="uncovered">                    self.logger.debug(&quot;Preprocessor: Added define %s = %s&quot;, name, value)</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/main.py - 53.61% coverage (52/97 lines)
</div>
<h4>Function: load_config_from_path - Line 38</h4>
<pre>
<span class="line-number"> 33</span><span class="context">def load_config_from_path(config_path: str) -&gt; dict:</span>
<span class="line-number"> 34</span><span class="context">    path = Path(config_path)</span>
<span class="line-number"> 35</span><span class="context">    if path.is_file():</span>
<span class="line-number"> 36</span><span class="context">        with open(path, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number"> 37</span><span class="context">            return json.load(f)</span>
<span class="line-number"> 38</span><span class="uncovered">    elif path.is_dir():</span>
<span class="line-number"> 39</span><span class="context">        # Merge all .json files in the folder</span>
<span class="line-number"> 40</span><span class="context">        config = {}</span>
<span class="line-number"> 41</span><span class="context">        for file in path.glob(&quot;*.json&quot;):</span>
<span class="line-number"> 42</span><span class="context">            with open(file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number"> 43</span><span class="context">                data = json.load(f)</span>
</pre>
<h4>Function: load_config_from_path - Lines 40-45</h4>
<pre>
<span class="line-number"> 35</span><span class="context">    if path.is_file():</span>
<span class="line-number"> 36</span><span class="context">        with open(path, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number"> 37</span><span class="context">            return json.load(f)</span>
<span class="line-number"> 38</span><span class="context">    elif path.is_dir():</span>
<span class="line-number"> 39</span><span class="context">        # Merge all .json files in the folder</span>
<span class="line-number"> 40</span><span class="uncovered">        config = {}</span>
<span class="line-number"> 41</span><span class="uncovered">        for file in path.glob(&quot;*.json&quot;):</span>
<span class="line-number"> 42</span><span class="uncovered">            with open(file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number"> 43</span><span class="uncovered">                data = json.load(f)</span>
<span class="line-number"> 44</span><span class="uncovered">                config.update(data)</span>
<span class="line-number"> 45</span><span class="uncovered">        return config</span>
<span class="line-number"> 46</span><span class="context">    else:</span>
<span class="line-number"> 47</span><span class="context">        raise FileNotFoundError(f&quot;Config path not found: {config_path}&quot;)</span>
<span class="line-number"> 48</span><span class="context"></span>
<span class="line-number"> 49</span><span class="context"></span>
<span class="line-number"> 50</span><span class="context">def main() -&gt; int:</span>
</pre>
<h4>Function: load_config_from_path - Line 47</h4>
<pre>
<span class="line-number"> 42</span><span class="context">            with open(file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number"> 43</span><span class="context">                data = json.load(f)</span>
<span class="line-number"> 44</span><span class="context">                config.update(data)</span>
<span class="line-number"> 45</span><span class="context">        return config</span>
<span class="line-number"> 46</span><span class="context">    else:</span>
<span class="line-number"> 47</span><span class="uncovered">        raise FileNotFoundError(f&quot;Config path not found: {config_path}&quot;)</span>
<span class="line-number"> 48</span><span class="context"></span>
<span class="line-number"> 49</span><span class="context"></span>
<span class="line-number"> 50</span><span class="context">def main() -&gt; int:</span>
<span class="line-number"> 51</span><span class="context">    parser = argparse.ArgumentParser(</span>
<span class="line-number"> 52</span><span class="context">        description=&quot;C to PlantUML Converter (Simplified CLI)&quot;,</span>
</pre>
<h4>Function: main - Line 85</h4>
<pre>
<span class="line-number"> 80</span><span class="context">    setup_logging(args.verbose)</span>
<span class="line-number"> 81</span><span class="context"></span>
<span class="line-number"> 82</span><span class="context">    # Determine config path</span>
<span class="line-number"> 83</span><span class="context">    config_path = args.config</span>
<span class="line-number"> 84</span><span class="context">    if config_path is None:</span>
<span class="line-number"> 85</span><span class="uncovered">        config_path = os.getcwd()</span>
<span class="line-number"> 86</span><span class="context"></span>
<span class="line-number"> 87</span><span class="context">    logging.info(&quot;Using config: %s&quot;, config_path)</span>
<span class="line-number"> 88</span><span class="context"></span>
<span class="line-number"> 89</span><span class="context">    # Load config</span>
<span class="line-number"> 90</span><span class="context">    try:</span>
</pre>
<h4>Function: main - Lines 93-95</h4>
<pre>
<span class="line-number"> 88</span><span class="context"></span>
<span class="line-number"> 89</span><span class="context">    # Load config</span>
<span class="line-number"> 90</span><span class="context">    try:</span>
<span class="line-number"> 91</span><span class="context">        config_data = load_config_from_path(config_path)</span>
<span class="line-number"> 92</span><span class="context">        config = Config(**config_data)</span>
<span class="line-number"> 93</span><span class="uncovered">    except Exception as e:</span>
<span class="line-number"> 94</span><span class="uncovered">        logging.error(&quot;Failed to load configuration: %s&quot;, e)</span>
<span class="line-number"> 95</span><span class="uncovered">        return 1</span>
<span class="line-number"> 96</span><span class="context"></span>
<span class="line-number"> 97</span><span class="context">    # Determine output folder from config, default to ./output</span>
<span class="line-number"> 98</span><span class="context">    output_folder = getattr(config, &quot;output_dir&quot;, None) or os.path.join(</span>
<span class="line-number"> 99</span><span class="context">        os.getcwd(), &quot;output&quot;</span>
<span class="line-number">100</span><span class="context">    )</span>
</pre>
<h4>Function: main - Lines 110-111</h4>
<pre>
<span class="line-number">105</span><span class="context">    model_file = os.path.join(output_folder, &quot;model.json&quot;)</span>
<span class="line-number">106</span><span class="context">    transformed_model_file = os.path.join(output_folder, &quot;model_transformed.json&quot;)</span>
<span class="line-number">107</span><span class="context"></span>
<span class="line-number">108</span><span class="context">    # Parse command</span>
<span class="line-number">109</span><span class="context">    if args.command == &quot;parse&quot;:</span>
<span class="line-number">110</span><span class="uncovered">        try:</span>
<span class="line-number">111</span><span class="uncovered">            parser_obj = Parser()</span>
<span class="line-number">112</span><span class="context">            # Use the refactored parse function that handles both single and multiple source folders</span>
<span class="line-number">113</span><span class="context">            parser_obj.parse(</span>
<span class="line-number">114</span><span class="context">                project_root=config.source_folders,</span>
<span class="line-number">115</span><span class="context">                output_file=model_file,</span>
<span class="line-number">116</span><span class="context">                recursive_search=getattr(config, &quot;recursive_search&quot;, True),</span>
</pre>
<h4>Function: main - Line 113</h4>
<pre>
<span class="line-number">108</span><span class="context">    # Parse command</span>
<span class="line-number">109</span><span class="context">    if args.command == &quot;parse&quot;:</span>
<span class="line-number">110</span><span class="context">        try:</span>
<span class="line-number">111</span><span class="context">            parser_obj = Parser()</span>
<span class="line-number">112</span><span class="context">            # Use the refactored parse function that handles both single and multiple source folders</span>
<span class="line-number">113</span><span class="uncovered">            parser_obj.parse(</span>
<span class="line-number">114</span><span class="context">                project_root=config.source_folders,</span>
<span class="line-number">115</span><span class="context">                output_file=model_file,</span>
<span class="line-number">116</span><span class="context">                recursive_search=getattr(config, &quot;recursive_search&quot;, True),</span>
<span class="line-number">117</span><span class="context">                config=config,</span>
<span class="line-number">118</span><span class="context">            )</span>
</pre>
<h4>Function: main - Lines 119-123</h4>
<pre>
<span class="line-number">114</span><span class="context">                project_root=config.source_folders,</span>
<span class="line-number">115</span><span class="context">                output_file=model_file,</span>
<span class="line-number">116</span><span class="context">                recursive_search=getattr(config, &quot;recursive_search&quot;, True),</span>
<span class="line-number">117</span><span class="context">                config=config,</span>
<span class="line-number">118</span><span class="context">            )</span>
<span class="line-number">119</span><span class="uncovered">            logging.info(&quot;Model saved to: %s&quot;, model_file)</span>
<span class="line-number">120</span><span class="uncovered">            return 0</span>
<span class="line-number">121</span><span class="uncovered">        except (OSError, ValueError, RuntimeError) as e:</span>
<span class="line-number">122</span><span class="uncovered">            logging.error(&quot;Error during parsing: %s&quot;, e)</span>
<span class="line-number">123</span><span class="uncovered">            return 1</span>
<span class="line-number">124</span><span class="context"></span>
<span class="line-number">125</span><span class="context">    # Transform command</span>
<span class="line-number">126</span><span class="context">    if args.command == &quot;transform&quot;:</span>
<span class="line-number">127</span><span class="context">        try:</span>
<span class="line-number">128</span><span class="context">            transformer = Transformer()</span>
</pre>
<h4>Function: main - Lines 127-129</h4>
<pre>
<span class="line-number">122</span><span class="context">            logging.error(&quot;Error during parsing: %s&quot;, e)</span>
<span class="line-number">123</span><span class="context">            return 1</span>
<span class="line-number">124</span><span class="context"></span>
<span class="line-number">125</span><span class="context">    # Transform command</span>
<span class="line-number">126</span><span class="context">    if args.command == &quot;transform&quot;:</span>
<span class="line-number">127</span><span class="uncovered">        try:</span>
<span class="line-number">128</span><span class="uncovered">            transformer = Transformer()</span>
<span class="line-number">129</span><span class="uncovered">            transformer.transform(</span>
<span class="line-number">130</span><span class="context">                model_file=model_file,</span>
<span class="line-number">131</span><span class="context">                config_file=(</span>
<span class="line-number">132</span><span class="context">                    config_path</span>
<span class="line-number">133</span><span class="context">                    if Path(config_path).is_file()</span>
<span class="line-number">134</span><span class="context">                    else str(list(Path(config_path).glob(&quot;*.json&quot;))[0])</span>
</pre>
<h4>Function: main - Lines 138-142</h4>
<pre>
<span class="line-number">133</span><span class="context">                    if Path(config_path).is_file()</span>
<span class="line-number">134</span><span class="context">                    else str(list(Path(config_path).glob(&quot;*.json&quot;))[0])</span>
<span class="line-number">135</span><span class="context">                ),</span>
<span class="line-number">136</span><span class="context">                output_file=transformed_model_file,</span>
<span class="line-number">137</span><span class="context">            )</span>
<span class="line-number">138</span><span class="uncovered">            logging.info(&quot;Transformed model saved to: %s&quot;, transformed_model_file)</span>
<span class="line-number">139</span><span class="uncovered">            return 0</span>
<span class="line-number">140</span><span class="uncovered">        except (OSError, ValueError, RuntimeError) as e:</span>
<span class="line-number">141</span><span class="uncovered">            logging.error(&quot;Error during transformation: %s&quot;, e)</span>
<span class="line-number">142</span><span class="uncovered">            return 1</span>
<span class="line-number">143</span><span class="context"></span>
<span class="line-number">144</span><span class="context">    # Generate command</span>
<span class="line-number">145</span><span class="context">    if args.command == &quot;generate&quot;:</span>
<span class="line-number">146</span><span class="context">        try:</span>
<span class="line-number">147</span><span class="context">            generator = Generator()</span>
</pre>
<h4>Function: main - Lines 146-147</h4>
<pre>
<span class="line-number">141</span><span class="context">            logging.error(&quot;Error during transformation: %s&quot;, e)</span>
<span class="line-number">142</span><span class="context">            return 1</span>
<span class="line-number">143</span><span class="context"></span>
<span class="line-number">144</span><span class="context">    # Generate command</span>
<span class="line-number">145</span><span class="context">    if args.command == &quot;generate&quot;:</span>
<span class="line-number">146</span><span class="uncovered">        try:</span>
<span class="line-number">147</span><span class="uncovered">            generator = Generator()</span>
<span class="line-number">148</span><span class="context">            # Prefer transformed model, else fallback to model.json</span>
<span class="line-number">149</span><span class="context">            if os.path.exists(transformed_model_file):</span>
<span class="line-number">150</span><span class="context">                model_to_use = transformed_model_file</span>
<span class="line-number">151</span><span class="context">            elif os.path.exists(model_file):</span>
<span class="line-number">152</span><span class="context">                model_to_use = model_file</span>
</pre>
<h4>Function: main - Lines 149-152</h4>
<pre>
<span class="line-number">144</span><span class="context">    # Generate command</span>
<span class="line-number">145</span><span class="context">    if args.command == &quot;generate&quot;:</span>
<span class="line-number">146</span><span class="context">        try:</span>
<span class="line-number">147</span><span class="context">            generator = Generator()</span>
<span class="line-number">148</span><span class="context">            # Prefer transformed model, else fallback to model.json</span>
<span class="line-number">149</span><span class="uncovered">            if os.path.exists(transformed_model_file):</span>
<span class="line-number">150</span><span class="uncovered">                model_to_use = transformed_model_file</span>
<span class="line-number">151</span><span class="uncovered">            elif os.path.exists(model_file):</span>
<span class="line-number">152</span><span class="uncovered">                model_to_use = model_file</span>
<span class="line-number">153</span><span class="context">            else:</span>
<span class="line-number">154</span><span class="context">                logging.error(&quot;No model file found for generation.&quot;)</span>
<span class="line-number">155</span><span class="context">                return 1</span>
<span class="line-number">156</span><span class="context">            generator.generate(</span>
<span class="line-number">157</span><span class="context">                model_file=model_to_use,</span>
</pre>
<h4>Function: main - Lines 154-156</h4>
<pre>
<span class="line-number">149</span><span class="context">            if os.path.exists(transformed_model_file):</span>
<span class="line-number">150</span><span class="context">                model_to_use = transformed_model_file</span>
<span class="line-number">151</span><span class="context">            elif os.path.exists(model_file):</span>
<span class="line-number">152</span><span class="context">                model_to_use = model_file</span>
<span class="line-number">153</span><span class="context">            else:</span>
<span class="line-number">154</span><span class="uncovered">                logging.error(&quot;No model file found for generation.&quot;)</span>
<span class="line-number">155</span><span class="uncovered">                return 1</span>
<span class="line-number">156</span><span class="uncovered">            generator.generate(</span>
<span class="line-number">157</span><span class="context">                model_file=model_to_use,</span>
<span class="line-number">158</span><span class="context">                output_dir=output_folder,</span>
<span class="line-number">159</span><span class="context">                include_depth=getattr(config, &quot;include_depth&quot;, 1),</span>
<span class="line-number">160</span><span class="context">            )</span>
<span class="line-number">161</span><span class="context">            logging.info(&quot;PlantUML generation complete! Output in: %s&quot;, output_folder)</span>
</pre>
<h4>Function: main - Lines 161-165</h4>
<pre>
<span class="line-number">156</span><span class="context">            generator.generate(</span>
<span class="line-number">157</span><span class="context">                model_file=model_to_use,</span>
<span class="line-number">158</span><span class="context">                output_dir=output_folder,</span>
<span class="line-number">159</span><span class="context">                include_depth=getattr(config, &quot;include_depth&quot;, 1),</span>
<span class="line-number">160</span><span class="context">            )</span>
<span class="line-number">161</span><span class="uncovered">            logging.info(&quot;PlantUML generation complete! Output in: %s&quot;, output_folder)</span>
<span class="line-number">162</span><span class="uncovered">            return 0</span>
<span class="line-number">163</span><span class="uncovered">        except (OSError, ValueError, RuntimeError) as e:</span>
<span class="line-number">164</span><span class="uncovered">            logging.error(&quot;Error generating PlantUML: %s&quot;, e)</span>
<span class="line-number">165</span><span class="uncovered">            return 1</span>
<span class="line-number">166</span><span class="context"></span>
<span class="line-number">167</span><span class="context">    # Default: full workflow</span>
<span class="line-number">168</span><span class="context">    try:</span>
<span class="line-number">169</span><span class="context">        # Step 1: Parse</span>
<span class="line-number">170</span><span class="context">        parser_obj = Parser()</span>
</pre>
<h4>Function: main - Lines 201-203</h4>
<pre>
<span class="line-number">196</span><span class="context">            include_depth=getattr(config, &quot;include_depth&quot;, 1),</span>
<span class="line-number">197</span><span class="context">        )</span>
<span class="line-number">198</span><span class="context">        logging.info(&quot;PlantUML generation complete! Output in: %s&quot;, output_folder)</span>
<span class="line-number">199</span><span class="context">        logging.info(&quot;Complete workflow finished successfully!&quot;)</span>
<span class="line-number">200</span><span class="context">        return 0</span>
<span class="line-number">201</span><span class="uncovered">    except (OSError, ValueError, RuntimeError) as e:</span>
<span class="line-number">202</span><span class="uncovered">        logging.error(&quot;Error in workflow: %s&quot;, e)</span>
<span class="line-number">203</span><span class="uncovered">        return 1</span>
<span class="line-number">204</span><span class="context"></span>
<span class="line-number">205</span><span class="context"></span>
<span class="line-number">206</span><span class="context">if __name__ == &quot;__main__&quot;:</span>
<span class="line-number">207</span><span class="context">    sys.exit(main())</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/models.py - 86.54% coverage (225/260 lines)
</div>
<h4>Function: __post_init__ - Line 27</h4>
<pre>
<span class="line-number"> 22</span><span class="context">        return f&quot;Field(name={self.name}, type={self.type})&quot;</span>
<span class="line-number"> 23</span><span class="context"></span>
<span class="line-number"> 24</span><span class="context">    def __post_init__(self):</span>
<span class="line-number"> 25</span><span class="context">        &quot;&quot;&quot;Validate field data after initialization&quot;&quot;&quot;</span>
<span class="line-number"> 26</span><span class="context">        if not isinstance(self.name, str):</span>
<span class="line-number"> 27</span><span class="uncovered">            raise ValueError(</span>
<span class="line-number"> 28</span><span class="context">                f&quot;Field name must be a string, got {type(self.name)}: {repr(self.name)}&quot;</span>
<span class="line-number"> 29</span><span class="context">            )</span>
<span class="line-number"> 30</span><span class="context">        if not self.type or not isinstance(self.type, str):</span>
<span class="line-number"> 31</span><span class="context">            raise ValueError(</span>
<span class="line-number"> 32</span><span class="context">                f&quot;Field type must be a non-empty string, got {type(self.type)}: {repr(self.type)}&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 31</h4>
<pre>
<span class="line-number"> 26</span><span class="context">        if not isinstance(self.name, str):</span>
<span class="line-number"> 27</span><span class="context">            raise ValueError(</span>
<span class="line-number"> 28</span><span class="context">                f&quot;Field name must be a string, got {type(self.name)}: {repr(self.name)}&quot;</span>
<span class="line-number"> 29</span><span class="context">            )</span>
<span class="line-number"> 30</span><span class="context">        if not self.type or not isinstance(self.type, str):</span>
<span class="line-number"> 31</span><span class="uncovered">            raise ValueError(</span>
<span class="line-number"> 32</span><span class="context">                f&quot;Field type must be a non-empty string, got {type(self.type)}: {repr(self.type)}&quot;</span>
<span class="line-number"> 33</span><span class="context">            )</span>
<span class="line-number"> 34</span><span class="context"></span>
<span class="line-number"> 35</span><span class="context">        # Additional validation: ensure name and type are not just whitespace</span>
<span class="line-number"> 36</span><span class="context">        if not self.name.strip():</span>
</pre>
<h4>Function: __post_init__ - Line 37</h4>
<pre>
<span class="line-number"> 32</span><span class="context">                f&quot;Field type must be a non-empty string, got {type(self.type)}: {repr(self.type)}&quot;</span>
<span class="line-number"> 33</span><span class="context">            )</span>
<span class="line-number"> 34</span><span class="context"></span>
<span class="line-number"> 35</span><span class="context">        # Additional validation: ensure name and type are not just whitespace</span>
<span class="line-number"> 36</span><span class="context">        if not self.name.strip():</span>
<span class="line-number"> 37</span><span class="uncovered">            raise ValueError(</span>
<span class="line-number"> 38</span><span class="context">                f&quot;Field name cannot be empty or whitespace, got: {repr(self.name)}&quot;</span>
<span class="line-number"> 39</span><span class="context">            )</span>
<span class="line-number"> 40</span><span class="context">        if not self.type.strip():</span>
<span class="line-number"> 41</span><span class="context">            raise ValueError(</span>
<span class="line-number"> 42</span><span class="context">                f&quot;Field type cannot be empty or whitespace, got: {repr(self.type)}&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 41</h4>
<pre>
<span class="line-number"> 36</span><span class="context">        if not self.name.strip():</span>
<span class="line-number"> 37</span><span class="context">            raise ValueError(</span>
<span class="line-number"> 38</span><span class="context">                f&quot;Field name cannot be empty or whitespace, got: {repr(self.name)}&quot;</span>
<span class="line-number"> 39</span><span class="context">            )</span>
<span class="line-number"> 40</span><span class="context">        if not self.type.strip():</span>
<span class="line-number"> 41</span><span class="uncovered">            raise ValueError(</span>
<span class="line-number"> 42</span><span class="context">                f&quot;Field type cannot be empty or whitespace, got: {repr(self.type)}&quot;</span>
<span class="line-number"> 43</span><span class="context">            )</span>
<span class="line-number"> 44</span><span class="context"></span>
<span class="line-number"> 45</span><span class="context"></span>
<span class="line-number"> 46</span><span class="context"># TypedefRelation class removed - tag names moved to struct/enum/union</span>
</pre>
<h4>Function: __post_init__ - Line 60</h4>
<pre>
<span class="line-number"> 55</span><span class="context">    depth: int</span>
<span class="line-number"> 56</span><span class="context"></span>
<span class="line-number"> 57</span><span class="context">    def __post_init__(self):</span>
<span class="line-number"> 58</span><span class="context">        &quot;&quot;&quot;Validate include relation data after initialization&quot;&quot;&quot;</span>
<span class="line-number"> 59</span><span class="context">        if not self.source_file or not isinstance(self.source_file, str):</span>
<span class="line-number"> 60</span><span class="uncovered">            raise ValueError(&quot;Source file must be a non-empty string&quot;)</span>
<span class="line-number"> 61</span><span class="context">        if not self.included_file or not isinstance(self.included_file, str):</span>
<span class="line-number"> 62</span><span class="context">            raise ValueError(&quot;Included file must be a non-empty string&quot;)</span>
<span class="line-number"> 63</span><span class="context">        if not isinstance(self.depth, int) or self.depth &lt; 0:</span>
<span class="line-number"> 64</span><span class="context">            raise ValueError(&quot;Depth must be a non-negative integer&quot;)</span>
<span class="line-number"> 65</span><span class="context"></span>
</pre>
<h4>Function: __post_init__ - Line 62</h4>
<pre>
<span class="line-number"> 57</span><span class="context">    def __post_init__(self):</span>
<span class="line-number"> 58</span><span class="context">        &quot;&quot;&quot;Validate include relation data after initialization&quot;&quot;&quot;</span>
<span class="line-number"> 59</span><span class="context">        if not self.source_file or not isinstance(self.source_file, str):</span>
<span class="line-number"> 60</span><span class="context">            raise ValueError(&quot;Source file must be a non-empty string&quot;)</span>
<span class="line-number"> 61</span><span class="context">        if not self.included_file or not isinstance(self.included_file, str):</span>
<span class="line-number"> 62</span><span class="uncovered">            raise ValueError(&quot;Included file must be a non-empty string&quot;)</span>
<span class="line-number"> 63</span><span class="context">        if not isinstance(self.depth, int) or self.depth &lt; 0:</span>
<span class="line-number"> 64</span><span class="context">            raise ValueError(&quot;Depth must be a non-negative integer&quot;)</span>
<span class="line-number"> 65</span><span class="context"></span>
<span class="line-number"> 66</span><span class="context"></span>
<span class="line-number"> 67</span><span class="context">@dataclass</span>
</pre>
<h4>Function: __post_init__ - Line 64</h4>
<pre>
<span class="line-number"> 59</span><span class="context">        if not self.source_file or not isinstance(self.source_file, str):</span>
<span class="line-number"> 60</span><span class="context">            raise ValueError(&quot;Source file must be a non-empty string&quot;)</span>
<span class="line-number"> 61</span><span class="context">        if not self.included_file or not isinstance(self.included_file, str):</span>
<span class="line-number"> 62</span><span class="context">            raise ValueError(&quot;Included file must be a non-empty string&quot;)</span>
<span class="line-number"> 63</span><span class="context">        if not isinstance(self.depth, int) or self.depth &lt; 0:</span>
<span class="line-number"> 64</span><span class="uncovered">            raise ValueError(&quot;Depth must be a non-negative integer&quot;)</span>
<span class="line-number"> 65</span><span class="context"></span>
<span class="line-number"> 66</span><span class="context"></span>
<span class="line-number"> 67</span><span class="context">@dataclass</span>
<span class="line-number"> 68</span><span class="context">class Function:</span>
<span class="line-number"> 69</span><span class="context">    &quot;&quot;&quot;Represents a function&quot;&quot;&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 80</h4>
<pre>
<span class="line-number"> 75</span><span class="context">    is_declaration: bool = False</span>
<span class="line-number"> 76</span><span class="context"></span>
<span class="line-number"> 77</span><span class="context">    def __post_init__(self):</span>
<span class="line-number"> 78</span><span class="context">        &quot;&quot;&quot;Validate function data after initialization&quot;&quot;&quot;</span>
<span class="line-number"> 79</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number"> 80</span><span class="uncovered">            raise ValueError(&quot;Function name must be a non-empty string&quot;)</span>
<span class="line-number"> 81</span><span class="context">        if not self.return_type or not isinstance(self.return_type, str):</span>
<span class="line-number"> 82</span><span class="context">            raise ValueError(&quot;Function return type must be a non-empty string&quot;)</span>
<span class="line-number"> 83</span><span class="context"></span>
<span class="line-number"> 84</span><span class="context">        # Convert parameters to Field objects if they&#x27;re dictionaries</span>
<span class="line-number"> 85</span><span class="context">        if self.parameters:</span>
</pre>
<h4>Function: __post_init__ - Line 82</h4>
<pre>
<span class="line-number"> 77</span><span class="context">    def __post_init__(self):</span>
<span class="line-number"> 78</span><span class="context">        &quot;&quot;&quot;Validate function data after initialization&quot;&quot;&quot;</span>
<span class="line-number"> 79</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number"> 80</span><span class="context">            raise ValueError(&quot;Function name must be a non-empty string&quot;)</span>
<span class="line-number"> 81</span><span class="context">        if not self.return_type or not isinstance(self.return_type, str):</span>
<span class="line-number"> 82</span><span class="uncovered">            raise ValueError(&quot;Function return type must be a non-empty string&quot;)</span>
<span class="line-number"> 83</span><span class="context"></span>
<span class="line-number"> 84</span><span class="context">        # Convert parameters to Field objects if they&#x27;re dictionaries</span>
<span class="line-number"> 85</span><span class="context">        if self.parameters:</span>
<span class="line-number"> 86</span><span class="context">            converted_params = []</span>
<span class="line-number"> 87</span><span class="context">            for param in self.parameters:</span>
</pre>
<h4>Function: __post_init__ - Line 110</h4>
<pre>
<span class="line-number">105</span><span class="context">    )  # Non-primitive types used by this struct</span>
<span class="line-number">106</span><span class="context"></span>
<span class="line-number">107</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">108</span><span class="context">        &quot;&quot;&quot;Validate struct data after initialization&quot;&quot;&quot;</span>
<span class="line-number">109</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number">110</span><span class="uncovered">            raise ValueError(&quot;Struct name must be a non-empty string&quot;)</span>
<span class="line-number">111</span><span class="context"></span>
<span class="line-number">112</span><span class="context"></span>
<span class="line-number">113</span><span class="context">@dataclass</span>
<span class="line-number">114</span><span class="context">class EnumValue:</span>
<span class="line-number">115</span><span class="context">    name: str</span>
</pre>
<h4>Function: __post_init__ - Line 120</h4>
<pre>
<span class="line-number">115</span><span class="context">    name: str</span>
<span class="line-number">116</span><span class="context">    value: Optional[str] = None</span>
<span class="line-number">117</span><span class="context"></span>
<span class="line-number">118</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">119</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number">120</span><span class="uncovered">            raise ValueError(&quot;Enum value name must be a non-empty string&quot;)</span>
<span class="line-number">121</span><span class="context"></span>
<span class="line-number">122</span><span class="context"></span>
<span class="line-number">123</span><span class="context">@dataclass</span>
<span class="line-number">124</span><span class="context">class Enum:</span>
<span class="line-number">125</span><span class="context">    &quot;&quot;&quot;Represents a C enum&quot;&quot;&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 133</h4>
<pre>
<span class="line-number">128</span><span class="context">    values: List[EnumValue] = field(default_factory=list)</span>
<span class="line-number">129</span><span class="context">    tag_name: str = &quot;&quot;  # Tag name for typedef enums</span>
<span class="line-number">130</span><span class="context"></span>
<span class="line-number">131</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">132</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number">133</span><span class="uncovered">            raise ValueError(&quot;Enum name must be a non-empty string&quot;)</span>
<span class="line-number">134</span><span class="context">        # Convert any string values to EnumValue</span>
<span class="line-number">135</span><span class="context">        self.values = [</span>
<span class="line-number">136</span><span class="context">            v if isinstance(v, EnumValue) else EnumValue(v) for v in self.values</span>
<span class="line-number">137</span><span class="context">        ]</span>
<span class="line-number">138</span><span class="context"></span>
</pre>
<h4>Function: __post_init__ - Line 154</h4>
<pre>
<span class="line-number">149</span><span class="context">    )  # Non-primitive types used by this union</span>
<span class="line-number">150</span><span class="context"></span>
<span class="line-number">151</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">152</span><span class="context">        &quot;&quot;&quot;Validate union data after initialization&quot;&quot;&quot;</span>
<span class="line-number">153</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number">154</span><span class="uncovered">            raise ValueError(&quot;Union name must be a non-empty string&quot;)</span>
<span class="line-number">155</span><span class="context"></span>
<span class="line-number">156</span><span class="context"></span>
<span class="line-number">157</span><span class="context">@dataclass</span>
<span class="line-number">158</span><span class="context">class Alias:</span>
<span class="line-number">159</span><span class="context">    &quot;&quot;&quot;Represents a type alias (typedef)&quot;&quot;&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 170</h4>
<pre>
<span class="line-number">165</span><span class="context">    )  # Non-primitive types used by this alias</span>
<span class="line-number">166</span><span class="context"></span>
<span class="line-number">167</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">168</span><span class="context">        &quot;&quot;&quot;Validate alias data after initialization&quot;&quot;&quot;</span>
<span class="line-number">169</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number">170</span><span class="uncovered">            raise ValueError(&quot;Alias name must be a non-empty string&quot;)</span>
<span class="line-number">171</span><span class="context">        if not self.original_type or not isinstance(self.original_type, str):</span>
<span class="line-number">172</span><span class="context">            raise ValueError(&quot;Original type must be a non-empty string&quot;)</span>
<span class="line-number">173</span><span class="context"></span>
<span class="line-number">174</span><span class="context"></span>
<span class="line-number">175</span><span class="context">@dataclass</span>
</pre>
<h4>Function: __post_init__ - Line 172</h4>
<pre>
<span class="line-number">167</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">168</span><span class="context">        &quot;&quot;&quot;Validate alias data after initialization&quot;&quot;&quot;</span>
<span class="line-number">169</span><span class="context">        if not self.name or not isinstance(self.name, str):</span>
<span class="line-number">170</span><span class="context">            raise ValueError(&quot;Alias name must be a non-empty string&quot;)</span>
<span class="line-number">171</span><span class="context">        if not self.original_type or not isinstance(self.original_type, str):</span>
<span class="line-number">172</span><span class="uncovered">            raise ValueError(&quot;Original type must be a non-empty string&quot;)</span>
<span class="line-number">173</span><span class="context"></span>
<span class="line-number">174</span><span class="context"></span>
<span class="line-number">175</span><span class="context">@dataclass</span>
<span class="line-number">176</span><span class="context">class FileModel:</span>
<span class="line-number">177</span><span class="context">    &quot;&quot;&quot;Represents a parsed C/C++ file&quot;&quot;&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 196</h4>
<pre>
<span class="line-number">191</span><span class="context">    include_relations: List[IncludeRelation] = field(default_factory=list)</span>
<span class="line-number">192</span><span class="context"></span>
<span class="line-number">193</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">194</span><span class="context">        &quot;&quot;&quot;Validate file model data after initialization&quot;&quot;&quot;</span>
<span class="line-number">195</span><span class="context">        if not self.file_path or not isinstance(self.file_path, str):</span>
<span class="line-number">196</span><span class="uncovered">            raise ValueError(&quot;File path must be a non-empty string&quot;)</span>
<span class="line-number">197</span><span class="context">        if not self.relative_path or not isinstance(self.relative_path, str):</span>
<span class="line-number">198</span><span class="context">            raise ValueError(&quot;Relative path must be a non-empty string&quot;)</span>
<span class="line-number">199</span><span class="context">        if not self.project_root or not isinstance(self.project_root, str):</span>
<span class="line-number">200</span><span class="context">            raise ValueError(&quot;Project root must be a non-empty string&quot;)</span>
<span class="line-number">201</span><span class="context">        if not self.encoding_used or not isinstance(self.encoding_used, str):</span>
</pre>
<h4>Function: __post_init__ - Line 198</h4>
<pre>
<span class="line-number">193</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">194</span><span class="context">        &quot;&quot;&quot;Validate file model data after initialization&quot;&quot;&quot;</span>
<span class="line-number">195</span><span class="context">        if not self.file_path or not isinstance(self.file_path, str):</span>
<span class="line-number">196</span><span class="context">            raise ValueError(&quot;File path must be a non-empty string&quot;)</span>
<span class="line-number">197</span><span class="context">        if not self.relative_path or not isinstance(self.relative_path, str):</span>
<span class="line-number">198</span><span class="uncovered">            raise ValueError(&quot;Relative path must be a non-empty string&quot;)</span>
<span class="line-number">199</span><span class="context">        if not self.project_root or not isinstance(self.project_root, str):</span>
<span class="line-number">200</span><span class="context">            raise ValueError(&quot;Project root must be a non-empty string&quot;)</span>
<span class="line-number">201</span><span class="context">        if not self.encoding_used or not isinstance(self.encoding_used, str):</span>
<span class="line-number">202</span><span class="context">            raise ValueError(&quot;Encoding must be a non-empty string&quot;)</span>
<span class="line-number">203</span><span class="context"></span>
</pre>
<h4>Function: __post_init__ - Line 200</h4>
<pre>
<span class="line-number">195</span><span class="context">        if not self.file_path or not isinstance(self.file_path, str):</span>
<span class="line-number">196</span><span class="context">            raise ValueError(&quot;File path must be a non-empty string&quot;)</span>
<span class="line-number">197</span><span class="context">        if not self.relative_path or not isinstance(self.relative_path, str):</span>
<span class="line-number">198</span><span class="context">            raise ValueError(&quot;Relative path must be a non-empty string&quot;)</span>
<span class="line-number">199</span><span class="context">        if not self.project_root or not isinstance(self.project_root, str):</span>
<span class="line-number">200</span><span class="uncovered">            raise ValueError(&quot;Project root must be a non-empty string&quot;)</span>
<span class="line-number">201</span><span class="context">        if not self.encoding_used or not isinstance(self.encoding_used, str):</span>
<span class="line-number">202</span><span class="context">            raise ValueError(&quot;Encoding must be a non-empty string&quot;)</span>
<span class="line-number">203</span><span class="context"></span>
<span class="line-number">204</span><span class="context">    def to_dict(self) -&gt; dict:</span>
<span class="line-number">205</span><span class="context">        &quot;&quot;&quot;Convert to dictionary for JSON serialization&quot;&quot;&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 202</h4>
<pre>
<span class="line-number">197</span><span class="context">        if not self.relative_path or not isinstance(self.relative_path, str):</span>
<span class="line-number">198</span><span class="context">            raise ValueError(&quot;Relative path must be a non-empty string&quot;)</span>
<span class="line-number">199</span><span class="context">        if not self.project_root or not isinstance(self.project_root, str):</span>
<span class="line-number">200</span><span class="context">            raise ValueError(&quot;Project root must be a non-empty string&quot;)</span>
<span class="line-number">201</span><span class="context">        if not self.encoding_used or not isinstance(self.encoding_used, str):</span>
<span class="line-number">202</span><span class="uncovered">            raise ValueError(&quot;Encoding must be a non-empty string&quot;)</span>
<span class="line-number">203</span><span class="context"></span>
<span class="line-number">204</span><span class="context">    def to_dict(self) -&gt; dict:</span>
<span class="line-number">205</span><span class="context">        &quot;&quot;&quot;Convert to dictionary for JSON serialization&quot;&quot;&quot;</span>
<span class="line-number">206</span><span class="context">        data = asdict(self)</span>
<span class="line-number">207</span><span class="context">        # Convert set to list for JSON serialization and sort for consistency</span>
</pre>
<h4>Function: from_dict - Line 278</h4>
<pre>
<span class="line-number">273</span><span class="context">                    methods=methods,</span>
<span class="line-number">274</span><span class="context">                    tag_name=struct_data.get(&quot;tag_name&quot;, &quot;&quot;),</span>
<span class="line-number">275</span><span class="context">                    uses=struct_data.get(&quot;uses&quot;, []),</span>
<span class="line-number">276</span><span class="context">                )</span>
<span class="line-number">277</span><span class="context">            else:</span>
<span class="line-number">278</span><span class="uncovered">                structs[name] = struct_data</span>
<span class="line-number">279</span><span class="context"></span>
<span class="line-number">280</span><span class="context">        # Convert enums back to Enum objects</span>
<span class="line-number">281</span><span class="context">        enums_data = data.get(&quot;enums&quot;, {})</span>
<span class="line-number">282</span><span class="context">        enums = {}</span>
<span class="line-number">283</span><span class="context">        for name, enum_data in enums_data.items():</span>
</pre>
<h4>Function: from_dict - Line 291</h4>
<pre>
<span class="line-number">286</span><span class="context">                    EnumValue(**val) if isinstance(val, dict) else EnumValue(val)</span>
<span class="line-number">287</span><span class="context">                    for val in enum_data.get(&quot;values&quot;, [])</span>
<span class="line-number">288</span><span class="context">                ]</span>
<span class="line-number">289</span><span class="context">                enums[name] = Enum(name=enum_data.get(&quot;name&quot;, name), values=values)</span>
<span class="line-number">290</span><span class="context">            else:</span>
<span class="line-number">291</span><span class="uncovered">                enums[name] = enum_data</span>
<span class="line-number">292</span><span class="context"></span>
<span class="line-number">293</span><span class="context">        # typedef_relations removed - tag names are now in struct/enum/union</span>
<span class="line-number">294</span><span class="context"></span>
<span class="line-number">295</span><span class="context">        # Convert include_relations back to IncludeRelation objects</span>
<span class="line-number">296</span><span class="context">        include_relations_data = data.get(&quot;include_relations&quot;, [])</span>
</pre>
<h4>Function: from_dict - Line 318</h4>
<pre>
<span class="line-number">313</span><span class="context">                    fields=fields,</span>
<span class="line-number">314</span><span class="context">                    tag_name=union_data.get(&quot;tag_name&quot;, &quot;&quot;),</span>
<span class="line-number">315</span><span class="context">                    uses=union_data.get(&quot;uses&quot;, []),</span>
<span class="line-number">316</span><span class="context">                )</span>
<span class="line-number">317</span><span class="context">            else:</span>
<span class="line-number">318</span><span class="uncovered">                unions[name] = union_data</span>
<span class="line-number">319</span><span class="context"></span>
<span class="line-number">320</span><span class="context">        # Convert aliases back to Alias objects</span>
<span class="line-number">321</span><span class="context">        aliases_data = data.get(&quot;aliases&quot;, {})</span>
<span class="line-number">322</span><span class="context">        aliases = {}</span>
<span class="line-number">323</span><span class="context">        for name, alias_data in aliases_data.items():</span>
</pre>
<h4>Function: from_dict - Line 332</h4>
<pre>
<span class="line-number">327</span><span class="context">                    original_type=alias_data.get(&quot;original_type&quot;, &quot;&quot;),</span>
<span class="line-number">328</span><span class="context">                    uses=alias_data.get(&quot;uses&quot;, []),</span>
<span class="line-number">329</span><span class="context">                )</span>
<span class="line-number">330</span><span class="context">            else:</span>
<span class="line-number">331</span><span class="context">                # Handle legacy format where aliases was Dict[str, str]</span>
<span class="line-number">332</span><span class="uncovered">                aliases[name] = Alias(name=name, original_type=alias_data, uses=[])</span>
<span class="line-number">333</span><span class="context"></span>
<span class="line-number">334</span><span class="context">        # Create new data dict with converted objects</span>
<span class="line-number">335</span><span class="context">        new_data = data.copy()</span>
<span class="line-number">336</span><span class="context">        new_data[&quot;includes&quot;] = includes</span>
<span class="line-number">337</span><span class="context">        new_data[&quot;globals&quot;] = globals</span>
</pre>
<h4>Function: get_summary - Line 349</h4>
<pre>
<span class="line-number">344</span><span class="context"></span>
<span class="line-number">345</span><span class="context">        return cls(**new_data)</span>
<span class="line-number">346</span><span class="context"></span>
<span class="line-number">347</span><span class="context">    def get_summary(self) -&gt; dict:</span>
<span class="line-number">348</span><span class="context">        &quot;&quot;&quot;Get a summary of the file contents&quot;&quot;&quot;</span>
<span class="line-number">349</span><span class="uncovered">        return {</span>
<span class="line-number">350</span><span class="context">            &quot;file_path&quot;: self.file_path,</span>
<span class="line-number">351</span><span class="context">            &quot;structs_count&quot;: len(self.structs),</span>
<span class="line-number">352</span><span class="context">            &quot;enums_count&quot;: len(self.enums),</span>
<span class="line-number">353</span><span class="context">            &quot;functions_count&quot;: len(self.functions),</span>
<span class="line-number">354</span><span class="context">            &quot;globals_count&quot;: len(self.globals),</span>
</pre>
<h4>Function: __post_init__ - Line 372</h4>
<pre>
<span class="line-number">367</span><span class="context">    files: Dict[str, FileModel] = field(default_factory=dict)</span>
<span class="line-number">368</span><span class="context"></span>
<span class="line-number">369</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">370</span><span class="context">        &quot;&quot;&quot;Validate project model data after initialization&quot;&quot;&quot;</span>
<span class="line-number">371</span><span class="context">        if not self.project_name or not isinstance(self.project_name, str):</span>
<span class="line-number">372</span><span class="uncovered">            raise ValueError(&quot;Project name must be a non-empty string&quot;)</span>
<span class="line-number">373</span><span class="context">        if not self.project_root or not isinstance(self.project_root, str):</span>
<span class="line-number">374</span><span class="context">            raise ValueError(&quot;Project root must be a non-empty string&quot;)</span>
<span class="line-number">375</span><span class="context"></span>
<span class="line-number">376</span><span class="context">    def save(self, file_path: str) -&gt; None:</span>
<span class="line-number">377</span><span class="context">        &quot;&quot;&quot;Save model to JSON file&quot;&quot;&quot;</span>
</pre>
<h4>Function: __post_init__ - Line 374</h4>
<pre>
<span class="line-number">369</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">370</span><span class="context">        &quot;&quot;&quot;Validate project model data after initialization&quot;&quot;&quot;</span>
<span class="line-number">371</span><span class="context">        if not self.project_name or not isinstance(self.project_name, str):</span>
<span class="line-number">372</span><span class="context">            raise ValueError(&quot;Project name must be a non-empty string&quot;)</span>
<span class="line-number">373</span><span class="context">        if not self.project_root or not isinstance(self.project_root, str):</span>
<span class="line-number">374</span><span class="uncovered">            raise ValueError(&quot;Project root must be a non-empty string&quot;)</span>
<span class="line-number">375</span><span class="context"></span>
<span class="line-number">376</span><span class="context">    def save(self, file_path: str) -&gt; None:</span>
<span class="line-number">377</span><span class="context">        &quot;&quot;&quot;Save model to JSON file&quot;&quot;&quot;</span>
<span class="line-number">378</span><span class="context">        data = {</span>
<span class="line-number">379</span><span class="context">            &quot;project_name&quot;: self.project_name,</span>
</pre>
<h4>Function: save - Lines 390-391</h4>
<pre>
<span class="line-number">385</span><span class="context">        }</span>
<span class="line-number">386</span><span class="context"></span>
<span class="line-number">387</span><span class="context">        try:</span>
<span class="line-number">388</span><span class="context">            with open(file_path, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number">389</span><span class="context">                json.dump(data, f, indent=2, ensure_ascii=False, sort_keys=True)</span>
<span class="line-number">390</span><span class="uncovered">        except Exception as e:</span>
<span class="line-number">391</span><span class="uncovered">            raise ValueError(f&quot;Failed to save model to {file_path}: {e}&quot;) from e</span>
<span class="line-number">392</span><span class="context"></span>
<span class="line-number">393</span><span class="context">    @classmethod</span>
<span class="line-number">394</span><span class="context">    def from_dict(cls, data: dict) -&gt; &quot;ProjectModel&quot;:</span>
<span class="line-number">395</span><span class="context">        &quot;&quot;&quot;Create from dictionary&quot;&quot;&quot;</span>
<span class="line-number">396</span><span class="context">        files = {</span>
</pre>
<h4>Function: load - Lines 414-415</h4>
<pre>
<span class="line-number">409</span><span class="context">        &quot;&quot;&quot;Load model from JSON file&quot;&quot;&quot;</span>
<span class="line-number">410</span><span class="context">        try:</span>
<span class="line-number">411</span><span class="context">            with open(file_path, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number">412</span><span class="context">                data = json.load(f)</span>
<span class="line-number">413</span><span class="context">            return cls.from_dict(data)</span>
<span class="line-number">414</span><span class="uncovered">        except Exception as e:</span>
<span class="line-number">415</span><span class="uncovered">            raise ValueError(f&quot;Failed to load model from {file_path}: {e}&quot;) from e</span>
<span class="line-number">416</span><span class="context"></span>
<span class="line-number">417</span><span class="context">    def get_summary(self) -&gt; dict:</span>
<span class="line-number">418</span><span class="context">        &quot;&quot;&quot;Get a summary of the project&quot;&quot;&quot;</span>
<span class="line-number">419</span><span class="context">        total_structs = sum(len(f.structs) for f in self.files.values())</span>
<span class="line-number">420</span><span class="context">        total_enums = sum(len(f.enums) for f in self.files.values())</span>
</pre>
<h4>Function: get_summary - Lines 419-422</h4>
<pre>
<span class="line-number">414</span><span class="context">        except Exception as e:</span>
<span class="line-number">415</span><span class="context">            raise ValueError(f&quot;Failed to load model from {file_path}: {e}&quot;) from e</span>
<span class="line-number">416</span><span class="context"></span>
<span class="line-number">417</span><span class="context">    def get_summary(self) -&gt; dict:</span>
<span class="line-number">418</span><span class="context">        &quot;&quot;&quot;Get a summary of the project&quot;&quot;&quot;</span>
<span class="line-number">419</span><span class="uncovered">        total_structs = sum(len(f.structs) for f in self.files.values())</span>
<span class="line-number">420</span><span class="uncovered">        total_enums = sum(len(f.enums) for f in self.files.values())</span>
<span class="line-number">421</span><span class="uncovered">        total_functions = sum(len(f.functions) for f in self.files.values())</span>
<span class="line-number">422</span><span class="uncovered">        total_globals = sum(len(f.globals) for f in self.files.values())</span>
<span class="line-number">423</span><span class="context"></span>
<span class="line-number">424</span><span class="context">        return {</span>
<span class="line-number">425</span><span class="context">            &quot;project_name&quot;: self.project_name,</span>
<span class="line-number">426</span><span class="context">            &quot;project_root&quot;: self.project_root,</span>
<span class="line-number">427</span><span class="context">            &quot;files_count&quot;: len(self.files),</span>
</pre>
<h4>Function: get_summary - Line 424</h4>
<pre>
<span class="line-number">419</span><span class="context">        total_structs = sum(len(f.structs) for f in self.files.values())</span>
<span class="line-number">420</span><span class="context">        total_enums = sum(len(f.enums) for f in self.files.values())</span>
<span class="line-number">421</span><span class="context">        total_functions = sum(len(f.functions) for f in self.files.values())</span>
<span class="line-number">422</span><span class="context">        total_globals = sum(len(f.globals) for f in self.files.values())</span>
<span class="line-number">423</span><span class="context"></span>
<span class="line-number">424</span><span class="uncovered">        return {</span>
<span class="line-number">425</span><span class="context">            &quot;project_name&quot;: self.project_name,</span>
<span class="line-number">426</span><span class="context">            &quot;project_root&quot;: self.project_root,</span>
<span class="line-number">427</span><span class="context">            &quot;files_count&quot;: len(self.files),</span>
<span class="line-number">428</span><span class="context">            &quot;total_structs&quot;: total_structs,</span>
<span class="line-number">429</span><span class="context">            &quot;total_enums&quot;: total_enums,</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/parser.py - 87.39% coverage (617/706 lines)
</div>
<h4>Function: unknown function - Lines 21-22</h4>
<pre>
<span class="line-number"> 16</span><span class="context">)</span>
<span class="line-number"> 17</span><span class="context">from .preprocessor import PreprocessorManager</span>
<span class="line-number"> 18</span><span class="context">from .utils import detect_file_encoding</span>
<span class="line-number"> 19</span><span class="context"></span>
<span class="line-number"> 20</span><span class="context">if TYPE_CHECKING:</span>
<span class="line-number"> 21</span><span class="uncovered">    from .models import Struct, Enum, Union, Function, Field, Alias</span>
<span class="line-number"> 22</span><span class="uncovered">    from .config import Config</span>
<span class="line-number"> 23</span><span class="context"></span>
<span class="line-number"> 24</span><span class="context"></span>
<span class="line-number"> 25</span><span class="context">class CParser:</span>
<span class="line-number"> 26</span><span class="context">    &quot;&quot;&quot;C/C++ parser for extracting structural information from source code using tokenization&quot;&quot;&quot;</span>
<span class="line-number"> 27</span><span class="context"></span>
</pre>
<h4>Function: parse_project - Line 45</h4>
<pre>
<span class="line-number"> 40</span><span class="context"></span>
<span class="line-number"> 41</span><span class="context">        if not project_root.exists():</span>
<span class="line-number"> 42</span><span class="context">            raise ValueError(f&quot;Project root not found: {project_root}&quot;)</span>
<span class="line-number"> 43</span><span class="context"></span>
<span class="line-number"> 44</span><span class="context">        if not project_root.is_dir():</span>
<span class="line-number"> 45</span><span class="uncovered">            raise ValueError(f&quot;Project root must be a directory: {project_root}&quot;)</span>
<span class="line-number"> 46</span><span class="context"></span>
<span class="line-number"> 47</span><span class="context">        # Clear the failed includes cache for this new project</span>
<span class="line-number"> 48</span><span class="context">        cache_size_before = len(self._failed_includes_cache)</span>
<span class="line-number"> 49</span><span class="context">        self._failed_includes_cache.clear()</span>
<span class="line-number"> 50</span><span class="context">        if cache_size_before &gt; 0:</span>
</pre>
<h4>Function: parse_project - Line 51</h4>
<pre>
<span class="line-number"> 46</span><span class="context"></span>
<span class="line-number"> 47</span><span class="context">        # Clear the failed includes cache for this new project</span>
<span class="line-number"> 48</span><span class="context">        cache_size_before = len(self._failed_includes_cache)</span>
<span class="line-number"> 49</span><span class="context">        self._failed_includes_cache.clear()</span>
<span class="line-number"> 50</span><span class="context">        if cache_size_before &gt; 0:</span>
<span class="line-number"> 51</span><span class="uncovered">            self.logger.debug(</span>
<span class="line-number"> 52</span><span class="context">                &quot;Cleared failed includes cache (%d entries)&quot;, cache_size_before</span>
<span class="line-number"> 53</span><span class="context">            )</span>
<span class="line-number"> 54</span><span class="context"></span>
<span class="line-number"> 55</span><span class="context">        self.logger.info(&quot;Parsing project: %s&quot;, project_root)</span>
<span class="line-number"> 56</span><span class="context"></span>
</pre>
<h4>Function: parse_project - Lines 82-84</h4>
<pre>
<span class="line-number"> 77</span><span class="context">                )</span>
<span class="line-number"> 78</span><span class="context">                files[relative_path] = file_model</span>
<span class="line-number"> 79</span><span class="context"></span>
<span class="line-number"> 80</span><span class="context">                self.logger.debug(&quot;Successfully parsed: %s&quot;, relative_path)</span>
<span class="line-number"> 81</span><span class="context"></span>
<span class="line-number"> 82</span><span class="uncovered">            except (OSError, ValueError) as e:</span>
<span class="line-number"> 83</span><span class="uncovered">                self.logger.warning(&quot;Failed to parse %s: %s&quot;, file_path, e)</span>
<span class="line-number"> 84</span><span class="uncovered">                failed_files.append(str(file_path))</span>
<span class="line-number"> 85</span><span class="context"></span>
<span class="line-number"> 86</span><span class="context">        if failed_files:</span>
<span class="line-number"> 87</span><span class="context">            error_msg = (</span>
<span class="line-number"> 88</span><span class="context">                f&quot;Failed to parse {len(failed_files)} files: {failed_files}. &quot;</span>
<span class="line-number"> 89</span><span class="context">                &quot;Stopping model processing.&quot;</span>
</pre>
<h4>Function: parse_project - Line 87</h4>
<pre>
<span class="line-number"> 82</span><span class="context">            except (OSError, ValueError) as e:</span>
<span class="line-number"> 83</span><span class="context">                self.logger.warning(&quot;Failed to parse %s: %s&quot;, file_path, e)</span>
<span class="line-number"> 84</span><span class="context">                failed_files.append(str(file_path))</span>
<span class="line-number"> 85</span><span class="context"></span>
<span class="line-number"> 86</span><span class="context">        if failed_files:</span>
<span class="line-number"> 87</span><span class="uncovered">            error_msg = (</span>
<span class="line-number"> 88</span><span class="context">                f&quot;Failed to parse {len(failed_files)} files: {failed_files}. &quot;</span>
<span class="line-number"> 89</span><span class="context">                &quot;Stopping model processing.&quot;</span>
<span class="line-number"> 90</span><span class="context">            )</span>
<span class="line-number"> 91</span><span class="context">            self.logger.error(error_msg)</span>
<span class="line-number"> 92</span><span class="context">            raise RuntimeError(error_msg)</span>
</pre>
<h4>Function: parse_project - Lines 91-92</h4>
<pre>
<span class="line-number"> 86</span><span class="context">        if failed_files:</span>
<span class="line-number"> 87</span><span class="context">            error_msg = (</span>
<span class="line-number"> 88</span><span class="context">                f&quot;Failed to parse {len(failed_files)} files: {failed_files}. &quot;</span>
<span class="line-number"> 89</span><span class="context">                &quot;Stopping model processing.&quot;</span>
<span class="line-number"> 90</span><span class="context">            )</span>
<span class="line-number"> 91</span><span class="uncovered">            self.logger.error(error_msg)</span>
<span class="line-number"> 92</span><span class="uncovered">            raise RuntimeError(error_msg)</span>
<span class="line-number"> 93</span><span class="context"></span>
<span class="line-number"> 94</span><span class="context">        model = ProjectModel(</span>
<span class="line-number"> 95</span><span class="context">            project_name=project_root.name,</span>
<span class="line-number"> 96</span><span class="context">            project_root=str(project_root),</span>
<span class="line-number"> 97</span><span class="context">            files=files,</span>
</pre>
<h4>Function: _parse_structs_with_tokenizer - Lines 206-207</h4>
<pre>
<span class="line-number">201</span><span class="context">                # Convert to Field objects</span>
<span class="line-number">202</span><span class="context">                fields = []</span>
<span class="line-number">203</span><span class="context">                for field_name, field_type in field_tuples:</span>
<span class="line-number">204</span><span class="context">                    try:</span>
<span class="line-number">205</span><span class="context">                        fields.append(Field(field_name, field_type))</span>
<span class="line-number">206</span><span class="uncovered">                    except ValueError as e:</span>
<span class="line-number">207</span><span class="uncovered">                        self.logger.warning(</span>
<span class="line-number">208</span><span class="context">                            &quot;Error creating field %s: %s&quot;, field_name, e</span>
<span class="line-number">209</span><span class="context">                        )</span>
<span class="line-number">210</span><span class="context"></span>
<span class="line-number">211</span><span class="context">                # For anonymous structs, use a special key that can be mapped later</span>
<span class="line-number">212</span><span class="context">                if not struct_name:</span>
</pre>
<h4>Function: _parse_unions_with_tokenizer - Lines 306-307</h4>
<pre>
<span class="line-number">301</span><span class="context">                # Convert to Field objects</span>
<span class="line-number">302</span><span class="context">                fields = []</span>
<span class="line-number">303</span><span class="context">                for field_name, field_type in field_tuples:</span>
<span class="line-number">304</span><span class="context">                    try:</span>
<span class="line-number">305</span><span class="context">                        fields.append(Field(field_name, field_type))</span>
<span class="line-number">306</span><span class="uncovered">                    except ValueError as e:</span>
<span class="line-number">307</span><span class="uncovered">                        self.logger.warning(</span>
<span class="line-number">308</span><span class="context">                            &quot;Error creating union field %s: %s&quot;, field_name, e</span>
<span class="line-number">309</span><span class="context">                        )</span>
<span class="line-number">310</span><span class="context"></span>
<span class="line-number">311</span><span class="context">                # For anonymous unions, use a special key that can be mapped later</span>
<span class="line-number">312</span><span class="context">                if not union_name:</span>
</pre>
<h4>Function: _parse_unions_with_tokenizer - Line 313</h4>
<pre>
<span class="line-number">308</span><span class="context">                            &quot;Error creating union field %s: %s&quot;, field_name, e</span>
<span class="line-number">309</span><span class="context">                        )</span>
<span class="line-number">310</span><span class="context"></span>
<span class="line-number">311</span><span class="context">                # For anonymous unions, use a special key that can be mapped later</span>
<span class="line-number">312</span><span class="context">                if not union_name:</span>
<span class="line-number">313</span><span class="uncovered">                    union_name = &quot;__anonymous_union__&quot;</span>
<span class="line-number">314</span><span class="context"></span>
<span class="line-number">315</span><span class="context">                # Extract tag name if this is a typedef union</span>
<span class="line-number">316</span><span class="context">                tag_name = &quot;&quot;</span>
<span class="line-number">317</span><span class="context">                if union_name and not union_name.startswith(&quot;__anonymous&quot;):</span>
<span class="line-number">318</span><span class="context">                    # Check if this union has a typedef</span>
</pre>
<h4>Function: _parse_functions_with_tokenizer - Lines 370-371</h4>
<pre>
<span class="line-number">365</span><span class="context">                function.is_declaration = is_declaration</span>
<span class="line-number">366</span><span class="context">                functions.append(function)</span>
<span class="line-number">367</span><span class="context">                self.logger.debug(</span>
<span class="line-number">368</span><span class="context">                    f&quot;Parsed function: {func_name} with {len(parameters)} parameters (declaration: {is_declaration})&quot;</span>
<span class="line-number">369</span><span class="context">                )</span>
<span class="line-number">370</span><span class="uncovered">            except Exception as e:</span>
<span class="line-number">371</span><span class="uncovered">                self.logger.warning(&quot;Error creating function %s: %s&quot;, func_name, e)</span>
<span class="line-number">372</span><span class="context"></span>
<span class="line-number">373</span><span class="context">        return functions</span>
<span class="line-number">374</span><span class="context"></span>
<span class="line-number">375</span><span class="context">    def _parse_globals_with_tokenizer(self, tokens) -&gt; List[&quot;Field&quot;]:</span>
<span class="line-number">376</span><span class="context">        &quot;&quot;&quot;Parse global variables using tokenizer&quot;&quot;&quot;</span>
</pre>
<h4>Function: _parse_globals_with_tokenizer - Lines 396-397</h4>
<pre>
<span class="line-number">391</span><span class="context">                i += 1</span>
<span class="line-number">392</span><span class="context">                continue</span>
<span class="line-number">393</span><span class="context"></span>
<span class="line-number">394</span><span class="context">            # Skip preprocessor directives but keep their content</span>
<span class="line-number">395</span><span class="context">            if tokens[i].type == TokenType.PREPROCESSOR:</span>
<span class="line-number">396</span><span class="uncovered">                i = self._skip_preprocessor_directives(tokens, i)</span>
<span class="line-number">397</span><span class="uncovered">                continue</span>
<span class="line-number">398</span><span class="context"></span>
<span class="line-number">399</span><span class="context">            # Skip function definitions (look for parentheses)</span>
<span class="line-number">400</span><span class="context">            if self._looks_like_function(tokens, i):</span>
<span class="line-number">401</span><span class="context">                i = self._skip_function(tokens, i)</span>
<span class="line-number">402</span><span class="context">                continue</span>
</pre>
<h4>Function: _parse_globals_with_tokenizer - Lines 417-426</h4>
<pre>
<span class="line-number">412</span><span class="context">                continue</span>
<span class="line-number">413</span><span class="context"></span>
<span class="line-number">414</span><span class="context">            # Skip if we&#x27;re inside a struct definition (look for opening brace)</span>
<span class="line-number">415</span><span class="context">            if i &gt; 0 and tokens[i - 1].type == TokenType.LBRACE:</span>
<span class="line-number">416</span><span class="context">                # We&#x27;re inside a struct, skip until closing brace</span>
<span class="line-number">417</span><span class="uncovered">                brace_count = 1</span>
<span class="line-number">418</span><span class="uncovered">                j = i</span>
<span class="line-number">419</span><span class="uncovered">                while j &lt; len(tokens) and brace_count &gt; 0:</span>
<span class="line-number">420</span><span class="uncovered">                    if tokens[j].type == TokenType.LBRACE:</span>
<span class="line-number">421</span><span class="uncovered">                        brace_count += 1</span>
<span class="line-number">422</span><span class="uncovered">                    elif tokens[j].type == TokenType.RBRACE:</span>
<span class="line-number">423</span><span class="uncovered">                        brace_count -= 1</span>
<span class="line-number">424</span><span class="uncovered">                    j += 1</span>
<span class="line-number">425</span><span class="uncovered">                i = j</span>
<span class="line-number">426</span><span class="uncovered">                continue</span>
<span class="line-number">427</span><span class="context"></span>
<span class="line-number">428</span><span class="context">            # Skip macros and other preprocessor content</span>
<span class="line-number">429</span><span class="context">            if tokens[i].type == TokenType.DEFINE:</span>
<span class="line-number">430</span><span class="context">                # Skip the entire macro content (multi-line macros are now merged)</span>
<span class="line-number">431</span><span class="context">                i += 1</span>
</pre>
<h4>Function: _parse_globals_with_tokenizer - Lines 431-432</h4>
<pre>
<span class="line-number">426</span><span class="context">                continue</span>
<span class="line-number">427</span><span class="context"></span>
<span class="line-number">428</span><span class="context">            # Skip macros and other preprocessor content</span>
<span class="line-number">429</span><span class="context">            if tokens[i].type == TokenType.DEFINE:</span>
<span class="line-number">430</span><span class="context">                # Skip the entire macro content (multi-line macros are now merged)</span>
<span class="line-number">431</span><span class="uncovered">                i += 1</span>
<span class="line-number">432</span><span class="uncovered">                continue</span>
<span class="line-number">433</span><span class="context"></span>
<span class="line-number">434</span><span class="context">            # Additional check: skip if we&#x27;re inside any brace block (struct, function, etc.)</span>
<span class="line-number">435</span><span class="context">            brace_count = 0</span>
<span class="line-number">436</span><span class="context">            j = i - 1</span>
<span class="line-number">437</span><span class="context">            while j &gt;= 0:</span>
</pre>
<h4>Function: _parse_globals_with_tokenizer - Lines 480-481</h4>
<pre>
<span class="line-number">475</span><span class="context">                                    )</span>
<span class="line-number">476</span><span class="context">                                )</span>
<span class="line-number">477</span><span class="context">                                self.logger.debug(</span>
<span class="line-number">478</span><span class="context">                                    f&quot;Parsed global: {stripped_name} : {stripped_type}&quot;</span>
<span class="line-number">479</span><span class="context">                                )</span>
<span class="line-number">480</span><span class="uncovered">                        except Exception as e:</span>
<span class="line-number">481</span><span class="uncovered">                            self.logger.warning(</span>
<span class="line-number">482</span><span class="context">                                f&quot;Error creating global field {var_name}: {e}&quot;</span>
<span class="line-number">483</span><span class="context">                            )</span>
<span class="line-number">484</span><span class="context">                    i = self._skip_to_semicolon(tokens, i)</span>
<span class="line-number">485</span><span class="context">                else:</span>
<span class="line-number">486</span><span class="context">                    i += 1</span>
</pre>
<h4>Function: _extract_non_primitive_types - Line 609</h4>
<pre>
<span class="line-number">604</span><span class="context">    def _extract_non_primitive_types(</span>
<span class="line-number">605</span><span class="context">        self, type_str: str, available_types: Set[str]</span>
<span class="line-number">606</span><span class="context">    ) -&gt; List[str]:</span>
<span class="line-number">607</span><span class="context">        &quot;&quot;&quot;Extract non-primitive type names from a type string that exist in available_types&quot;&quot;&quot;</span>
<span class="line-number">608</span><span class="context">        # Define primitive types</span>
<span class="line-number">609</span><span class="uncovered">        primitive_types = {</span>
<span class="line-number">610</span><span class="context">            &quot;void&quot;,</span>
<span class="line-number">611</span><span class="context">            &quot;char&quot;,</span>
<span class="line-number">612</span><span class="context">            &quot;short&quot;,</span>
<span class="line-number">613</span><span class="context">            &quot;int&quot;,</span>
<span class="line-number">614</span><span class="context">            &quot;long&quot;,</span>
</pre>
<h4>Function: _extract_non_primitive_types - Line 647</h4>
<pre>
<span class="line-number">642</span><span class="context">            &quot;NULL&quot;,</span>
<span class="line-number">643</span><span class="context">            &quot;nullptr&quot;,</span>
<span class="line-number">644</span><span class="context">        }</span>
<span class="line-number">645</span><span class="context"></span>
<span class="line-number">646</span><span class="context">        # Remove common C keywords and operators</span>
<span class="line-number">647</span><span class="uncovered">        import re</span>
<span class="line-number">648</span><span class="context"></span>
<span class="line-number">649</span><span class="context">        # Split by common delimiters and operators</span>
<span class="line-number">650</span><span class="context">        parts = re.split(r&quot;[\[\]\(\)\{\}\s\*&amp;,;]&quot;, type_str)</span>
<span class="line-number">651</span><span class="context"></span>
<span class="line-number">652</span><span class="context">        # Extract potential type names that exist in available_types</span>
</pre>
<h4>Function: _extract_non_primitive_types - Line 650</h4>
<pre>
<span class="line-number">645</span><span class="context"></span>
<span class="line-number">646</span><span class="context">        # Remove common C keywords and operators</span>
<span class="line-number">647</span><span class="context">        import re</span>
<span class="line-number">648</span><span class="context"></span>
<span class="line-number">649</span><span class="context">        # Split by common delimiters and operators</span>
<span class="line-number">650</span><span class="uncovered">        parts = re.split(r&quot;[\[\]\(\)\{\}\s\*&amp;,;]&quot;, type_str)</span>
<span class="line-number">651</span><span class="context"></span>
<span class="line-number">652</span><span class="context">        # Extract potential type names that exist in available_types</span>
<span class="line-number">653</span><span class="context">        types = []</span>
<span class="line-number">654</span><span class="context">        for part in parts:</span>
<span class="line-number">655</span><span class="context">            part = part.strip()</span>
</pre>
<h4>Function: _extract_non_primitive_types - Lines 653-656</h4>
<pre>
<span class="line-number">648</span><span class="context"></span>
<span class="line-number">649</span><span class="context">        # Split by common delimiters and operators</span>
<span class="line-number">650</span><span class="context">        parts = re.split(r&quot;[\[\]\(\)\{\}\s\*&amp;,;]&quot;, type_str)</span>
<span class="line-number">651</span><span class="context"></span>
<span class="line-number">652</span><span class="context">        # Extract potential type names that exist in available_types</span>
<span class="line-number">653</span><span class="uncovered">        types = []</span>
<span class="line-number">654</span><span class="uncovered">        for part in parts:</span>
<span class="line-number">655</span><span class="uncovered">            part = part.strip()</span>
<span class="line-number">656</span><span class="uncovered">            if part and len(part) &gt; 1 and part not in primitive_types:</span>
<span class="line-number">657</span><span class="context">                # Check if it looks like a type name (starts with letter, contains letters/numbers/underscores)</span>
<span class="line-number">658</span><span class="context">                if re.match(r&quot;^[a-zA-Z_][a-zA-Z0-9_]*$&quot;, part):</span>
<span class="line-number">659</span><span class="context">                    # Only include if it exists in available_types</span>
<span class="line-number">660</span><span class="context">                    if part in available_types:</span>
<span class="line-number">661</span><span class="context">                        types.append(part)</span>
</pre>
<h4>Function: _extract_non_primitive_types - Line 658</h4>
<pre>
<span class="line-number">653</span><span class="context">        types = []</span>
<span class="line-number">654</span><span class="context">        for part in parts:</span>
<span class="line-number">655</span><span class="context">            part = part.strip()</span>
<span class="line-number">656</span><span class="context">            if part and len(part) &gt; 1 and part not in primitive_types:</span>
<span class="line-number">657</span><span class="context">                # Check if it looks like a type name (starts with letter, contains letters/numbers/underscores)</span>
<span class="line-number">658</span><span class="uncovered">                if re.match(r&quot;^[a-zA-Z_][a-zA-Z0-9_]*$&quot;, part):</span>
<span class="line-number">659</span><span class="context">                    # Only include if it exists in available_types</span>
<span class="line-number">660</span><span class="context">                    if part in available_types:</span>
<span class="line-number">661</span><span class="context">                        types.append(part)</span>
<span class="line-number">662</span><span class="context"></span>
<span class="line-number">663</span><span class="context">        return list(set(types))  # Remove duplicates</span>
</pre>
<h4>Function: _extract_non_primitive_types - Lines 660-661</h4>
<pre>
<span class="line-number">655</span><span class="context">            part = part.strip()</span>
<span class="line-number">656</span><span class="context">            if part and len(part) &gt; 1 and part not in primitive_types:</span>
<span class="line-number">657</span><span class="context">                # Check if it looks like a type name (starts with letter, contains letters/numbers/underscores)</span>
<span class="line-number">658</span><span class="context">                if re.match(r&quot;^[a-zA-Z_][a-zA-Z0-9_]*$&quot;, part):</span>
<span class="line-number">659</span><span class="context">                    # Only include if it exists in available_types</span>
<span class="line-number">660</span><span class="uncovered">                    if part in available_types:</span>
<span class="line-number">661</span><span class="uncovered">                        types.append(part)</span>
<span class="line-number">662</span><span class="context"></span>
<span class="line-number">663</span><span class="context">        return list(set(types))  # Remove duplicates</span>
<span class="line-number">664</span><span class="context"></span>
<span class="line-number">665</span><span class="context">    def _find_c_files(self, project_root: Path, recursive_search: bool) -&gt; List[Path]:</span>
<span class="line-number">666</span><span class="context">        &quot;&quot;&quot;Find all C/C++ files in the project&quot;&quot;&quot;</span>
</pre>
<h4>Function: _extract_non_primitive_types - Line 663</h4>
<pre>
<span class="line-number">658</span><span class="context">                if re.match(r&quot;^[a-zA-Z_][a-zA-Z0-9_]*$&quot;, part):</span>
<span class="line-number">659</span><span class="context">                    # Only include if it exists in available_types</span>
<span class="line-number">660</span><span class="context">                    if part in available_types:</span>
<span class="line-number">661</span><span class="context">                        types.append(part)</span>
<span class="line-number">662</span><span class="context"></span>
<span class="line-number">663</span><span class="uncovered">        return list(set(types))  # Remove duplicates</span>
<span class="line-number">664</span><span class="context"></span>
<span class="line-number">665</span><span class="context">    def _find_c_files(self, project_root: Path, recursive_search: bool) -&gt; List[Path]:</span>
<span class="line-number">666</span><span class="context">        &quot;&quot;&quot;Find all C/C++ files in the project&quot;&quot;&quot;</span>
<span class="line-number">667</span><span class="context">        c_extensions = {&quot;.c&quot;, &quot;.h&quot;, &quot;.cpp&quot;, &quot;.cc&quot;, &quot;.cxx&quot;, &quot;.hpp&quot;, &quot;.hxx&quot;}</span>
<span class="line-number">668</span><span class="context">        files = []</span>
</pre>
<h4>Function: _find_c_files - Lines 676-677</h4>
<pre>
<span class="line-number">671</span><span class="context"></span>
<span class="line-number">672</span><span class="context">        if recursive_search:</span>
<span class="line-number">673</span><span class="context">            for ext in c_extensions:</span>
<span class="line-number">674</span><span class="context">                files.extend(project_root.rglob(f&quot;*{ext}&quot;))</span>
<span class="line-number">675</span><span class="context">        else:</span>
<span class="line-number">676</span><span class="uncovered">            for ext in c_extensions:</span>
<span class="line-number">677</span><span class="uncovered">                files.extend(project_root.glob(f&quot;*{ext}&quot;))</span>
<span class="line-number">678</span><span class="context"></span>
<span class="line-number">679</span><span class="context">        # Filter out hidden files and common exclude patterns</span>
<span class="line-number">680</span><span class="context">        filtered_files = []</span>
<span class="line-number">681</span><span class="context">        exclude_patterns = {&quot;.git&quot;, &quot;__pycache__&quot;, &quot;node_modules&quot;, &quot;.vscode&quot;, &quot;.idea&quot;}</span>
<span class="line-number">682</span><span class="context"></span>
</pre>
<h4>Function: _find_c_files - Line 686</h4>
<pre>
<span class="line-number">681</span><span class="context">        exclude_patterns = {&quot;.git&quot;, &quot;__pycache__&quot;, &quot;node_modules&quot;, &quot;.vscode&quot;, &quot;.idea&quot;}</span>
<span class="line-number">682</span><span class="context"></span>
<span class="line-number">683</span><span class="context">        for file_path in files:</span>
<span class="line-number">684</span><span class="context">            # Skip hidden files and directories</span>
<span class="line-number">685</span><span class="context">            if any(part.startswith(&quot;.&quot;) for part in file_path.parts):</span>
<span class="line-number">686</span><span class="uncovered">                continue</span>
<span class="line-number">687</span><span class="context"></span>
<span class="line-number">688</span><span class="context">            # Skip common exclude patterns</span>
<span class="line-number">689</span><span class="context">            if any(pattern in file_path.parts for pattern in exclude_patterns):</span>
<span class="line-number">690</span><span class="context">                continue</span>
<span class="line-number">691</span><span class="context"></span>
</pre>
<h4>Function: _find_c_files - Line 690</h4>
<pre>
<span class="line-number">685</span><span class="context">            if any(part.startswith(&quot;.&quot;) for part in file_path.parts):</span>
<span class="line-number">686</span><span class="context">                continue</span>
<span class="line-number">687</span><span class="context"></span>
<span class="line-number">688</span><span class="context">            # Skip common exclude patterns</span>
<span class="line-number">689</span><span class="context">            if any(pattern in file_path.parts for pattern in exclude_patterns):</span>
<span class="line-number">690</span><span class="uncovered">                continue</span>
<span class="line-number">691</span><span class="context"></span>
<span class="line-number">692</span><span class="context">            filtered_files.append(file_path)</span>
<span class="line-number">693</span><span class="context"></span>
<span class="line-number">694</span><span class="context">        self.logger.debug(&quot;Found %d C/C++ files after filtering&quot;, len(filtered_files))</span>
<span class="line-number">695</span><span class="context">        return sorted(filtered_files)</span>
</pre>
<h4>Function: _find_files_with_include_dependencies - Line 704</h4>
<pre>
<span class="line-number">699</span><span class="context">    ) -&gt; List[Path]:</span>
<span class="line-number">700</span><span class="context">        &quot;&quot;&quot;Find C/C++ files based on configuration and include dependencies&quot;&quot;&quot;</span>
<span class="line-number">701</span><span class="context"></span>
<span class="line-number">702</span><span class="context">        # If no config provided, fall back to old behavior</span>
<span class="line-number">703</span><span class="context">        if config is None:</span>
<span class="line-number">704</span><span class="uncovered">            return self._find_c_files(project_root, recursive_search)</span>
<span class="line-number">705</span><span class="context"></span>
<span class="line-number">706</span><span class="context">        # Get include depth from config</span>
<span class="line-number">707</span><span class="context">        include_depth = getattr(config, &quot;include_depth&quot;, 1)</span>
<span class="line-number">708</span><span class="context">        self.logger.info(&quot;Using include depth: %d&quot;, include_depth)</span>
<span class="line-number">709</span><span class="context"></span>
</pre>
<h4>Function: _find_files_with_include_dependencies - Line 739</h4>
<pre>
<span class="line-number">734</span><span class="context">        )</span>
<span class="line-number">735</span><span class="context">        self.logger.debug(&quot;Initial C files: %s&quot;, [f.name for f in initial_c_files])</span>
<span class="line-number">736</span><span class="context"></span>
<span class="line-number">737</span><span class="context">        # Step 3: If include_depth is 0, return only the initially filtered C files</span>
<span class="line-number">738</span><span class="context">        if include_depth == 0:</span>
<span class="line-number">739</span><span class="uncovered">            return initial_c_files</span>
<span class="line-number">740</span><span class="context"></span>
<span class="line-number">741</span><span class="context">        # Step 4: Process include dependencies for N iterations</span>
<span class="line-number">742</span><span class="context">        files_to_parse = set(initial_c_files)</span>
<span class="line-number">743</span><span class="context"></span>
<span class="line-number">744</span><span class="context">        for iteration in range(include_depth):</span>
</pre>
<h4>Function: _find_files_with_include_dependencies - Line 776</h4>
<pre>
<span class="line-number">771</span><span class="context">                            new_includes.add(included_file)</span>
<span class="line-number">772</span><span class="context">                            self.logger.debug(</span>
<span class="line-number">773</span><span class="context">                                f&quot;Added included file in iteration {iteration + 1}: {relative_included_path}&quot;</span>
<span class="line-number">774</span><span class="context">                            )</span>
<span class="line-number">775</span><span class="context">                        else:</span>
<span class="line-number">776</span><span class="uncovered">                            self.logger.debug(</span>
<span class="line-number">777</span><span class="context">                                f&quot;Excluded included file due to config: {relative_included_path}&quot;</span>
<span class="line-number">778</span><span class="context">                            )</span>
<span class="line-number">779</span><span class="context">                    elif included_file:</span>
<span class="line-number">780</span><span class="context">                        self.logger.debug(</span>
<span class="line-number">781</span><span class="context">                            f&quot;Included file already in list: {included_file.name}&quot;</span>
</pre>
<h4>Function: _find_included_file - Line 848</h4>
<pre>
<span class="line-number">843</span><span class="context">                    if include_name.endswith(ext)</span>
<span class="line-number">844</span><span class="context">                    else f&quot;{include_name}{ext}&quot;</span>
<span class="line-number">845</span><span class="context">                )</span>
<span class="line-number">846</span><span class="context">                # Search recursively in project root</span>
<span class="line-number">847</span><span class="context">                for found_file in project_root.rglob(full_name):</span>
<span class="line-number">848</span><span class="uncovered">                    if found_file.is_file():</span>
<span class="line-number">849</span><span class="context">                        # For backward compatibility with tests, return full path if it&#x27;s a test</span>
<span class="line-number">850</span><span class="context">                        # Otherwise return filename for simplified tracking</span>
<span class="line-number">851</span><span class="context">                        if &quot;tmp&quot; in str(found_file):</span>
<span class="line-number">852</span><span class="context">                            return found_file</span>
<span class="line-number">853</span><span class="context">                        else:</span>
</pre>
<h4>Function: _find_included_file - Lines 851-852</h4>
<pre>
<span class="line-number">846</span><span class="context">                # Search recursively in project root</span>
<span class="line-number">847</span><span class="context">                for found_file in project_root.rglob(full_name):</span>
<span class="line-number">848</span><span class="context">                    if found_file.is_file():</span>
<span class="line-number">849</span><span class="context">                        # For backward compatibility with tests, return full path if it&#x27;s a test</span>
<span class="line-number">850</span><span class="context">                        # Otherwise return filename for simplified tracking</span>
<span class="line-number">851</span><span class="uncovered">                        if &quot;tmp&quot; in str(found_file):</span>
<span class="line-number">852</span><span class="uncovered">                            return found_file</span>
<span class="line-number">853</span><span class="context">                        else:</span>
<span class="line-number">854</span><span class="context">                            return found_file</span>
<span class="line-number">855</span><span class="context"></span>
<span class="line-number">856</span><span class="context">        # If we get here, the file was not found - cache this result</span>
<span class="line-number">857</span><span class="context">        self._failed_includes_cache.add(cache_key)</span>
</pre>
<h4>Function: _find_included_file - Line 854</h4>
<pre>
<span class="line-number">849</span><span class="context">                        # For backward compatibility with tests, return full path if it&#x27;s a test</span>
<span class="line-number">850</span><span class="context">                        # Otherwise return filename for simplified tracking</span>
<span class="line-number">851</span><span class="context">                        if &quot;tmp&quot; in str(found_file):</span>
<span class="line-number">852</span><span class="context">                            return found_file</span>
<span class="line-number">853</span><span class="context">                        else:</span>
<span class="line-number">854</span><span class="uncovered">                            return found_file</span>
<span class="line-number">855</span><span class="context"></span>
<span class="line-number">856</span><span class="context">        # If we get here, the file was not found - cache this result</span>
<span class="line-number">857</span><span class="context">        self._failed_includes_cache.add(cache_key)</span>
<span class="line-number">858</span><span class="context">        self.logger.debug(&quot;Cached failed include search for &#x27;%s&#x27;&quot;, include_name)</span>
<span class="line-number">859</span><span class="context">        return None</span>
</pre>
<h4>Function: _extract_includes_from_file - Lines 872-874</h4>
<pre>
<span class="line-number">867</span><span class="context"></span>
<span class="line-number">868</span><span class="context">            # Tokenize and extract includes</span>
<span class="line-number">869</span><span class="context">            tokens = self.tokenizer.tokenize(content)</span>
<span class="line-number">870</span><span class="context">            return self._parse_includes_with_tokenizer(tokens)</span>
<span class="line-number">871</span><span class="context"></span>
<span class="line-number">872</span><span class="uncovered">        except Exception as e:</span>
<span class="line-number">873</span><span class="uncovered">            self.logger.warning(&quot;Failed to extract includes from %s: %s&quot;, file_path, e)</span>
<span class="line-number">874</span><span class="uncovered">            return []</span>
<span class="line-number">875</span><span class="context"></span>
<span class="line-number">876</span><span class="context">    def _detect_encoding(self, file_path: Path) -&gt; str:</span>
<span class="line-number">877</span><span class="context">        &quot;&quot;&quot;Detect file encoding with platform-aware fallbacks&quot;&quot;&quot;</span>
<span class="line-number">878</span><span class="context">        return detect_file_encoding(file_path)</span>
<span class="line-number">879</span><span class="context"></span>
</pre>
<h4>Function: _find_original_token_pos - Line 896</h4>
<pre>
<span class="line-number">891</span><span class="context">                and token.column == target_token.column</span>
<span class="line-number">892</span><span class="context">                and token.value == target_token.value</span>
<span class="line-number">893</span><span class="context">            ):</span>
<span class="line-number">894</span><span class="context">                return i</span>
<span class="line-number">895</span><span class="context"></span>
<span class="line-number">896</span><span class="uncovered">        return None</span>
<span class="line-number">897</span><span class="context"></span>
<span class="line-number">898</span><span class="context">    def _parse_single_typedef(self, tokens, start_pos):</span>
<span class="line-number">899</span><span class="context">        &quot;&quot;&quot;Parse a single typedef starting at the given position&quot;&quot;&quot;</span>
<span class="line-number">900</span><span class="context">        # Skip &#x27;typedef&#x27; keyword</span>
<span class="line-number">901</span><span class="context">        pos = start_pos + 1</span>
</pre>
<h4>Function: _parse_single_typedef - Line 911</h4>
<pre>
<span class="line-number">906</span><span class="context">            TokenType.COMMENT,</span>
<span class="line-number">907</span><span class="context">        ]:</span>
<span class="line-number">908</span><span class="context">            pos += 1</span>
<span class="line-number">909</span><span class="context"></span>
<span class="line-number">910</span><span class="context">        if pos &gt;= len(tokens):</span>
<span class="line-number">911</span><span class="uncovered">            return None</span>
<span class="line-number">912</span><span class="context"></span>
<span class="line-number">913</span><span class="context">        # Check if it&#x27;s a struct/enum/union typedef (we&#x27;ll handle these separately)</span>
<span class="line-number">914</span><span class="context">        if tokens[pos].type in [TokenType.STRUCT, TokenType.ENUM, TokenType.UNION]:</span>
<span class="line-number">915</span><span class="context">            return self._parse_complex_typedef(tokens, pos)</span>
<span class="line-number">916</span><span class="context"></span>
</pre>
<h4>Function: _parse_single_typedef - Line 925</h4>
<pre>
<span class="line-number">920</span><span class="context">            if tokens[pos].type not in [TokenType.WHITESPACE, TokenType.COMMENT]:</span>
<span class="line-number">921</span><span class="context">                all_tokens.append(tokens[pos])</span>
<span class="line-number">922</span><span class="context">            pos += 1</span>
<span class="line-number">923</span><span class="context"></span>
<span class="line-number">924</span><span class="context">        if len(all_tokens) &lt; 2:</span>
<span class="line-number">925</span><span class="uncovered">            return None</span>
<span class="line-number">926</span><span class="context"></span>
<span class="line-number">927</span><span class="context">        # Function pointer typedef: typedef ret (*name)(params);</span>
<span class="line-number">928</span><span class="context">        for i in range(len(all_tokens) - 3):</span>
<span class="line-number">929</span><span class="context">            if (</span>
<span class="line-number">930</span><span class="context">                all_tokens[i].type</span>
</pre>
<h4>Function: _parse_single_typedef - Lines 959-961</h4>
<pre>
<span class="line-number">954</span><span class="context">            if (</span>
<span class="line-number">955</span><span class="context">                all_tokens[i].type == TokenType.LBRACKET</span>
<span class="line-number">956</span><span class="context">                and i &gt; 0</span>
<span class="line-number">957</span><span class="context">                and all_tokens[i - 1].type == TokenType.IDENTIFIER</span>
<span class="line-number">958</span><span class="context">            ):</span>
<span class="line-number">959</span><span class="uncovered">                typedef_name = all_tokens[i - 1].value</span>
<span class="line-number">960</span><span class="uncovered">                original_type = &quot; &quot;.join(t.value for t in all_tokens)</span>
<span class="line-number">961</span><span class="uncovered">                return (typedef_name, original_type)</span>
<span class="line-number">962</span><span class="context"></span>
<span class="line-number">963</span><span class="context">        # Pointer typedef: typedef type * name;</span>
<span class="line-number">964</span><span class="context">        for i in range(len(all_tokens) - 2):</span>
<span class="line-number">965</span><span class="context">            if (</span>
<span class="line-number">966</span><span class="context">                all_tokens[i].type == TokenType.ASTERISK</span>
</pre>
<h4>Function: _parse_single_typedef - Lines 969-971</h4>
<pre>
<span class="line-number">964</span><span class="context">        for i in range(len(all_tokens) - 2):</span>
<span class="line-number">965</span><span class="context">            if (</span>
<span class="line-number">966</span><span class="context">                all_tokens[i].type == TokenType.ASTERISK</span>
<span class="line-number">967</span><span class="context">                and all_tokens[i + 1].type == TokenType.IDENTIFIER</span>
<span class="line-number">968</span><span class="context">            ):</span>
<span class="line-number">969</span><span class="uncovered">                typedef_name = all_tokens[i + 1].value</span>
<span class="line-number">970</span><span class="uncovered">                original_type = &quot; &quot;.join(t.value for t in all_tokens)</span>
<span class="line-number">971</span><span class="uncovered">                return (typedef_name, original_type)</span>
<span class="line-number">972</span><span class="context"></span>
<span class="line-number">973</span><span class="context">        # Simple typedef: the last token should be the typedef name, everything else is the type</span>
<span class="line-number">974</span><span class="context">        typedef_name = all_tokens[-1].value</span>
<span class="line-number">975</span><span class="context">        type_tokens = all_tokens[:-1]</span>
<span class="line-number">976</span><span class="context">        original_type = &quot; &quot;.join(t.value for t in type_tokens)</span>
</pre>
<h4>Function: _parse_complex_typedef - Line 1007</h4>
<pre>
<span class="line-number">1002</span><span class="context">            elif tokens[pos].type == TokenType.RBRACE:</span>
<span class="line-number">1003</span><span class="context">                brace_count -= 1</span>
<span class="line-number">1004</span><span class="context">            pos += 1</span>
<span class="line-number">1005</span><span class="context"></span>
<span class="line-number">1006</span><span class="context">        if brace_count &gt; 0:</span>
<span class="line-number">1007</span><span class="uncovered">            return None</span>
<span class="line-number">1008</span><span class="context"></span>
<span class="line-number">1009</span><span class="context">        # Find typedef name after closing brace</span>
<span class="line-number">1010</span><span class="context">        while pos &lt; len(tokens) and tokens[pos].type in [</span>
<span class="line-number">1011</span><span class="context">            TokenType.WHITESPACE,</span>
<span class="line-number">1012</span><span class="context">            TokenType.COMMENT,</span>
</pre>
<h4>Function: _extract_tag_name_from_typedef - Line 1036</h4>
<pre>
<span class="line-number">1031</span><span class="context">            TokenType.COMMENT,</span>
<span class="line-number">1032</span><span class="context">        ]:</span>
<span class="line-number">1033</span><span class="context">            pos += 1</span>
<span class="line-number">1034</span><span class="context"></span>
<span class="line-number">1035</span><span class="context">        if pos &gt;= len(tokens):</span>
<span class="line-number">1036</span><span class="uncovered">            return &quot;&quot;</span>
<span class="line-number">1037</span><span class="context"></span>
<span class="line-number">1038</span><span class="context">        # Check if it&#x27;s a struct/enum/union</span>
<span class="line-number">1039</span><span class="context">        if tokens[pos].type not in [TokenType.STRUCT, TokenType.ENUM, TokenType.UNION]:</span>
<span class="line-number">1040</span><span class="context">            return &quot;&quot;</span>
<span class="line-number">1041</span><span class="context"></span>
</pre>
<h4>Function: _extract_tag_name_from_typedef - Line 1040</h4>
<pre>
<span class="line-number">1035</span><span class="context">        if pos &gt;= len(tokens):</span>
<span class="line-number">1036</span><span class="context">            return &quot;&quot;</span>
<span class="line-number">1037</span><span class="context"></span>
<span class="line-number">1038</span><span class="context">        # Check if it&#x27;s a struct/enum/union</span>
<span class="line-number">1039</span><span class="context">        if tokens[pos].type not in [TokenType.STRUCT, TokenType.ENUM, TokenType.UNION]:</span>
<span class="line-number">1040</span><span class="uncovered">            return &quot;&quot;</span>
<span class="line-number">1041</span><span class="context"></span>
<span class="line-number">1042</span><span class="context">        # Skip struct/enum/union keyword</span>
<span class="line-number">1043</span><span class="context">        pos += 1</span>
<span class="line-number">1044</span><span class="context"></span>
<span class="line-number">1045</span><span class="context">        # Skip whitespace and comments</span>
</pre>
<h4>Function: _skip_structure_definition - Line 1120</h4>
<pre>
<span class="line-number">1115</span><span class="context">                    return i + 1 if i &lt; len(tokens) else i</span>
<span class="line-number">1116</span><span class="context">            elif tokens[i].type == TokenType.SEMICOLON and brace_count == 0:</span>
<span class="line-number">1117</span><span class="context">                return i + 1</span>
<span class="line-number">1118</span><span class="context">            i += 1</span>
<span class="line-number">1119</span><span class="context"></span>
<span class="line-number">1120</span><span class="uncovered">        return i</span>
<span class="line-number">1121</span><span class="context"></span>
<span class="line-number">1122</span><span class="context">    def _parse_global_variable(self, tokens, start_pos):</span>
<span class="line-number">1123</span><span class="context">        &quot;&quot;&quot;Parse a global variable declaration starting at start_pos&quot;&quot;&quot;</span>
<span class="line-number">1124</span><span class="context">        # Look for pattern: [static/extern] type name [= value];</span>
<span class="line-number">1125</span><span class="context">        i = start_pos</span>
</pre>
<h4>Function: _parse_global_variable - Line 1182</h4>
<pre>
<span class="line-number">1177</span><span class="context">                                if collected_tokens[k].type == TokenType.IDENTIFIER:</span>
<span class="line-number">1178</span><span class="context">                                    var_name = collected_tokens[k].value</span>
<span class="line-number">1179</span><span class="context">                                    type_tokens = collected_tokens[start_idx:k]</span>
<span class="line-number">1180</span><span class="context">                                    var_type = &quot; &quot;.join(t.value for t in type_tokens)</span>
<span class="line-number">1181</span><span class="context">                                    return (var_name, var_type, None)</span>
<span class="line-number">1182</span><span class="uncovered">                            break</span>
<span class="line-number">1183</span><span class="context">                else:</span>
<span class="line-number">1184</span><span class="context">                    # Regular variable: last token is the name</span>
<span class="line-number">1185</span><span class="context">                    var_name = collected_tokens[-1].value</span>
<span class="line-number">1186</span><span class="context">                    type_tokens = collected_tokens[start_idx:-1]</span>
<span class="line-number">1187</span><span class="context">                    var_type = &quot; &quot;.join(t.value for t in type_tokens)</span>
</pre>
<h4>Function: _skip_preprocessor_directives - Lines 1202-1203</h4>
<pre>
<span class="line-number">1197</span><span class="context">        return i + 1 if i &lt; len(tokens) else i</span>
<span class="line-number">1198</span><span class="context"></span>
<span class="line-number">1199</span><span class="context">    def _skip_preprocessor_directives(self, tokens, start_pos):</span>
<span class="line-number">1200</span><span class="context">        &quot;&quot;&quot;Skip preprocessor directives but keep their content for parsing&quot;&quot;&quot;</span>
<span class="line-number">1201</span><span class="context">        # This method is deprecated - use the PreprocessorManager instead</span>
<span class="line-number">1202</span><span class="uncovered">        i = start_pos</span>
<span class="line-number">1203</span><span class="uncovered">        while i &lt; len(tokens) and tokens[i].type == TokenType.PREPROCESSOR:</span>
<span class="line-number">1204</span><span class="context">            # Skip the preprocessor directive itself</span>
<span class="line-number">1205</span><span class="context">            i += 1</span>
<span class="line-number">1206</span><span class="context">        return i</span>
<span class="line-number">1207</span><span class="context"></span>
<span class="line-number">1208</span><span class="context">    def _parse_function_parameters(self, tokens, start_pos, end_pos, func_name):</span>
</pre>
<h4>Function: _skip_preprocessor_directives - Lines 1205-1206</h4>
<pre>
<span class="line-number">1200</span><span class="context">        &quot;&quot;&quot;Skip preprocessor directives but keep their content for parsing&quot;&quot;&quot;</span>
<span class="line-number">1201</span><span class="context">        # This method is deprecated - use the PreprocessorManager instead</span>
<span class="line-number">1202</span><span class="context">        i = start_pos</span>
<span class="line-number">1203</span><span class="context">        while i &lt; len(tokens) and tokens[i].type == TokenType.PREPROCESSOR:</span>
<span class="line-number">1204</span><span class="context">            # Skip the preprocessor directive itself</span>
<span class="line-number">1205</span><span class="uncovered">            i += 1</span>
<span class="line-number">1206</span><span class="uncovered">        return i</span>
<span class="line-number">1207</span><span class="context"></span>
<span class="line-number">1208</span><span class="context">    def _parse_function_parameters(self, tokens, start_pos, end_pos, func_name):</span>
<span class="line-number">1209</span><span class="context">        &quot;&quot;&quot;Parse function parameters from token range&quot;&quot;&quot;</span>
<span class="line-number">1210</span><span class="context"></span>
<span class="line-number">1211</span><span class="context">        parameters = []</span>
</pre>
<h4>Function: _parse_function_parameters - Line 1224</h4>
<pre>
<span class="line-number">1219</span><span class="context">                # Look for opening parenthesis after function name</span>
<span class="line-number">1220</span><span class="context">                for j in range(i + 1, min(end_pos + 1, len(tokens))):</span>
<span class="line-number">1221</span><span class="context">                    if tokens[j].type == TokenType.LPAREN:</span>
<span class="line-number">1222</span><span class="context">                        paren_start = j</span>
<span class="line-number">1223</span><span class="context">                        break</span>
<span class="line-number">1224</span><span class="uncovered">                    elif tokens[j].type not in [</span>
<span class="line-number">1225</span><span class="context">                        TokenType.WHITESPACE,</span>
<span class="line-number">1226</span><span class="context">                        TokenType.COMMENT,</span>
<span class="line-number">1227</span><span class="context">                    ]:</span>
<span class="line-number">1228</span><span class="context">                        break</span>
<span class="line-number">1229</span><span class="context">                break</span>
</pre>
<h4>Function: _parse_function_parameters - Line 1228</h4>
<pre>
<span class="line-number">1223</span><span class="context">                        break</span>
<span class="line-number">1224</span><span class="context">                    elif tokens[j].type not in [</span>
<span class="line-number">1225</span><span class="context">                        TokenType.WHITESPACE,</span>
<span class="line-number">1226</span><span class="context">                        TokenType.COMMENT,</span>
<span class="line-number">1227</span><span class="context">                    ]:</span>
<span class="line-number">1228</span><span class="uncovered">                        break</span>
<span class="line-number">1229</span><span class="context">                break</span>
<span class="line-number">1230</span><span class="context"></span>
<span class="line-number">1231</span><span class="context">        if paren_start is None:</span>
<span class="line-number">1232</span><span class="context">            return parameters</span>
<span class="line-number">1233</span><span class="context"></span>
</pre>
<h4>Function: _parse_function_parameters - Line 1232</h4>
<pre>
<span class="line-number">1227</span><span class="context">                    ]:</span>
<span class="line-number">1228</span><span class="context">                        break</span>
<span class="line-number">1229</span><span class="context">                break</span>
<span class="line-number">1230</span><span class="context"></span>
<span class="line-number">1231</span><span class="context">        if paren_start is None:</span>
<span class="line-number">1232</span><span class="uncovered">            return parameters</span>
<span class="line-number">1233</span><span class="context"></span>
<span class="line-number">1234</span><span class="context">        # Find matching closing parenthesis</span>
<span class="line-number">1235</span><span class="context">        paren_depth = 1</span>
<span class="line-number">1236</span><span class="context">        for i in range(paren_start + 1, min(end_pos + 1, len(tokens))):</span>
<span class="line-number">1237</span><span class="context">            if tokens[i].type == TokenType.LPAREN:</span>
</pre>
<h4>Function: _parse_function_parameters - Line 1246</h4>
<pre>
<span class="line-number">1241</span><span class="context">                if paren_depth == 0:</span>
<span class="line-number">1242</span><span class="context">                    paren_end = i</span>
<span class="line-number">1243</span><span class="context">                    break</span>
<span class="line-number">1244</span><span class="context"></span>
<span class="line-number">1245</span><span class="context">        if paren_end is None:</span>
<span class="line-number">1246</span><span class="uncovered">            return parameters</span>
<span class="line-number">1247</span><span class="context"></span>
<span class="line-number">1248</span><span class="context">        # Parse parameter tokens between parentheses</span>
<span class="line-number">1249</span><span class="context">        param_tokens = []</span>
<span class="line-number">1250</span><span class="context">        for i in range(paren_start + 1, paren_end):</span>
<span class="line-number">1251</span><span class="context">            if tokens[i].type not in [TokenType.WHITESPACE, TokenType.COMMENT]:</span>
</pre>
<h4>Function: _parse_single_parameter - Line 1285</h4>
<pre>
<span class="line-number">1280</span><span class="context">    def _parse_single_parameter(self, param_tokens):</span>
<span class="line-number">1281</span><span class="context">        &quot;&quot;&quot;Parse a single function parameter from tokens&quot;&quot;&quot;</span>
<span class="line-number">1282</span><span class="context">        from .models import Field</span>
<span class="line-number">1283</span><span class="context"></span>
<span class="line-number">1284</span><span class="context">        if not param_tokens:</span>
<span class="line-number">1285</span><span class="uncovered">            return None</span>
<span class="line-number">1286</span><span class="context"></span>
<span class="line-number">1287</span><span class="context">        # Handle variadic parameters (three consecutive dots)</span>
<span class="line-number">1288</span><span class="context">        if len(param_tokens) == 3 and all(t.value == &quot;.&quot; for t in param_tokens):</span>
<span class="line-number">1289</span><span class="context">            return Field(name=&quot;...&quot;, type=&quot;...&quot;)</span>
<span class="line-number">1290</span><span class="context"></span>
</pre>
<h4>Function: _parse_single_parameter - Line 1293</h4>
<pre>
<span class="line-number">1288</span><span class="context">        if len(param_tokens) == 3 and all(t.value == &quot;.&quot; for t in param_tokens):</span>
<span class="line-number">1289</span><span class="context">            return Field(name=&quot;...&quot;, type=&quot;...&quot;)</span>
<span class="line-number">1290</span><span class="context"></span>
<span class="line-number">1291</span><span class="context">        # Handle variadic parameters (single ... token)</span>
<span class="line-number">1292</span><span class="context">        if len(param_tokens) == 1 and param_tokens[0].value == &quot;...&quot;:</span>
<span class="line-number">1293</span><span class="uncovered">            return Field(name=&quot;...&quot;, type=&quot;...&quot;)</span>
<span class="line-number">1294</span><span class="context"></span>
<span class="line-number">1295</span><span class="context">        # For parameters like &quot;int x&quot; or &quot;const char *name&quot;</span>
<span class="line-number">1296</span><span class="context">        if len(param_tokens) &gt;= 2:</span>
<span class="line-number">1297</span><span class="context">            # Last token is usually the parameter name</span>
<span class="line-number">1298</span><span class="context">            param_name = param_tokens[-1].value</span>
</pre>
<h4>Function: _parse_single_parameter - Lines 1340-1341</h4>
<pre>
<span class="line-number">1335</span><span class="context">                &quot;signed&quot;,</span>
<span class="line-number">1336</span><span class="context">            ]:</span>
<span class="line-number">1337</span><span class="context">                return Field(name=&quot;unnamed&quot;, type=token_value)</span>
<span class="line-number">1338</span><span class="context">            else:</span>
<span class="line-number">1339</span><span class="context">                # If we can&#x27;t determine the type, use &#x27;unknown&#x27; as a fallback</span>
<span class="line-number">1340</span><span class="uncovered">                if token_value and token_value.strip():</span>
<span class="line-number">1341</span><span class="uncovered">                    return Field(name=token_value.strip(), type=&quot;unknown&quot;)</span>
<span class="line-number">1342</span><span class="context">                else:</span>
<span class="line-number">1343</span><span class="context">                    return Field(name=&quot;unnamed&quot;, type=&quot;unknown&quot;)</span>
<span class="line-number">1344</span><span class="context"></span>
<span class="line-number">1345</span><span class="context">        return None</span>
<span class="line-number">1346</span><span class="context"></span>
</pre>
<h4>Function: _parse_single_parameter - Line 1343</h4>
<pre>
<span class="line-number">1338</span><span class="context">            else:</span>
<span class="line-number">1339</span><span class="context">                # If we can&#x27;t determine the type, use &#x27;unknown&#x27; as a fallback</span>
<span class="line-number">1340</span><span class="context">                if token_value and token_value.strip():</span>
<span class="line-number">1341</span><span class="context">                    return Field(name=token_value.strip(), type=&quot;unknown&quot;)</span>
<span class="line-number">1342</span><span class="context">                else:</span>
<span class="line-number">1343</span><span class="uncovered">                    return Field(name=&quot;unnamed&quot;, type=&quot;unknown&quot;)</span>
<span class="line-number">1344</span><span class="context"></span>
<span class="line-number">1345</span><span class="context">        return None</span>
<span class="line-number">1346</span><span class="context"></span>
<span class="line-number">1347</span><span class="context">    def _get_timestamp(self) -&gt; str:</span>
<span class="line-number">1348</span><span class="context">        &quot;&quot;&quot;Get current timestamp string&quot;&quot;&quot;</span>
</pre>
<h4>Function: _parse_single_parameter - Line 1345</h4>
<pre>
<span class="line-number">1340</span><span class="context">                if token_value and token_value.strip():</span>
<span class="line-number">1341</span><span class="context">                    return Field(name=token_value.strip(), type=&quot;unknown&quot;)</span>
<span class="line-number">1342</span><span class="context">                else:</span>
<span class="line-number">1343</span><span class="context">                    return Field(name=&quot;unnamed&quot;, type=&quot;unknown&quot;)</span>
<span class="line-number">1344</span><span class="context"></span>
<span class="line-number">1345</span><span class="uncovered">        return None</span>
<span class="line-number">1346</span><span class="context"></span>
<span class="line-number">1347</span><span class="context">    def _get_timestamp(self) -&gt; str:</span>
<span class="line-number">1348</span><span class="context">        &quot;&quot;&quot;Get current timestamp string&quot;&quot;&quot;</span>
<span class="line-number">1349</span><span class="context">        from datetime import datetime</span>
<span class="line-number">1350</span><span class="context"></span>
</pre>
<h4>Function: _get_timestamp - Line 1349</h4>
<pre>
<span class="line-number">1344</span><span class="context"></span>
<span class="line-number">1345</span><span class="context">        return None</span>
<span class="line-number">1346</span><span class="context"></span>
<span class="line-number">1347</span><span class="context">    def _get_timestamp(self) -&gt; str:</span>
<span class="line-number">1348</span><span class="context">        &quot;&quot;&quot;Get current timestamp string&quot;&quot;&quot;</span>
<span class="line-number">1349</span><span class="uncovered">        from datetime import datetime</span>
<span class="line-number">1350</span><span class="context"></span>
<span class="line-number">1351</span><span class="context">        return datetime.now().isoformat()</span>
<span class="line-number">1352</span><span class="context"></span>
<span class="line-number">1353</span><span class="context">    def get_failed_includes_cache_stats(self) -&gt; dict:</span>
<span class="line-number">1354</span><span class="context">        &quot;&quot;&quot;Get statistics about the failed includes cache&quot;&quot;&quot;</span>
</pre>
<h4>Function: _get_timestamp - Line 1351</h4>
<pre>
<span class="line-number">1346</span><span class="context"></span>
<span class="line-number">1347</span><span class="context">    def _get_timestamp(self) -&gt; str:</span>
<span class="line-number">1348</span><span class="context">        &quot;&quot;&quot;Get current timestamp string&quot;&quot;&quot;</span>
<span class="line-number">1349</span><span class="context">        from datetime import datetime</span>
<span class="line-number">1350</span><span class="context"></span>
<span class="line-number">1351</span><span class="uncovered">        return datetime.now().isoformat()</span>
<span class="line-number">1352</span><span class="context"></span>
<span class="line-number">1353</span><span class="context">    def get_failed_includes_cache_stats(self) -&gt; dict:</span>
<span class="line-number">1354</span><span class="context">        &quot;&quot;&quot;Get statistics about the failed includes cache&quot;&quot;&quot;</span>
<span class="line-number">1355</span><span class="context">        return {</span>
<span class="line-number">1356</span><span class="context">            &quot;cache_size&quot;: len(self._failed_includes_cache),</span>
</pre>
<h4>Function: get_failed_includes_cache_stats - Line 1355</h4>
<pre>
<span class="line-number">1350</span><span class="context"></span>
<span class="line-number">1351</span><span class="context">        return datetime.now().isoformat()</span>
<span class="line-number">1352</span><span class="context"></span>
<span class="line-number">1353</span><span class="context">    def get_failed_includes_cache_stats(self) -&gt; dict:</span>
<span class="line-number">1354</span><span class="context">        &quot;&quot;&quot;Get statistics about the failed includes cache&quot;&quot;&quot;</span>
<span class="line-number">1355</span><span class="uncovered">        return {</span>
<span class="line-number">1356</span><span class="context">            &quot;cache_size&quot;: len(self._failed_includes_cache),</span>
<span class="line-number">1357</span><span class="context">            &quot;cached_includes&quot;: list(self._failed_includes_cache),</span>
<span class="line-number">1358</span><span class="context">        }</span>
<span class="line-number">1359</span><span class="context"></span>
<span class="line-number">1360</span><span class="context"></span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/parser_tokenizer.py - 88.75% coverage (576/649 lines)
</div>
<h4>Function: tokenize - Line 222</h4>
<pre>
<span class="line-number">217</span><span class="context">            if line_num &lt; total_lines:</span>
<span class="line-number">218</span><span class="context">                tokens.append(Token(TokenType.NEWLINE, &quot;\n&quot;, line_num, len(line)))</span>
<span class="line-number">219</span><span class="context">            line_num += 1</span>
<span class="line-number">220</span><span class="context"></span>
<span class="line-number">221</span><span class="context">        if in_multiline_string:</span>
<span class="line-number">222</span><span class="uncovered">            tokens.append(</span>
<span class="line-number">223</span><span class="context">                Token(</span>
<span class="line-number">224</span><span class="context">                    TokenType.STRING,</span>
<span class="line-number">225</span><span class="context">                    multiline_string_value,</span>
<span class="line-number">226</span><span class="context">                    multiline_string_start_line,</span>
<span class="line-number">227</span><span class="context">                    multiline_string_start_col,</span>
</pre>
<h4>Function: tokenize - Line 231</h4>
<pre>
<span class="line-number">226</span><span class="context">                    multiline_string_start_line,</span>
<span class="line-number">227</span><span class="context">                    multiline_string_start_col,</span>
<span class="line-number">228</span><span class="context">                )</span>
<span class="line-number">229</span><span class="context">            )</span>
<span class="line-number">230</span><span class="context">        if in_multiline_comment:</span>
<span class="line-number">231</span><span class="uncovered">            tokens.append(</span>
<span class="line-number">232</span><span class="context">                Token(</span>
<span class="line-number">233</span><span class="context">                    TokenType.COMMENT,</span>
<span class="line-number">234</span><span class="context">                    multiline_comment_value,</span>
<span class="line-number">235</span><span class="context">                    multiline_comment_start_line,</span>
<span class="line-number">236</span><span class="context">                    multiline_comment_start_col,</span>
</pre>
<h4>Function: _tokenize_line - Line 309</h4>
<pre>
<span class="line-number">304</span><span class="context">                or (pos &gt; 1 and line[pos - 2 : pos] == &quot;u8&quot; and line[pos] == &#x27;&quot;&#x27;)</span>
<span class="line-number">305</span><span class="context">            ):</span>
<span class="line-number">306</span><span class="context">                # Handle string literals with possible prefixes</span>
<span class="line-number">307</span><span class="context">                string_start = pos</span>
<span class="line-number">308</span><span class="context">                if line[pos - 2 : pos] == &quot;u8&quot;:</span>
<span class="line-number">309</span><span class="uncovered">                    string_start -= 2</span>
<span class="line-number">310</span><span class="context">                elif line[pos - 1] in [&quot;L&quot;, &quot;u&quot;, &quot;U&quot;, &quot;R&quot;]:</span>
<span class="line-number">311</span><span class="context">                    string_start -= 1</span>
<span class="line-number">312</span><span class="context">                pos += 1  # Skip opening quote</span>
<span class="line-number">313</span><span class="context">                while pos &lt; len(line):</span>
<span class="line-number">314</span><span class="context">                    if line[pos] == &#x27;&quot;&#x27;:</span>
</pre>
<h4>Function: _tokenize_line - Line 311</h4>
<pre>
<span class="line-number">306</span><span class="context">                # Handle string literals with possible prefixes</span>
<span class="line-number">307</span><span class="context">                string_start = pos</span>
<span class="line-number">308</span><span class="context">                if line[pos - 2 : pos] == &quot;u8&quot;:</span>
<span class="line-number">309</span><span class="context">                    string_start -= 2</span>
<span class="line-number">310</span><span class="context">                elif line[pos - 1] in [&quot;L&quot;, &quot;u&quot;, &quot;U&quot;, &quot;R&quot;]:</span>
<span class="line-number">311</span><span class="uncovered">                    string_start -= 1</span>
<span class="line-number">312</span><span class="context">                pos += 1  # Skip opening quote</span>
<span class="line-number">313</span><span class="context">                while pos &lt; len(line):</span>
<span class="line-number">314</span><span class="context">                    if line[pos] == &#x27;&quot;&#x27;:</span>
<span class="line-number">315</span><span class="context">                        # Found closing quote</span>
<span class="line-number">316</span><span class="context">                        string_text = line[string_start : pos + 1]</span>
</pre>
<h4>Function: _merge_multiline_macros - Lines 413-414</h4>
<pre>
<span class="line-number">408</span><span class="context">        while i &lt; len(tokens):</span>
<span class="line-number">409</span><span class="context">            token = tokens[i]</span>
<span class="line-number">410</span><span class="context"></span>
<span class="line-number">411</span><span class="context">            if token.type == TokenType.DEFINE and token.value.rstrip().endswith(&quot;\\&quot;):</span>
<span class="line-number">412</span><span class="context">                # Found a multi-line macro, merge with subsequent lines</span>
<span class="line-number">413</span><span class="uncovered">                macro_content = token.value</span>
<span class="line-number">414</span><span class="uncovered">                current_line = token.line</span>
<span class="line-number">415</span><span class="context"></span>
<span class="line-number">416</span><span class="context">                # Continue merging lines until we find one that doesn&#x27;t end with backslash</span>
<span class="line-number">417</span><span class="context">                while macro_content.rstrip().endswith(&quot;\\&quot;):</span>
<span class="line-number">418</span><span class="context">                    # Remove the backslash and add a newline</span>
<span class="line-number">419</span><span class="context">                    macro_content = macro_content.rstrip()[:-1] + &quot;\n&quot;</span>
</pre>
<h4>Function: _merge_multiline_macros - Line 417</h4>
<pre>
<span class="line-number">412</span><span class="context">                # Found a multi-line macro, merge with subsequent lines</span>
<span class="line-number">413</span><span class="context">                macro_content = token.value</span>
<span class="line-number">414</span><span class="context">                current_line = token.line</span>
<span class="line-number">415</span><span class="context"></span>
<span class="line-number">416</span><span class="context">                # Continue merging lines until we find one that doesn&#x27;t end with backslash</span>
<span class="line-number">417</span><span class="uncovered">                while macro_content.rstrip().endswith(&quot;\\&quot;):</span>
<span class="line-number">418</span><span class="context">                    # Remove the backslash and add a newline</span>
<span class="line-number">419</span><span class="context">                    macro_content = macro_content.rstrip()[:-1] + &quot;\n&quot;</span>
<span class="line-number">420</span><span class="context">                    current_line += 1</span>
<span class="line-number">421</span><span class="context"></span>
<span class="line-number">422</span><span class="context">                    # Find the next line content</span>
</pre>
<h4>Function: _merge_multiline_macros - Lines 419-420</h4>
<pre>
<span class="line-number">414</span><span class="context">                current_line = token.line</span>
<span class="line-number">415</span><span class="context"></span>
<span class="line-number">416</span><span class="context">                # Continue merging lines until we find one that doesn&#x27;t end with backslash</span>
<span class="line-number">417</span><span class="context">                while macro_content.rstrip().endswith(&quot;\\&quot;):</span>
<span class="line-number">418</span><span class="context">                    # Remove the backslash and add a newline</span>
<span class="line-number">419</span><span class="uncovered">                    macro_content = macro_content.rstrip()[:-1] + &quot;\n&quot;</span>
<span class="line-number">420</span><span class="uncovered">                    current_line += 1</span>
<span class="line-number">421</span><span class="context"></span>
<span class="line-number">422</span><span class="context">                    # Find the next line content</span>
<span class="line-number">423</span><span class="context">                    if current_line &lt;= len(lines):</span>
<span class="line-number">424</span><span class="context">                        next_line = lines[current_line - 1]</span>
<span class="line-number">425</span><span class="context">                        macro_content += next_line</span>
</pre>
<h4>Function: _merge_multiline_macros - Lines 423-425</h4>
<pre>
<span class="line-number">418</span><span class="context">                    # Remove the backslash and add a newline</span>
<span class="line-number">419</span><span class="context">                    macro_content = macro_content.rstrip()[:-1] + &quot;\n&quot;</span>
<span class="line-number">420</span><span class="context">                    current_line += 1</span>
<span class="line-number">421</span><span class="context"></span>
<span class="line-number">422</span><span class="context">                    # Find the next line content</span>
<span class="line-number">423</span><span class="uncovered">                    if current_line &lt;= len(lines):</span>
<span class="line-number">424</span><span class="uncovered">                        next_line = lines[current_line - 1]</span>
<span class="line-number">425</span><span class="uncovered">                        macro_content += next_line</span>
<span class="line-number">426</span><span class="context">                    else:</span>
<span class="line-number">427</span><span class="context">                        break</span>
<span class="line-number">428</span><span class="context"></span>
<span class="line-number">429</span><span class="context">                # Create a new token with the merged content</span>
<span class="line-number">430</span><span class="context">                merged_tokens.append(</span>
</pre>
<h4>Function: _merge_multiline_macros - Line 427</h4>
<pre>
<span class="line-number">422</span><span class="context">                    # Find the next line content</span>
<span class="line-number">423</span><span class="context">                    if current_line &lt;= len(lines):</span>
<span class="line-number">424</span><span class="context">                        next_line = lines[current_line - 1]</span>
<span class="line-number">425</span><span class="context">                        macro_content += next_line</span>
<span class="line-number">426</span><span class="context">                    else:</span>
<span class="line-number">427</span><span class="uncovered">                        break</span>
<span class="line-number">428</span><span class="context"></span>
<span class="line-number">429</span><span class="context">                # Create a new token with the merged content</span>
<span class="line-number">430</span><span class="context">                merged_tokens.append(</span>
<span class="line-number">431</span><span class="context">                    Token(TokenType.DEFINE, macro_content, token.line, token.column)</span>
<span class="line-number">432</span><span class="context">                )</span>
</pre>
<h4>Function: _merge_multiline_macros - Line 430</h4>
<pre>
<span class="line-number">425</span><span class="context">                        macro_content += next_line</span>
<span class="line-number">426</span><span class="context">                    else:</span>
<span class="line-number">427</span><span class="context">                        break</span>
<span class="line-number">428</span><span class="context"></span>
<span class="line-number">429</span><span class="context">                # Create a new token with the merged content</span>
<span class="line-number">430</span><span class="uncovered">                merged_tokens.append(</span>
<span class="line-number">431</span><span class="context">                    Token(TokenType.DEFINE, macro_content, token.line, token.column)</span>
<span class="line-number">432</span><span class="context">                )</span>
<span class="line-number">433</span><span class="context">            else:</span>
<span class="line-number">434</span><span class="context">                merged_tokens.append(token)</span>
<span class="line-number">435</span><span class="context"></span>
</pre>
<h4>Function: _peek_token - Lines 532-533</h4>
<pre>
<span class="line-number">527</span><span class="context">        &quot;&quot;&quot;Check if current token is of specified type&quot;&quot;&quot;</span>
<span class="line-number">528</span><span class="context">        return self.pos &lt; len(self.tokens) and self.tokens[self.pos].type == token_type</span>
<span class="line-number">529</span><span class="context"></span>
<span class="line-number">530</span><span class="context">    def _peek_token(self, offset: int = 1) -&gt; Optional[Token]:</span>
<span class="line-number">531</span><span class="context">        &quot;&quot;&quot;Peek at token at current position + offset&quot;&quot;&quot;</span>
<span class="line-number">532</span><span class="uncovered">        peek_pos = self.pos + offset</span>
<span class="line-number">533</span><span class="uncovered">        return self.tokens[peek_pos] if peek_pos &lt; len(self.tokens) else None</span>
<span class="line-number">534</span><span class="context"></span>
<span class="line-number">535</span><span class="context">    def _advance(self) -&gt; Optional[Token]:</span>
<span class="line-number">536</span><span class="context">        &quot;&quot;&quot;Advance to next token and return current&quot;&quot;&quot;</span>
<span class="line-number">537</span><span class="context">        if self.pos &lt; len(self.tokens):</span>
<span class="line-number">538</span><span class="context">            token = self.tokens[self.pos]</span>
</pre>
<h4>Function: _advance - Line 541</h4>
<pre>
<span class="line-number">536</span><span class="context">        &quot;&quot;&quot;Advance to next token and return current&quot;&quot;&quot;</span>
<span class="line-number">537</span><span class="context">        if self.pos &lt; len(self.tokens):</span>
<span class="line-number">538</span><span class="context">            token = self.tokens[self.pos]</span>
<span class="line-number">539</span><span class="context">            self.pos += 1</span>
<span class="line-number">540</span><span class="context">            return token</span>
<span class="line-number">541</span><span class="uncovered">        return None</span>
<span class="line-number">542</span><span class="context"></span>
<span class="line-number">543</span><span class="context">    def _find_matching_brace(self, start_pos: int) -&gt; Optional[int]:</span>
<span class="line-number">544</span><span class="context">        &quot;&quot;&quot;Find matching closing brace starting from open brace position&quot;&quot;&quot;</span>
<span class="line-number">545</span><span class="context">        if (</span>
<span class="line-number">546</span><span class="context">            start_pos &gt;= len(self.tokens)</span>
</pre>
<h4>Function: _find_matching_brace - Line 549</h4>
<pre>
<span class="line-number">544</span><span class="context">        &quot;&quot;&quot;Find matching closing brace starting from open brace position&quot;&quot;&quot;</span>
<span class="line-number">545</span><span class="context">        if (</span>
<span class="line-number">546</span><span class="context">            start_pos &gt;= len(self.tokens)</span>
<span class="line-number">547</span><span class="context">            or self.tokens[start_pos].type != TokenType.LBRACE</span>
<span class="line-number">548</span><span class="context">        ):</span>
<span class="line-number">549</span><span class="uncovered">            return None</span>
<span class="line-number">550</span><span class="context"></span>
<span class="line-number">551</span><span class="context">        depth = 1</span>
<span class="line-number">552</span><span class="context">        pos = start_pos + 1</span>
<span class="line-number">553</span><span class="context"></span>
<span class="line-number">554</span><span class="context">        while pos &lt; len(self.tokens) and depth &gt; 0:</span>
</pre>
<h4>Function: _parse_struct - Line 569</h4>
<pre>
<span class="line-number">564</span><span class="context">        &quot;&quot;&quot;Parse struct definition starting at current position&quot;&quot;&quot;</span>
<span class="line-number">565</span><span class="context">        start_pos = self.pos</span>
<span class="line-number">566</span><span class="context"></span>
<span class="line-number">567</span><span class="context">        # Consume &#x27;struct&#x27; keyword</span>
<span class="line-number">568</span><span class="context">        if not self._current_token_is(TokenType.STRUCT):</span>
<span class="line-number">569</span><span class="uncovered">            return None</span>
<span class="line-number">570</span><span class="context">        self._advance()</span>
<span class="line-number">571</span><span class="context"></span>
<span class="line-number">572</span><span class="context">        # Skip whitespace</span>
<span class="line-number">573</span><span class="context">        while self.pos &lt; len(self.tokens) and self._current_token_is(</span>
<span class="line-number">574</span><span class="context">            TokenType.WHITESPACE</span>
</pre>
<h4>Function: _parse_struct - Line 597</h4>
<pre>
<span class="line-number">592</span><span class="context">        # Find matching closing brace</span>
<span class="line-number">593</span><span class="context">        brace_pos = self.pos</span>
<span class="line-number">594</span><span class="context">        end_brace_pos = self._find_matching_brace(brace_pos)</span>
<span class="line-number">595</span><span class="context"></span>
<span class="line-number">596</span><span class="context">        if end_brace_pos is None:</span>
<span class="line-number">597</span><span class="uncovered">            return None</span>
<span class="line-number">598</span><span class="context"></span>
<span class="line-number">599</span><span class="context">        # Look for struct name after closing brace</span>
<span class="line-number">600</span><span class="context">        name_pos = end_brace_pos + 1</span>
<span class="line-number">601</span><span class="context">        struct_name = struct_tag  # Default to tag name</span>
<span class="line-number">602</span><span class="context"></span>
</pre>
<h4>Function: _parse_typedef_struct - Line 654</h4>
<pre>
<span class="line-number">649</span><span class="context">        &quot;&quot;&quot;Parse typedef struct definition&quot;&quot;&quot;</span>
<span class="line-number">650</span><span class="context">        start_pos = self.pos</span>
<span class="line-number">651</span><span class="context"></span>
<span class="line-number">652</span><span class="context">        # Consume &#x27;typedef&#x27;</span>
<span class="line-number">653</span><span class="context">        if not self._current_token_is(TokenType.TYPEDEF):</span>
<span class="line-number">654</span><span class="uncovered">            return None</span>
<span class="line-number">655</span><span class="context">        self._advance()</span>
<span class="line-number">656</span><span class="context"></span>
<span class="line-number">657</span><span class="context">        # Look for &#x27;struct&#x27;</span>
<span class="line-number">658</span><span class="context">        if not self._current_token_is(TokenType.STRUCT):</span>
<span class="line-number">659</span><span class="context">            # Not a typedef struct, reset position</span>
</pre>
<h4>Function: _parse_typedef_struct - Line 670</h4>
<pre>
<span class="line-number">665</span><span class="context"></span>
<span class="line-number">666</span><span class="context">        # Skip whitespace</span>
<span class="line-number">667</span><span class="context">        while self.pos &lt; len(self.tokens) and self._current_token_is(</span>
<span class="line-number">668</span><span class="context">            TokenType.WHITESPACE</span>
<span class="line-number">669</span><span class="context">        ):</span>
<span class="line-number">670</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">671</span><span class="context"></span>
<span class="line-number">672</span><span class="context">        # Get struct tag name (optional)</span>
<span class="line-number">673</span><span class="context">        struct_tag = &quot;&quot;</span>
<span class="line-number">674</span><span class="context">        if self._current_token_is(TokenType.IDENTIFIER):</span>
<span class="line-number">675</span><span class="context">            struct_tag = self._advance().value</span>
</pre>
<h4>Function: _parse_typedef_struct - Line 681</h4>
<pre>
<span class="line-number">676</span><span class="context"></span>
<span class="line-number">677</span><span class="context">        # Skip whitespace</span>
<span class="line-number">678</span><span class="context">        while self.pos &lt; len(self.tokens) and self._current_token_is(</span>
<span class="line-number">679</span><span class="context">            TokenType.WHITESPACE</span>
<span class="line-number">680</span><span class="context">        ):</span>
<span class="line-number">681</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">682</span><span class="context"></span>
<span class="line-number">683</span><span class="context">        # Check if this is a forward declaration (no braces)</span>
<span class="line-number">684</span><span class="context">        if not self._current_token_is(TokenType.LBRACE):</span>
<span class="line-number">685</span><span class="context">            # This is a forward declaration like &quot;typedef struct Node* NodePtr;&quot;</span>
<span class="line-number">686</span><span class="context">            # Not a struct definition, so skip it</span>
</pre>
<h4>Function: _parse_typedef_struct - Lines 693-694</h4>
<pre>
<span class="line-number">688</span><span class="context">            return None</span>
<span class="line-number">689</span><span class="context"></span>
<span class="line-number">690</span><span class="context">        # Find matching closing brace</span>
<span class="line-number">691</span><span class="context">        end_brace_pos = self._find_matching_brace(self.pos)</span>
<span class="line-number">692</span><span class="context">        if end_brace_pos is None:</span>
<span class="line-number">693</span><span class="uncovered">            self.pos = start_pos + 1</span>
<span class="line-number">694</span><span class="uncovered">            return None</span>
<span class="line-number">695</span><span class="context"></span>
<span class="line-number">696</span><span class="context">        # Look for typedef name after closing brace</span>
<span class="line-number">697</span><span class="context">        typedef_name = &quot;&quot;</span>
<span class="line-number">698</span><span class="context">        name_pos = end_brace_pos + 1</span>
<span class="line-number">699</span><span class="context">        while name_pos &lt; len(self.tokens):</span>
</pre>
<h4>Function: _parse_typedef_struct - Lines 703-705</h4>
<pre>
<span class="line-number">698</span><span class="context">        name_pos = end_brace_pos + 1</span>
<span class="line-number">699</span><span class="context">        while name_pos &lt; len(self.tokens):</span>
<span class="line-number">700</span><span class="context">            if self.tokens[name_pos].type == TokenType.IDENTIFIER:</span>
<span class="line-number">701</span><span class="context">                typedef_name = self.tokens[name_pos].value</span>
<span class="line-number">702</span><span class="context">                break</span>
<span class="line-number">703</span><span class="uncovered">            elif self.tokens[name_pos].type == TokenType.SEMICOLON:</span>
<span class="line-number">704</span><span class="uncovered">                break</span>
<span class="line-number">705</span><span class="uncovered">            name_pos += 1</span>
<span class="line-number">706</span><span class="context"></span>
<span class="line-number">707</span><span class="context">        # Find semicolon</span>
<span class="line-number">708</span><span class="context">        while (</span>
<span class="line-number">709</span><span class="context">            name_pos &lt; len(self.tokens)</span>
<span class="line-number">710</span><span class="context">            and not self.tokens[name_pos].type == TokenType.SEMICOLON</span>
</pre>
<h4>Function: _parse_enum - Line 723</h4>
<pre>
<span class="line-number">718</span><span class="context">        &quot;&quot;&quot;Parse enum definition starting at current position&quot;&quot;&quot;</span>
<span class="line-number">719</span><span class="context">        start_pos = self.pos</span>
<span class="line-number">720</span><span class="context"></span>
<span class="line-number">721</span><span class="context">        # Consume &#x27;enum&#x27; keyword</span>
<span class="line-number">722</span><span class="context">        if not self._current_token_is(TokenType.ENUM):</span>
<span class="line-number">723</span><span class="uncovered">            return None</span>
<span class="line-number">724</span><span class="context">        self._advance()</span>
<span class="line-number">725</span><span class="context"></span>
<span class="line-number">726</span><span class="context">        # Skip whitespace</span>
<span class="line-number">727</span><span class="context">        while self.pos &lt; len(self.tokens) and self._current_token_is(</span>
<span class="line-number">728</span><span class="context">            TokenType.WHITESPACE</span>
</pre>
<h4>Function: _parse_enum - Line 751</h4>
<pre>
<span class="line-number">746</span><span class="context">        # Find matching closing brace</span>
<span class="line-number">747</span><span class="context">        brace_pos = self.pos</span>
<span class="line-number">748</span><span class="context">        end_brace_pos = self._find_matching_brace(brace_pos)</span>
<span class="line-number">749</span><span class="context"></span>
<span class="line-number">750</span><span class="context">        if end_brace_pos is None:</span>
<span class="line-number">751</span><span class="uncovered">            return None</span>
<span class="line-number">752</span><span class="context"></span>
<span class="line-number">753</span><span class="context">        # Look for enum name after closing brace</span>
<span class="line-number">754</span><span class="context">        name_pos = end_brace_pos + 1</span>
<span class="line-number">755</span><span class="context">        enum_name = enum_tag  # Default to tag name</span>
<span class="line-number">756</span><span class="context"></span>
</pre>
<h4>Function: _parse_enum - Line 779</h4>
<pre>
<span class="line-number">774</span><span class="context">            while name_pos &lt; len(self.tokens):</span>
<span class="line-number">775</span><span class="context">                if self.tokens[name_pos].type == TokenType.IDENTIFIER:</span>
<span class="line-number">776</span><span class="context">                    enum_name = self.tokens[name_pos].value</span>
<span class="line-number">777</span><span class="context">                    break</span>
<span class="line-number">778</span><span class="context">                elif self.tokens[name_pos].type == TokenType.SEMICOLON:</span>
<span class="line-number">779</span><span class="uncovered">                    break</span>
<span class="line-number">780</span><span class="context">                name_pos += 1</span>
<span class="line-number">781</span><span class="context">        elif not enum_tag:</span>
<span class="line-number">782</span><span class="context">            # Anonymous enum - check if there&#x27;s a variable name after the brace</span>
<span class="line-number">783</span><span class="context">            while name_pos &lt; len(self.tokens):</span>
<span class="line-number">784</span><span class="context">                if self.tokens[name_pos].type == TokenType.IDENTIFIER:</span>
</pre>
<h4>Function: _parse_enum - Lines 788-790</h4>
<pre>
<span class="line-number">783</span><span class="context">            while name_pos &lt; len(self.tokens):</span>
<span class="line-number">784</span><span class="context">                if self.tokens[name_pos].type == TokenType.IDENTIFIER:</span>
<span class="line-number">785</span><span class="context">                    # This is a variable name, not an enum name</span>
<span class="line-number">786</span><span class="context">                    enum_name = &quot;&quot;</span>
<span class="line-number">787</span><span class="context">                    break</span>
<span class="line-number">788</span><span class="uncovered">                elif self.tokens[name_pos].type == TokenType.SEMICOLON:</span>
<span class="line-number">789</span><span class="uncovered">                    break</span>
<span class="line-number">790</span><span class="uncovered">                name_pos += 1</span>
<span class="line-number">791</span><span class="context"></span>
<span class="line-number">792</span><span class="context">        # Find semicolon</span>
<span class="line-number">793</span><span class="context">        self.pos = end_brace_pos + 1</span>
<span class="line-number">794</span><span class="context">        while self.pos &lt; len(self.tokens) and not self._current_token_is(</span>
<span class="line-number">795</span><span class="context">            TokenType.SEMICOLON</span>
</pre>
<h4>Function: _parse_typedef_enum - Line 808</h4>
<pre>
<span class="line-number">803</span><span class="context">        &quot;&quot;&quot;Parse typedef enum definition&quot;&quot;&quot;</span>
<span class="line-number">804</span><span class="context">        start_pos = self.pos</span>
<span class="line-number">805</span><span class="context"></span>
<span class="line-number">806</span><span class="context">        # Consume &#x27;typedef&#x27;</span>
<span class="line-number">807</span><span class="context">        if not self._current_token_is(TokenType.TYPEDEF):</span>
<span class="line-number">808</span><span class="uncovered">            return None</span>
<span class="line-number">809</span><span class="context">        self._advance()</span>
<span class="line-number">810</span><span class="context"></span>
<span class="line-number">811</span><span class="context">        # Look for &#x27;enum&#x27;</span>
<span class="line-number">812</span><span class="context">        if not self._current_token_is(TokenType.ENUM):</span>
<span class="line-number">813</span><span class="context">            # Not a typedef enum, reset position</span>
</pre>
<h4>Function: _parse_typedef_enum - Lines 820-821</h4>
<pre>
<span class="line-number">815</span><span class="context">            return None</span>
<span class="line-number">816</span><span class="context"></span>
<span class="line-number">817</span><span class="context">        # Parse the enum part - this will return the tag name (e.g., StatusEnum_tag)</span>
<span class="line-number">818</span><span class="context">        enum_info = self._parse_enum()</span>
<span class="line-number">819</span><span class="context">        if not enum_info:</span>
<span class="line-number">820</span><span class="uncovered">            self.pos = start_pos + 1</span>
<span class="line-number">821</span><span class="uncovered">            return None</span>
<span class="line-number">822</span><span class="context"></span>
<span class="line-number">823</span><span class="context">        # For typedef enums, we want to return the tag name, not the typedef name</span>
<span class="line-number">824</span><span class="context">        # The typedef name will be handled separately in the parser</span>
<span class="line-number">825</span><span class="context">        return enum_info</span>
<span class="line-number">826</span><span class="context"></span>
</pre>
<h4>Function: _is_function_declaration - Line 946</h4>
<pre>
<span class="line-number">941</span><span class="context">        return None</span>
<span class="line-number">942</span><span class="context"></span>
<span class="line-number">943</span><span class="context">    def _is_function_declaration(self, end_pos: int) -&gt; bool:</span>
<span class="line-number">944</span><span class="context">        &quot;&quot;&quot;Check if the function at end_pos is a declaration (ends with ;) or definition (ends with })&quot;&quot;&quot;</span>
<span class="line-number">945</span><span class="context">        if end_pos &gt;= len(self.tokens):</span>
<span class="line-number">946</span><span class="uncovered">            return False</span>
<span class="line-number">947</span><span class="context"></span>
<span class="line-number">948</span><span class="context">        # Look backwards from end_pos to find the last significant token</span>
<span class="line-number">949</span><span class="context">        pos = end_pos</span>
<span class="line-number">950</span><span class="context">        while pos &gt;= 0:</span>
<span class="line-number">951</span><span class="context">            token_type = self.tokens[pos].type</span>
</pre>
<h4>Function: _is_function_declaration - Line 958</h4>
<pre>
<span class="line-number">953</span><span class="context">                TokenType.WHITESPACE,</span>
<span class="line-number">954</span><span class="context">                TokenType.COMMENT,</span>
<span class="line-number">955</span><span class="context">                TokenType.NEWLINE,</span>
<span class="line-number">956</span><span class="context">            ]:</span>
<span class="line-number">957</span><span class="context">                return token_type == TokenType.SEMICOLON</span>
<span class="line-number">958</span><span class="uncovered">            pos -= 1</span>
<span class="line-number">959</span><span class="context"></span>
<span class="line-number">960</span><span class="context">        return False</span>
<span class="line-number">961</span><span class="context"></span>
<span class="line-number">962</span><span class="context">    def _find_function_end(self, start_pos: int) -&gt; Optional[int]:</span>
<span class="line-number">963</span><span class="context">        &quot;&quot;&quot;Find end of function declaration or definition&quot;&quot;&quot;</span>
</pre>
<h4>Function: _is_function_declaration - Line 960</h4>
<pre>
<span class="line-number">955</span><span class="context">                TokenType.NEWLINE,</span>
<span class="line-number">956</span><span class="context">            ]:</span>
<span class="line-number">957</span><span class="context">                return token_type == TokenType.SEMICOLON</span>
<span class="line-number">958</span><span class="context">            pos -= 1</span>
<span class="line-number">959</span><span class="context"></span>
<span class="line-number">960</span><span class="uncovered">        return False</span>
<span class="line-number">961</span><span class="context"></span>
<span class="line-number">962</span><span class="context">    def _find_function_end(self, start_pos: int) -&gt; Optional[int]:</span>
<span class="line-number">963</span><span class="context">        &quot;&quot;&quot;Find end of function declaration or definition&quot;&quot;&quot;</span>
<span class="line-number">964</span><span class="context">        pos = start_pos</span>
<span class="line-number">965</span><span class="context"></span>
</pre>
<h4>Function: _find_function_end - Line 968</h4>
<pre>
<span class="line-number">963</span><span class="context">        &quot;&quot;&quot;Find end of function declaration or definition&quot;&quot;&quot;</span>
<span class="line-number">964</span><span class="context">        pos = start_pos</span>
<span class="line-number">965</span><span class="context"></span>
<span class="line-number">966</span><span class="context">        # Find matching closing parenthesis</span>
<span class="line-number">967</span><span class="context">        if pos &gt;= len(self.tokens) or self.tokens[pos].type != TokenType.LPAREN:</span>
<span class="line-number">968</span><span class="uncovered">            return None</span>
<span class="line-number">969</span><span class="context"></span>
<span class="line-number">970</span><span class="context">        depth = 1</span>
<span class="line-number">971</span><span class="context">        pos += 1</span>
<span class="line-number">972</span><span class="context"></span>
<span class="line-number">973</span><span class="context">        while pos &lt; len(self.tokens) and depth &gt; 0:</span>
</pre>
<h4>Function: _find_function_end - Line 993</h4>
<pre>
<span class="line-number">988</span><span class="context">                # Function definition - find matching brace</span>
<span class="line-number">989</span><span class="context">                end_brace = self._find_matching_brace(pos)</span>
<span class="line-number">990</span><span class="context">                return end_brace if end_brace else pos</span>
<span class="line-number">991</span><span class="context">            pos += 1</span>
<span class="line-number">992</span><span class="context"></span>
<span class="line-number">993</span><span class="uncovered">        return None</span>
<span class="line-number">994</span><span class="context"></span>
<span class="line-number">995</span><span class="context">    def _parse_union(self) -&gt; Optional[Tuple[int, int, str]]:</span>
<span class="line-number">996</span><span class="context">        &quot;&quot;&quot;Parse union definition&quot;&quot;&quot;</span>
<span class="line-number">997</span><span class="context">        if not self._current_token_is(TokenType.UNION):</span>
<span class="line-number">998</span><span class="context">            return None</span>
</pre>
<h4>Function: _parse_union - Line 998</h4>
<pre>
<span class="line-number">993</span><span class="context">        return None</span>
<span class="line-number">994</span><span class="context"></span>
<span class="line-number">995</span><span class="context">    def _parse_union(self) -&gt; Optional[Tuple[int, int, str]]:</span>
<span class="line-number">996</span><span class="context">        &quot;&quot;&quot;Parse union definition&quot;&quot;&quot;</span>
<span class="line-number">997</span><span class="context">        if not self._current_token_is(TokenType.UNION):</span>
<span class="line-number">998</span><span class="uncovered">            return None</span>
<span class="line-number">999</span><span class="context"></span>
<span class="line-number">1000</span><span class="context">        start_pos = self.pos</span>
<span class="line-number">1001</span><span class="context">        self._advance()  # Consumes &#x27;union&#x27;</span>
<span class="line-number">1002</span><span class="context"></span>
<span class="line-number">1003</span><span class="context">        # Skip whitespace</span>
</pre>
<h4>Function: _parse_union - Line 1007</h4>
<pre>
<span class="line-number">1002</span><span class="context"></span>
<span class="line-number">1003</span><span class="context">        # Skip whitespace</span>
<span class="line-number">1004</span><span class="context">        while self.pos &lt; len(self.tokens) and self._current_token_is(</span>
<span class="line-number">1005</span><span class="context">            TokenType.WHITESPACE</span>
<span class="line-number">1006</span><span class="context">        ):</span>
<span class="line-number">1007</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">1008</span><span class="context"></span>
<span class="line-number">1009</span><span class="context">        # Get union tag name (optional for anonymous unions)</span>
<span class="line-number">1010</span><span class="context">        union_tag = &quot;&quot;</span>
<span class="line-number">1011</span><span class="context">        if self._current_token_is(TokenType.IDENTIFIER):</span>
<span class="line-number">1012</span><span class="context">            union_tag = self._advance().value</span>
</pre>
<h4>Function: _parse_union - Line 1026</h4>
<pre>
<span class="line-number">1021</span><span class="context">            return None</span>
<span class="line-number">1022</span><span class="context"></span>
<span class="line-number">1023</span><span class="context">        # Find matching closing brace</span>
<span class="line-number">1024</span><span class="context">        end_pos = self._find_matching_brace(self.pos)</span>
<span class="line-number">1025</span><span class="context">        if end_pos is None:</span>
<span class="line-number">1026</span><span class="uncovered">            return None</span>
<span class="line-number">1027</span><span class="context"></span>
<span class="line-number">1028</span><span class="context">        # Look for union name after closing brace (for typedefs or named unions)</span>
<span class="line-number">1029</span><span class="context">        union_name = union_tag  # Default to tag name</span>
<span class="line-number">1030</span><span class="context"></span>
<span class="line-number">1031</span><span class="context">        # Skip to semicolon</span>
</pre>
<h4>Function: _parse_union - Lines 1036-1039</h4>
<pre>
<span class="line-number">1031</span><span class="context">        # Skip to semicolon</span>
<span class="line-number">1032</span><span class="context">        self.pos = end_pos + 1</span>
<span class="line-number">1033</span><span class="context">        while self.pos &lt; len(self.tokens) and not self._current_token_is(</span>
<span class="line-number">1034</span><span class="context">            TokenType.SEMICOLON</span>
<span class="line-number">1035</span><span class="context">        ):</span>
<span class="line-number">1036</span><span class="uncovered">            if self._current_token_is(TokenType.IDENTIFIER):</span>
<span class="line-number">1037</span><span class="uncovered">                union_name = self._advance().value</span>
<span class="line-number">1038</span><span class="uncovered">                break</span>
<span class="line-number">1039</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">1040</span><span class="context"></span>
<span class="line-number">1041</span><span class="context">        return (start_pos, end_pos, union_name)</span>
<span class="line-number">1042</span><span class="context"></span>
<span class="line-number">1043</span><span class="context">    def _parse_typedef_union(self) -&gt; Optional[Tuple[int, int, str]]:</span>
<span class="line-number">1044</span><span class="context">        &quot;&quot;&quot;Parse typedef union definition&quot;&quot;&quot;</span>
</pre>
<h4>Function: _parse_typedef_union - Line 1046</h4>
<pre>
<span class="line-number">1041</span><span class="context">        return (start_pos, end_pos, union_name)</span>
<span class="line-number">1042</span><span class="context"></span>
<span class="line-number">1043</span><span class="context">    def _parse_typedef_union(self) -&gt; Optional[Tuple[int, int, str]]:</span>
<span class="line-number">1044</span><span class="context">        &quot;&quot;&quot;Parse typedef union definition&quot;&quot;&quot;</span>
<span class="line-number">1045</span><span class="context">        if not self._current_token_is(TokenType.TYPEDEF):</span>
<span class="line-number">1046</span><span class="uncovered">            return None</span>
<span class="line-number">1047</span><span class="context"></span>
<span class="line-number">1048</span><span class="context">        start_pos = self.pos</span>
<span class="line-number">1049</span><span class="context">        self._advance()  # Consumes &#x27;typedef&#x27;</span>
<span class="line-number">1050</span><span class="context"></span>
<span class="line-number">1051</span><span class="context">        # Skip whitespace</span>
</pre>
<h4>Function: _parse_typedef_union - Line 1055</h4>
<pre>
<span class="line-number">1050</span><span class="context"></span>
<span class="line-number">1051</span><span class="context">        # Skip whitespace</span>
<span class="line-number">1052</span><span class="context">        while self.pos &lt; len(self.tokens) and self._current_token_is(</span>
<span class="line-number">1053</span><span class="context">            TokenType.WHITESPACE</span>
<span class="line-number">1054</span><span class="context">        ):</span>
<span class="line-number">1055</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">1056</span><span class="context"></span>
<span class="line-number">1057</span><span class="context">        # Check if next token is &#x27;union&#x27;</span>
<span class="line-number">1058</span><span class="context">        if not self._current_token_is(TokenType.UNION):</span>
<span class="line-number">1059</span><span class="context">            return None</span>
<span class="line-number">1060</span><span class="context"></span>
</pre>
<h4>Function: _parse_typedef_union - Line 1067</h4>
<pre>
<span class="line-number">1062</span><span class="context"></span>
<span class="line-number">1063</span><span class="context">        # Skip whitespace</span>
<span class="line-number">1064</span><span class="context">        while self.pos &lt; len(self.tokens) and self._current_token_is(</span>
<span class="line-number">1065</span><span class="context">            TokenType.WHITESPACE</span>
<span class="line-number">1066</span><span class="context">        ):</span>
<span class="line-number">1067</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">1068</span><span class="context"></span>
<span class="line-number">1069</span><span class="context">        # Get union tag name (optional)</span>
<span class="line-number">1070</span><span class="context">        union_tag = &quot;&quot;</span>
<span class="line-number">1071</span><span class="context">        if self._current_token_is(TokenType.IDENTIFIER):</span>
<span class="line-number">1072</span><span class="context">            union_tag = self._advance().value</span>
</pre>
<h4>Function: _parse_typedef_union - Line 1072</h4>
<pre>
<span class="line-number">1067</span><span class="context">            self.pos += 1</span>
<span class="line-number">1068</span><span class="context"></span>
<span class="line-number">1069</span><span class="context">        # Get union tag name (optional)</span>
<span class="line-number">1070</span><span class="context">        union_tag = &quot;&quot;</span>
<span class="line-number">1071</span><span class="context">        if self._current_token_is(TokenType.IDENTIFIER):</span>
<span class="line-number">1072</span><span class="uncovered">            union_tag = self._advance().value</span>
<span class="line-number">1073</span><span class="context"></span>
<span class="line-number">1074</span><span class="context">        # Find opening brace</span>
<span class="line-number">1075</span><span class="context">        while self.pos &lt; len(self.tokens) and not self._current_token_is(</span>
<span class="line-number">1076</span><span class="context">            TokenType.LBRACE</span>
<span class="line-number">1077</span><span class="context">        ):</span>
</pre>
<h4>Function: _parse_typedef_union - Line 1078</h4>
<pre>
<span class="line-number">1073</span><span class="context"></span>
<span class="line-number">1074</span><span class="context">        # Find opening brace</span>
<span class="line-number">1075</span><span class="context">        while self.pos &lt; len(self.tokens) and not self._current_token_is(</span>
<span class="line-number">1076</span><span class="context">            TokenType.LBRACE</span>
<span class="line-number">1077</span><span class="context">        ):</span>
<span class="line-number">1078</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">1079</span><span class="context"></span>
<span class="line-number">1080</span><span class="context">        if self.pos &gt;= len(self.tokens):</span>
<span class="line-number">1081</span><span class="context">            return None</span>
<span class="line-number">1082</span><span class="context"></span>
<span class="line-number">1083</span><span class="context">        # Find matching closing brace</span>
</pre>
<h4>Function: _parse_typedef_union - Line 1081</h4>
<pre>
<span class="line-number">1076</span><span class="context">            TokenType.LBRACE</span>
<span class="line-number">1077</span><span class="context">        ):</span>
<span class="line-number">1078</span><span class="context">            self.pos += 1</span>
<span class="line-number">1079</span><span class="context"></span>
<span class="line-number">1080</span><span class="context">        if self.pos &gt;= len(self.tokens):</span>
<span class="line-number">1081</span><span class="uncovered">            return None</span>
<span class="line-number">1082</span><span class="context"></span>
<span class="line-number">1083</span><span class="context">        # Find matching closing brace</span>
<span class="line-number">1084</span><span class="context">        end_pos = self._find_matching_brace(self.pos)</span>
<span class="line-number">1085</span><span class="context">        if end_pos is None:</span>
<span class="line-number">1086</span><span class="context">            return None</span>
</pre>
<h4>Function: _parse_typedef_union - Line 1086</h4>
<pre>
<span class="line-number">1081</span><span class="context">            return None</span>
<span class="line-number">1082</span><span class="context"></span>
<span class="line-number">1083</span><span class="context">        # Find matching closing brace</span>
<span class="line-number">1084</span><span class="context">        end_pos = self._find_matching_brace(self.pos)</span>
<span class="line-number">1085</span><span class="context">        if end_pos is None:</span>
<span class="line-number">1086</span><span class="uncovered">            return None</span>
<span class="line-number">1087</span><span class="context"></span>
<span class="line-number">1088</span><span class="context">        # Look for typedef name after closing brace</span>
<span class="line-number">1089</span><span class="context">        typedef_name = &quot;&quot;</span>
<span class="line-number">1090</span><span class="context">        self.pos = end_pos + 1</span>
<span class="line-number">1091</span><span class="context">        while self.pos &lt; len(self.tokens) and not self._current_token_is(</span>
</pre>
<h4>Function: _parse_typedef_union - Line 1097</h4>
<pre>
<span class="line-number">1092</span><span class="context">            TokenType.SEMICOLON</span>
<span class="line-number">1093</span><span class="context">        ):</span>
<span class="line-number">1094</span><span class="context">            if self._current_token_is(TokenType.IDENTIFIER):</span>
<span class="line-number">1095</span><span class="context">                typedef_name = self._advance().value</span>
<span class="line-number">1096</span><span class="context">                break</span>
<span class="line-number">1097</span><span class="uncovered">            self.pos += 1</span>
<span class="line-number">1098</span><span class="context"></span>
<span class="line-number">1099</span><span class="context">        return (start_pos, end_pos, typedef_name)</span>
<span class="line-number">1100</span><span class="context"></span>
<span class="line-number">1101</span><span class="context"></span>
<span class="line-number">1102</span><span class="context">def extract_token_range(tokens: List[Token], start: int, end: int) -&gt; str:</span>
</pre>
<h4>Function: find_struct_fields - Line 1126</h4>
<pre>
<span class="line-number">1121</span><span class="context">    fields = []</span>
<span class="line-number">1122</span><span class="context">    pos = struct_start</span>
<span class="line-number">1123</span><span class="context">    while pos &lt;= struct_end and tokens[pos].type != TokenType.LBRACE:</span>
<span class="line-number">1124</span><span class="context">        pos += 1</span>
<span class="line-number">1125</span><span class="context">    if pos &gt; struct_end:</span>
<span class="line-number">1126</span><span class="uncovered">        return fields</span>
<span class="line-number">1127</span><span class="context">    pos += 1  # Skip opening brace</span>
<span class="line-number">1128</span><span class="context"></span>
<span class="line-number">1129</span><span class="context">    # Find the closing brace position</span>
<span class="line-number">1130</span><span class="context">    closing_brace_pos = pos</span>
<span class="line-number">1131</span><span class="context">    while (</span>
</pre>
<h4>Function: find_struct_fields - Line 1155</h4>
<pre>
<span class="line-number">1150</span><span class="context">                and field_tokens[0].type == TokenType.STRUCT</span>
<span class="line-number">1151</span><span class="context">                and field_tokens[1].type == TokenType.LBRACE</span>
<span class="line-number">1152</span><span class="context">            ):</span>
<span class="line-number">1153</span><span class="context">                # This is a nested anonymous struct</span>
<span class="line-number">1154</span><span class="context">                # Find the struct name (last token before semicolon)</span>
<span class="line-number">1155</span><span class="uncovered">                field_name = field_tokens[-1].value</span>
<span class="line-number">1156</span><span class="context">                # Create a simplified type representation for nested struct</span>
<span class="line-number">1157</span><span class="context">                field_type = &quot;struct { ... }&quot;</span>
<span class="line-number">1158</span><span class="context">                if (</span>
<span class="line-number">1159</span><span class="context">                    field_name</span>
<span class="line-number">1160</span><span class="context">                    and field_name.strip()</span>
</pre>
<h4>Function: find_struct_fields - Lines 1157-1158</h4>
<pre>
<span class="line-number">1152</span><span class="context">            ):</span>
<span class="line-number">1153</span><span class="context">                # This is a nested anonymous struct</span>
<span class="line-number">1154</span><span class="context">                # Find the struct name (last token before semicolon)</span>
<span class="line-number">1155</span><span class="context">                field_name = field_tokens[-1].value</span>
<span class="line-number">1156</span><span class="context">                # Create a simplified type representation for nested struct</span>
<span class="line-number">1157</span><span class="uncovered">                field_type = &quot;struct { ... }&quot;</span>
<span class="line-number">1158</span><span class="uncovered">                if (</span>
<span class="line-number">1159</span><span class="context">                    field_name</span>
<span class="line-number">1160</span><span class="context">                    and field_name.strip()</span>
<span class="line-number">1161</span><span class="context">                    and field_name not in [&quot;[&quot;, &quot;]&quot;, &quot;;&quot;, &quot;}&quot;]</span>
<span class="line-number">1162</span><span class="context">                ):</span>
<span class="line-number">1163</span><span class="context">                    stripped_name = field_name.strip()</span>
</pre>
<h4>Function: find_struct_fields - Lines 1163-1165</h4>
<pre>
<span class="line-number">1158</span><span class="context">                if (</span>
<span class="line-number">1159</span><span class="context">                    field_name</span>
<span class="line-number">1160</span><span class="context">                    and field_name.strip()</span>
<span class="line-number">1161</span><span class="context">                    and field_name not in [&quot;[&quot;, &quot;]&quot;, &quot;;&quot;, &quot;}&quot;]</span>
<span class="line-number">1162</span><span class="context">                ):</span>
<span class="line-number">1163</span><span class="uncovered">                    stripped_name = field_name.strip()</span>
<span class="line-number">1164</span><span class="uncovered">                    if stripped_name:</span>
<span class="line-number">1165</span><span class="uncovered">                        fields.append((stripped_name, field_type))</span>
<span class="line-number">1166</span><span class="context">                        # Skip parsing the nested struct&#x27;s fields as separate fields</span>
<span class="line-number">1167</span><span class="context">                        continue</span>
<span class="line-number">1168</span><span class="context">            # Check if this is a nested struct field with more complex structure</span>
<span class="line-number">1169</span><span class="context">            elif (</span>
<span class="line-number">1170</span><span class="context">                len(field_tokens) &gt;= 4</span>
</pre>
<h4>Function: find_struct_fields - Line 1167</h4>
<pre>
<span class="line-number">1162</span><span class="context">                ):</span>
<span class="line-number">1163</span><span class="context">                    stripped_name = field_name.strip()</span>
<span class="line-number">1164</span><span class="context">                    if stripped_name:</span>
<span class="line-number">1165</span><span class="context">                        fields.append((stripped_name, field_type))</span>
<span class="line-number">1166</span><span class="context">                        # Skip parsing the nested struct&#x27;s fields as separate fields</span>
<span class="line-number">1167</span><span class="uncovered">                        continue</span>
<span class="line-number">1168</span><span class="context">            # Check if this is a nested struct field with more complex structure</span>
<span class="line-number">1169</span><span class="context">            elif (</span>
<span class="line-number">1170</span><span class="context">                len(field_tokens) &gt;= 4</span>
<span class="line-number">1171</span><span class="context">                and field_tokens[0].type == TokenType.STRUCT</span>
<span class="line-number">1172</span><span class="context">                and field_tokens[1].type == TokenType.LBRACE</span>
</pre>
<h4>Function: find_struct_fields - Lines 1176-1178</h4>
<pre>
<span class="line-number">1171</span><span class="context">                and field_tokens[0].type == TokenType.STRUCT</span>
<span class="line-number">1172</span><span class="context">                and field_tokens[1].type == TokenType.LBRACE</span>
<span class="line-number">1173</span><span class="context">                and field_tokens[-1].type == TokenType.IDENTIFIER</span>
<span class="line-number">1174</span><span class="context">            ):</span>
<span class="line-number">1175</span><span class="context">                # This is a nested anonymous struct with a name</span>
<span class="line-number">1176</span><span class="uncovered">                field_name = field_tokens[-1].value</span>
<span class="line-number">1177</span><span class="uncovered">                field_type = &quot;struct { ... }&quot;</span>
<span class="line-number">1178</span><span class="uncovered">                if (</span>
<span class="line-number">1179</span><span class="context">                    field_name</span>
<span class="line-number">1180</span><span class="context">                    and field_name.strip()</span>
<span class="line-number">1181</span><span class="context">                    and field_name not in [&quot;[&quot;, &quot;]&quot;, &quot;;&quot;, &quot;}&quot;]</span>
<span class="line-number">1182</span><span class="context">                ):</span>
<span class="line-number">1183</span><span class="context">                    stripped_name = field_name.strip()</span>
</pre>
<h4>Function: find_struct_fields - Lines 1183-1185</h4>
<pre>
<span class="line-number">1178</span><span class="context">                if (</span>
<span class="line-number">1179</span><span class="context">                    field_name</span>
<span class="line-number">1180</span><span class="context">                    and field_name.strip()</span>
<span class="line-number">1181</span><span class="context">                    and field_name not in [&quot;[&quot;, &quot;]&quot;, &quot;;&quot;, &quot;}&quot;]</span>
<span class="line-number">1182</span><span class="context">                ):</span>
<span class="line-number">1183</span><span class="uncovered">                    stripped_name = field_name.strip()</span>
<span class="line-number">1184</span><span class="uncovered">                    if stripped_name:</span>
<span class="line-number">1185</span><span class="uncovered">                        fields.append((stripped_name, field_type))</span>
<span class="line-number">1186</span><span class="context">                        # Skip parsing the nested struct&#x27;s fields as separate fields</span>
<span class="line-number">1187</span><span class="context">                        continue</span>
<span class="line-number">1188</span><span class="context">            # Array field: type name [ size ]</span>
<span class="line-number">1189</span><span class="context">            elif (</span>
<span class="line-number">1190</span><span class="context">                len(field_tokens) &gt;= 4</span>
</pre>
<h4>Function: find_struct_fields - Line 1187</h4>
<pre>
<span class="line-number">1182</span><span class="context">                ):</span>
<span class="line-number">1183</span><span class="context">                    stripped_name = field_name.strip()</span>
<span class="line-number">1184</span><span class="context">                    if stripped_name:</span>
<span class="line-number">1185</span><span class="context">                        fields.append((stripped_name, field_type))</span>
<span class="line-number">1186</span><span class="context">                        # Skip parsing the nested struct&#x27;s fields as separate fields</span>
<span class="line-number">1187</span><span class="uncovered">                        continue</span>
<span class="line-number">1188</span><span class="context">            # Array field: type name [ size ]</span>
<span class="line-number">1189</span><span class="context">            elif (</span>
<span class="line-number">1190</span><span class="context">                len(field_tokens) &gt;= 4</span>
<span class="line-number">1191</span><span class="context">                and field_tokens[-3].type == TokenType.LBRACKET</span>
<span class="line-number">1192</span><span class="context">                and field_tokens[-1].type == TokenType.RBRACKET</span>
</pre>
<h4>Function: find_enum_values - Line 1240</h4>
<pre>
<span class="line-number">1235</span><span class="context">    values = []</span>
<span class="line-number">1236</span><span class="context">    pos = enum_start</span>
<span class="line-number">1237</span><span class="context">    while pos &lt;= enum_end and tokens[pos].type != TokenType.LBRACE:</span>
<span class="line-number">1238</span><span class="context">        pos += 1</span>
<span class="line-number">1239</span><span class="context">    if pos &gt; enum_end:</span>
<span class="line-number">1240</span><span class="uncovered">        return values</span>
<span class="line-number">1241</span><span class="context">    pos += 1  # Skip opening brace</span>
<span class="line-number">1242</span><span class="context">    current_value = []</span>
<span class="line-number">1243</span><span class="context">    while pos &lt;= enum_end and tokens[pos].type != TokenType.RBRACE:</span>
<span class="line-number">1244</span><span class="context">        token = tokens[pos]</span>
<span class="line-number">1245</span><span class="context">        if token.type == TokenType.COMMA:</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/utils.py - 61.19% coverage (41/67 lines)
</div>
<h4>Function: unknown function - Line 13</h4>
<pre>
<span class="line-number">  8</span><span class="context">from typing import Dict, Optional</span>
<span class="line-number">  9</span><span class="context"></span>
<span class="line-number"> 10</span><span class="context"># Try to import chardet, fallback to basic encoding detection if not available</span>
<span class="line-number"> 11</span><span class="context">try:</span>
<span class="line-number"> 12</span><span class="context">    import chardet</span>
<span class="line-number"> 13</span><span class="uncovered">    CHARDET_AVAILABLE = True</span>
<span class="line-number"> 14</span><span class="context">except ImportError:</span>
<span class="line-number"> 15</span><span class="context">    CHARDET_AVAILABLE = False</span>
<span class="line-number"> 16</span><span class="context"></span>
<span class="line-number"> 17</span><span class="context"></span>
<span class="line-number"> 18</span><span class="context">def detect_file_encoding(file_path: Path) -&gt; str:</span>
</pre>
<h4>Function: detect_file_encoding - Lines 23-28</h4>
<pre>
<span class="line-number"> 18</span><span class="context">def detect_file_encoding(file_path: Path) -&gt; str:</span>
<span class="line-number"> 19</span><span class="context">    &quot;&quot;&quot;Detect file encoding with platform-aware fallbacks&quot;&quot;&quot;</span>
<span class="line-number"> 20</span><span class="context">    try:</span>
<span class="line-number"> 21</span><span class="context">        if CHARDET_AVAILABLE:</span>
<span class="line-number"> 22</span><span class="context">            # Try to detect encoding with chardet</span>
<span class="line-number"> 23</span><span class="uncovered">            with open(file_path, &quot;rb&quot;) as f:</span>
<span class="line-number"> 24</span><span class="uncovered">                raw_data = f.read(1024)  # Read first 1KB for detection</span>
<span class="line-number"> 25</span><span class="uncovered">                if raw_data:</span>
<span class="line-number"> 26</span><span class="uncovered">                    result = chardet.detect(raw_data)</span>
<span class="line-number"> 27</span><span class="uncovered">                    if result and result[&quot;confidence&quot;] &gt; 0.7:</span>
<span class="line-number"> 28</span><span class="uncovered">                        return result[&quot;encoding&quot;]</span>
<span class="line-number"> 29</span><span class="context"></span>
<span class="line-number"> 30</span><span class="context">        # Fallback encodings in order of preference</span>
<span class="line-number"> 31</span><span class="context">        fallback_encodings = [&quot;utf-8&quot;, &quot;latin-1&quot;, &quot;cp1252&quot;, &quot;iso-8859-1&quot;]</span>
<span class="line-number"> 32</span><span class="context"></span>
<span class="line-number"> 33</span><span class="context">        for encoding in fallback_encodings:</span>
</pre>
<h4>Function: detect_file_encoding - Line 39</h4>
<pre>
<span class="line-number"> 34</span><span class="context">            try:</span>
<span class="line-number"> 35</span><span class="context">                with open(file_path, &quot;r&quot;, encoding=encoding) as f:</span>
<span class="line-number"> 36</span><span class="context">                    f.read(1024)  # Test read</span>
<span class="line-number"> 37</span><span class="context">                return encoding</span>
<span class="line-number"> 38</span><span class="context">            except (UnicodeDecodeError, UnicodeError):</span>
<span class="line-number"> 39</span><span class="uncovered">                continue</span>
<span class="line-number"> 40</span><span class="context"></span>
<span class="line-number"> 41</span><span class="context">        # Final fallback</span>
<span class="line-number"> 42</span><span class="context">        return &quot;utf-8&quot;</span>
<span class="line-number"> 43</span><span class="context"></span>
<span class="line-number"> 44</span><span class="context">    except Exception as e:</span>
</pre>
<h4>Function: detect_file_encoding - Line 42</h4>
<pre>
<span class="line-number"> 37</span><span class="context">                return encoding</span>
<span class="line-number"> 38</span><span class="context">            except (UnicodeDecodeError, UnicodeError):</span>
<span class="line-number"> 39</span><span class="context">                continue</span>
<span class="line-number"> 40</span><span class="context"></span>
<span class="line-number"> 41</span><span class="context">        # Final fallback</span>
<span class="line-number"> 42</span><span class="uncovered">        return &quot;utf-8&quot;</span>
<span class="line-number"> 43</span><span class="context"></span>
<span class="line-number"> 44</span><span class="context">    except Exception as e:</span>
<span class="line-number"> 45</span><span class="context">        logging.warning(f&quot;Failed to detect encoding for {file_path}: {e}&quot;)</span>
<span class="line-number"> 46</span><span class="context">        return &quot;utf-8&quot;</span>
<span class="line-number"> 47</span><span class="context"></span>
</pre>
<h4>Function: get_filename_from_path - Line 51</h4>
<pre>
<span class="line-number"> 46</span><span class="context">        return &quot;utf-8&quot;</span>
<span class="line-number"> 47</span><span class="context"></span>
<span class="line-number"> 48</span><span class="context"></span>
<span class="line-number"> 49</span><span class="context">def get_filename_from_path(file_path: str) -&gt; str:</span>
<span class="line-number"> 50</span><span class="context">    &quot;&quot;&quot;Extract filename from a file path (handles both absolute and relative paths)&quot;&quot;&quot;</span>
<span class="line-number"> 51</span><span class="uncovered">    return Path(file_path).name</span>
<span class="line-number"> 52</span><span class="context"></span>
<span class="line-number"> 53</span><span class="context"></span>
<span class="line-number"> 54</span><span class="context">def find_file_by_filename(filename: str, file_dict: Dict[str, any]) -&gt; Optional[str]:</span>
<span class="line-number"> 55</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number"> 56</span><span class="context">    Find a file in a dictionary by matching its filename.</span>
</pre>
<h4>Function: find_file_by_filename - Lines 66-67</h4>
<pre>
<span class="line-number"> 61</span><span class="context"></span>
<span class="line-number"> 62</span><span class="context">    Returns:</span>
<span class="line-number"> 63</span><span class="context">        The matching file path key, or None if not found</span>
<span class="line-number"> 64</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number"> 65</span><span class="context">    # First try exact match</span>
<span class="line-number"> 66</span><span class="uncovered">    if filename in file_dict:</span>
<span class="line-number"> 67</span><span class="uncovered">        return filename</span>
<span class="line-number"> 68</span><span class="context"></span>
<span class="line-number"> 69</span><span class="context">    # Try matching by filename</span>
<span class="line-number"> 70</span><span class="context">    for file_path in file_dict.keys():</span>
<span class="line-number"> 71</span><span class="context">        if Path(file_path).name == filename:</span>
<span class="line-number"> 72</span><span class="context">            return file_path</span>
</pre>
<h4>Function: find_file_by_filename - Lines 70-72</h4>
<pre>
<span class="line-number"> 65</span><span class="context">    # First try exact match</span>
<span class="line-number"> 66</span><span class="context">    if filename in file_dict:</span>
<span class="line-number"> 67</span><span class="context">        return filename</span>
<span class="line-number"> 68</span><span class="context"></span>
<span class="line-number"> 69</span><span class="context">    # Try matching by filename</span>
<span class="line-number"> 70</span><span class="uncovered">    for file_path in file_dict.keys():</span>
<span class="line-number"> 71</span><span class="uncovered">        if Path(file_path).name == filename:</span>
<span class="line-number"> 72</span><span class="uncovered">            return file_path</span>
<span class="line-number"> 73</span><span class="context"></span>
<span class="line-number"> 74</span><span class="context">    return None</span>
<span class="line-number"> 75</span><span class="context"></span>
<span class="line-number"> 76</span><span class="context"></span>
<span class="line-number"> 77</span><span class="context">def normalize_file_path(file_path: str, project_root: str = None) -&gt; str:</span>
</pre>
<h4>Function: find_file_by_filename - Line 74</h4>
<pre>
<span class="line-number"> 69</span><span class="context">    # Try matching by filename</span>
<span class="line-number"> 70</span><span class="context">    for file_path in file_dict.keys():</span>
<span class="line-number"> 71</span><span class="context">        if Path(file_path).name == filename:</span>
<span class="line-number"> 72</span><span class="context">            return file_path</span>
<span class="line-number"> 73</span><span class="context"></span>
<span class="line-number"> 74</span><span class="uncovered">    return None</span>
<span class="line-number"> 75</span><span class="context"></span>
<span class="line-number"> 76</span><span class="context"></span>
<span class="line-number"> 77</span><span class="context">def normalize_file_path(file_path: str, project_root: str = None) -&gt; str:</span>
<span class="line-number"> 78</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number"> 79</span><span class="context">    Normalize file path for consistent handling.</span>
</pre>
<h4>Function: normalize_file_path - Line 89</h4>
<pre>
<span class="line-number"> 84</span><span class="context">        project_root: Optional project root for relative path conversion</span>
<span class="line-number"> 85</span><span class="context"></span>
<span class="line-number"> 86</span><span class="context">    Returns:</span>
<span class="line-number"> 87</span><span class="context">        Normalized file path</span>
<span class="line-number"> 88</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number"> 89</span><span class="uncovered">    path_obj = Path(file_path)</span>
<span class="line-number"> 90</span><span class="context"></span>
<span class="line-number"> 91</span><span class="context">    # If we have a project root and the path is absolute, try to make it relative</span>
<span class="line-number"> 92</span><span class="context">    if project_root and path_obj.is_absolute():</span>
<span class="line-number"> 93</span><span class="context">        try:</span>
<span class="line-number"> 94</span><span class="context">            relative_path = path_obj.relative_to(Path(project_root))</span>
</pre>
<h4>Function: normalize_file_path - Lines 92-96</h4>
<pre>
<span class="line-number"> 87</span><span class="context">        Normalized file path</span>
<span class="line-number"> 88</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number"> 89</span><span class="context">    path_obj = Path(file_path)</span>
<span class="line-number"> 90</span><span class="context"></span>
<span class="line-number"> 91</span><span class="context">    # If we have a project root and the path is absolute, try to make it relative</span>
<span class="line-number"> 92</span><span class="uncovered">    if project_root and path_obj.is_absolute():</span>
<span class="line-number"> 93</span><span class="uncovered">        try:</span>
<span class="line-number"> 94</span><span class="uncovered">            relative_path = path_obj.relative_to(Path(project_root))</span>
<span class="line-number"> 95</span><span class="uncovered">            return str(relative_path)</span>
<span class="line-number"> 96</span><span class="uncovered">        except ValueError:</span>
<span class="line-number"> 97</span><span class="context">            # Path is not relative to project root, keep as is</span>
<span class="line-number"> 98</span><span class="context">            pass</span>
<span class="line-number"> 99</span><span class="context"></span>
<span class="line-number">100</span><span class="context">    return str(path_obj)</span>
<span class="line-number">101</span><span class="context"></span>
</pre>
<h4>Function: normalize_file_path - Line 98</h4>
<pre>
<span class="line-number"> 93</span><span class="context">        try:</span>
<span class="line-number"> 94</span><span class="context">            relative_path = path_obj.relative_to(Path(project_root))</span>
<span class="line-number"> 95</span><span class="context">            return str(relative_path)</span>
<span class="line-number"> 96</span><span class="context">        except ValueError:</span>
<span class="line-number"> 97</span><span class="context">            # Path is not relative to project root, keep as is</span>
<span class="line-number"> 98</span><span class="uncovered">            pass</span>
<span class="line-number"> 99</span><span class="context"></span>
<span class="line-number">100</span><span class="context">    return str(path_obj)</span>
<span class="line-number">101</span><span class="context"></span>
<span class="line-number">102</span><span class="context"></span>
<span class="line-number">103</span><span class="context">def create_file_key(file_path: str, project_root: str = None) -&gt; str:</span>
</pre>
<h4>Function: normalize_file_path - Line 100</h4>
<pre>
<span class="line-number"> 95</span><span class="context">            return str(relative_path)</span>
<span class="line-number"> 96</span><span class="context">        except ValueError:</span>
<span class="line-number"> 97</span><span class="context">            # Path is not relative to project root, keep as is</span>
<span class="line-number"> 98</span><span class="context">            pass</span>
<span class="line-number"> 99</span><span class="context"></span>
<span class="line-number">100</span><span class="uncovered">    return str(path_obj)</span>
<span class="line-number">101</span><span class="context"></span>
<span class="line-number">102</span><span class="context"></span>
<span class="line-number">103</span><span class="context">def create_file_key(file_path: str, project_root: str = None) -&gt; str:</span>
<span class="line-number">104</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number">105</span><span class="context">    Create a consistent file key for tracking.</span>
</pre>
<h4>Function: create_file_key - Line 115</h4>
<pre>
<span class="line-number">110</span><span class="context">        project_root: Optional project root for normalization</span>
<span class="line-number">111</span><span class="context"></span>
<span class="line-number">112</span><span class="context">    Returns:</span>
<span class="line-number">113</span><span class="context">        A consistent file key (filename)</span>
<span class="line-number">114</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number">115</span><span class="uncovered">    return get_filename_from_path(file_path)</span>
<span class="line-number">116</span><span class="context"></span>
<span class="line-number">117</span><span class="context"></span>
<span class="line-number">118</span><span class="context"># Backward compatibility functions for existing tests</span>
<span class="line-number">119</span><span class="context">def get_acceptable_encodings() -&gt; list:</span>
<span class="line-number">120</span><span class="context">    &quot;&quot;&quot;</span>
</pre>
<h4>Function: get_platform_default_encoding - Line 187</h4>
<pre>
<span class="line-number">182</span><span class="context">    Returns:</span>
<span class="line-number">183</span><span class="context">        The default encoding name for the current platform.</span>
<span class="line-number">184</span><span class="context">    &quot;&quot;&quot;</span>
<span class="line-number">185</span><span class="context">    import sys</span>
<span class="line-number">186</span><span class="context">    if sys.platform.startswith(&quot;win&quot;):</span>
<span class="line-number">187</span><span class="uncovered">        return &quot;windows-1252&quot;  # Common Windows default</span>
<span class="line-number">188</span><span class="context">    else:</span>
<span class="line-number">189</span><span class="context">        return &quot;utf-8&quot;  # Common Unix/Linux default</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/config.py - 89.00% coverage (178/200 lines)
</div>
<h4>Function: __init__ - Line 54</h4>
<pre>
<span class="line-number"> 49</span><span class="context">        # Initialize with default values first</span>
<span class="line-number"> 50</span><span class="context">        object.__init__(self)</span>
<span class="line-number"> 51</span><span class="context"></span>
<span class="line-number"> 52</span><span class="context">        # Ensure all dataclass fields are initialized with defaults</span>
<span class="line-number"> 53</span><span class="context">        if not hasattr(self, &quot;project_name&quot;):</span>
<span class="line-number"> 54</span><span class="uncovered">            self.project_name = &quot;Unknown_Project&quot;</span>
<span class="line-number"> 55</span><span class="context">        if not hasattr(self, &quot;source_folders&quot;):</span>
<span class="line-number"> 56</span><span class="context">            self.source_folders = []</span>
<span class="line-number"> 57</span><span class="context">        if not hasattr(self, &quot;output_dir&quot;):</span>
<span class="line-number"> 58</span><span class="context">            self.output_dir = &quot;./output&quot;</span>
<span class="line-number"> 59</span><span class="context">        if not hasattr(self, &quot;model_output_path&quot;):</span>
</pre>
<h4>Function: __init__ - Line 58</h4>
<pre>
<span class="line-number"> 53</span><span class="context">        if not hasattr(self, &quot;project_name&quot;):</span>
<span class="line-number"> 54</span><span class="context">            self.project_name = &quot;Unknown_Project&quot;</span>
<span class="line-number"> 55</span><span class="context">        if not hasattr(self, &quot;source_folders&quot;):</span>
<span class="line-number"> 56</span><span class="context">            self.source_folders = []</span>
<span class="line-number"> 57</span><span class="context">        if not hasattr(self, &quot;output_dir&quot;):</span>
<span class="line-number"> 58</span><span class="uncovered">            self.output_dir = &quot;./output&quot;</span>
<span class="line-number"> 59</span><span class="context">        if not hasattr(self, &quot;model_output_path&quot;):</span>
<span class="line-number"> 60</span><span class="context">            self.model_output_path = &quot;model.json&quot;</span>
<span class="line-number"> 61</span><span class="context">        if not hasattr(self, &quot;recursive_search&quot;):</span>
<span class="line-number"> 62</span><span class="context">            self.recursive_search = True</span>
<span class="line-number"> 63</span><span class="context">        if not hasattr(self, &quot;include_depth&quot;):</span>
</pre>
<h4>Function: __init__ - Line 60</h4>
<pre>
<span class="line-number"> 55</span><span class="context">        if not hasattr(self, &quot;source_folders&quot;):</span>
<span class="line-number"> 56</span><span class="context">            self.source_folders = []</span>
<span class="line-number"> 57</span><span class="context">        if not hasattr(self, &quot;output_dir&quot;):</span>
<span class="line-number"> 58</span><span class="context">            self.output_dir = &quot;./output&quot;</span>
<span class="line-number"> 59</span><span class="context">        if not hasattr(self, &quot;model_output_path&quot;):</span>
<span class="line-number"> 60</span><span class="uncovered">            self.model_output_path = &quot;model.json&quot;</span>
<span class="line-number"> 61</span><span class="context">        if not hasattr(self, &quot;recursive_search&quot;):</span>
<span class="line-number"> 62</span><span class="context">            self.recursive_search = True</span>
<span class="line-number"> 63</span><span class="context">        if not hasattr(self, &quot;include_depth&quot;):</span>
<span class="line-number"> 64</span><span class="context">            self.include_depth = 1</span>
<span class="line-number"> 65</span><span class="context">        if not hasattr(self, &quot;file_filters&quot;):</span>
</pre>
<h4>Function: __init__ - Line 62</h4>
<pre>
<span class="line-number"> 57</span><span class="context">        if not hasattr(self, &quot;output_dir&quot;):</span>
<span class="line-number"> 58</span><span class="context">            self.output_dir = &quot;./output&quot;</span>
<span class="line-number"> 59</span><span class="context">        if not hasattr(self, &quot;model_output_path&quot;):</span>
<span class="line-number"> 60</span><span class="context">            self.model_output_path = &quot;model.json&quot;</span>
<span class="line-number"> 61</span><span class="context">        if not hasattr(self, &quot;recursive_search&quot;):</span>
<span class="line-number"> 62</span><span class="uncovered">            self.recursive_search = True</span>
<span class="line-number"> 63</span><span class="context">        if not hasattr(self, &quot;include_depth&quot;):</span>
<span class="line-number"> 64</span><span class="context">            self.include_depth = 1</span>
<span class="line-number"> 65</span><span class="context">        if not hasattr(self, &quot;file_filters&quot;):</span>
<span class="line-number"> 66</span><span class="context">            self.file_filters = {}</span>
<span class="line-number"> 67</span><span class="context">        if not hasattr(self, &quot;element_filters&quot;):</span>
</pre>
<h4>Function: __init__ - Line 64</h4>
<pre>
<span class="line-number"> 59</span><span class="context">        if not hasattr(self, &quot;model_output_path&quot;):</span>
<span class="line-number"> 60</span><span class="context">            self.model_output_path = &quot;model.json&quot;</span>
<span class="line-number"> 61</span><span class="context">        if not hasattr(self, &quot;recursive_search&quot;):</span>
<span class="line-number"> 62</span><span class="context">            self.recursive_search = True</span>
<span class="line-number"> 63</span><span class="context">        if not hasattr(self, &quot;include_depth&quot;):</span>
<span class="line-number"> 64</span><span class="uncovered">            self.include_depth = 1</span>
<span class="line-number"> 65</span><span class="context">        if not hasattr(self, &quot;file_filters&quot;):</span>
<span class="line-number"> 66</span><span class="context">            self.file_filters = {}</span>
<span class="line-number"> 67</span><span class="context">        if not hasattr(self, &quot;element_filters&quot;):</span>
<span class="line-number"> 68</span><span class="context">            self.element_filters = {}</span>
<span class="line-number"> 69</span><span class="context">        if not hasattr(self, &quot;transformations&quot;):</span>
</pre>
<h4>Function: __init__ - Lines 89-92</h4>
<pre>
<span class="line-number"> 84</span><span class="context">            for key, value in data.items():</span>
<span class="line-number"> 85</span><span class="context">                if hasattr(self, key):</span>
<span class="line-number"> 86</span><span class="context">                    setattr(self, key, value)</span>
<span class="line-number"> 87</span><span class="context">        elif len(kwargs) == 1 and isinstance(next(iter(kwargs.values())), dict):</span>
<span class="line-number"> 88</span><span class="context">            # Handle case where a single dict is passed as keyword argument</span>
<span class="line-number"> 89</span><span class="uncovered">            data = next(iter(kwargs.values()))</span>
<span class="line-number"> 90</span><span class="uncovered">            for key, value in data.items():</span>
<span class="line-number"> 91</span><span class="uncovered">                if hasattr(self, key):</span>
<span class="line-number"> 92</span><span class="uncovered">                    setattr(self, key, value)</span>
<span class="line-number"> 93</span><span class="context">        else:</span>
<span class="line-number"> 94</span><span class="context">            # Handle normal keyword arguments</span>
<span class="line-number"> 95</span><span class="context">            for key, value in kwargs.items():</span>
<span class="line-number"> 96</span><span class="context">                if hasattr(self, key):</span>
<span class="line-number"> 97</span><span class="context">                    setattr(self, key, value)</span>
</pre>
<h4>Function: __post_init__ - Line 104</h4>
<pre>
<span class="line-number"> 99</span><span class="context">        # Compile patterns after initialization</span>
<span class="line-number">100</span><span class="context">        self._compile_patterns()</span>
<span class="line-number">101</span><span class="context"></span>
<span class="line-number">102</span><span class="context">    def __post_init__(self):</span>
<span class="line-number">103</span><span class="context">        &quot;&quot;&quot;Compile regex patterns after initialization&quot;&quot;&quot;</span>
<span class="line-number">104</span><span class="uncovered">        self._compile_patterns()</span>
<span class="line-number">105</span><span class="context"></span>
<span class="line-number">106</span><span class="context">    def _compile_patterns(self):</span>
<span class="line-number">107</span><span class="context">        &quot;&quot;&quot;Compile regex patterns for filtering&quot;&quot;&quot;</span>
<span class="line-number">108</span><span class="context">        # Compile file filter patterns with error handling</span>
<span class="line-number">109</span><span class="context">        self.file_include_patterns = []</span>
</pre>
<h4>Function: _compile_patterns - Lines 148-149</h4>
<pre>
<span class="line-number">143</span><span class="context">            for pattern in filters.get(&quot;exclude&quot;, []):</span>
<span class="line-number">144</span><span class="context">                try:</span>
<span class="line-number">145</span><span class="context">                    self.element_exclude_patterns[element_type].append(</span>
<span class="line-number">146</span><span class="context">                        re.compile(pattern)</span>
<span class="line-number">147</span><span class="context">                    )</span>
<span class="line-number">148</span><span class="uncovered">                except re.error as e:</span>
<span class="line-number">149</span><span class="uncovered">                    self.logger.warning(</span>
<span class="line-number">150</span><span class="context">                        &quot;Invalid %s exclude pattern &#x27;%s&#x27;: %s&quot;, element_type, pattern, e</span>
<span class="line-number">151</span><span class="context">                    )</span>
<span class="line-number">152</span><span class="context">                    # Skip invalid patterns</span>
<span class="line-number">153</span><span class="context"></span>
<span class="line-number">154</span><span class="context">    @classmethod</span>
</pre>
<h4>Function: load - Line 158</h4>
<pre>
<span class="line-number">153</span><span class="context"></span>
<span class="line-number">154</span><span class="context">    @classmethod</span>
<span class="line-number">155</span><span class="context">    def load(cls, config_file: str) -&gt; &quot;Config&quot;:</span>
<span class="line-number">156</span><span class="context">        &quot;&quot;&quot;Load configuration from JSON file&quot;&quot;&quot;</span>
<span class="line-number">157</span><span class="context">        if not Path(config_file).exists():</span>
<span class="line-number">158</span><span class="uncovered">            raise FileNotFoundError(f&quot;Configuration file not found: {config_file}&quot;)</span>
<span class="line-number">159</span><span class="context"></span>
<span class="line-number">160</span><span class="context">        try:</span>
<span class="line-number">161</span><span class="context">            with open(config_file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number">162</span><span class="context">                data = json.load(f)</span>
<span class="line-number">163</span><span class="context"></span>
</pre>
<h4>Function: load - Line 166</h4>
<pre>
<span class="line-number">161</span><span class="context">            with open(config_file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number">162</span><span class="context">                data = json.load(f)</span>
<span class="line-number">163</span><span class="context"></span>
<span class="line-number">164</span><span class="context">            # Handle backward compatibility: project_roots -&gt; source_folders</span>
<span class="line-number">165</span><span class="context">            if &quot;project_roots&quot; in data and &quot;source_folders&quot; not in data:</span>
<span class="line-number">166</span><span class="uncovered">                data[&quot;source_folders&quot;] = data.pop(&quot;project_roots&quot;)</span>
<span class="line-number">167</span><span class="context"></span>
<span class="line-number">168</span><span class="context">            # Validate required fields</span>
<span class="line-number">169</span><span class="context">            if &quot;source_folders&quot; not in data:</span>
<span class="line-number">170</span><span class="context">                raise ValueError(&quot;Configuration must contain &#x27;source_folders&#x27; field&quot;)</span>
<span class="line-number">171</span><span class="context"></span>
</pre>
<h4>Function: load - Line 170</h4>
<pre>
<span class="line-number">165</span><span class="context">            if &quot;project_roots&quot; in data and &quot;source_folders&quot; not in data:</span>
<span class="line-number">166</span><span class="context">                data[&quot;source_folders&quot;] = data.pop(&quot;project_roots&quot;)</span>
<span class="line-number">167</span><span class="context"></span>
<span class="line-number">168</span><span class="context">            # Validate required fields</span>
<span class="line-number">169</span><span class="context">            if &quot;source_folders&quot; not in data:</span>
<span class="line-number">170</span><span class="uncovered">                raise ValueError(&quot;Configuration must contain &#x27;source_folders&#x27; field&quot;)</span>
<span class="line-number">171</span><span class="context"></span>
<span class="line-number">172</span><span class="context">            if not isinstance(data[&quot;source_folders&quot;], list):</span>
<span class="line-number">173</span><span class="context">                raise ValueError(&quot;&#x27;source_folders&#x27; must be a list&quot;)</span>
<span class="line-number">174</span><span class="context"></span>
<span class="line-number">175</span><span class="context">            return cls(**data)</span>
</pre>
<h4>Function: save - Lines 199-200</h4>
<pre>
<span class="line-number">194</span><span class="context">        }</span>
<span class="line-number">195</span><span class="context"></span>
<span class="line-number">196</span><span class="context">        try:</span>
<span class="line-number">197</span><span class="context">            with open(config_file, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:</span>
<span class="line-number">198</span><span class="context">                json.dump(data, f, indent=2, ensure_ascii=False)</span>
<span class="line-number">199</span><span class="uncovered">        except Exception as e:</span>
<span class="line-number">200</span><span class="uncovered">            raise ValueError(</span>
<span class="line-number">201</span><span class="context">                f&quot;Failed to save configuration to {config_file}: {e}&quot;</span>
<span class="line-number">202</span><span class="context">            ) from e</span>
<span class="line-number">203</span><span class="context"></span>
<span class="line-number">204</span><span class="context">    def has_filters(self) -&gt; bool:</span>
<span class="line-number">205</span><span class="context">        &quot;&quot;&quot;Check if configuration has any filters defined&quot;&quot;&quot;</span>
</pre>
<h4>Function: _apply_element_filters - Line 260</h4>
<pre>
<span class="line-number">255</span><span class="context">                filtered_model.enums, self.element_filters[&quot;enums&quot;]</span>
<span class="line-number">256</span><span class="context">            )</span>
<span class="line-number">257</span><span class="context"></span>
<span class="line-number">258</span><span class="context">        # Filter unions</span>
<span class="line-number">259</span><span class="context">        if &quot;unions&quot; in self.element_filters:</span>
<span class="line-number">260</span><span class="uncovered">            filtered_model.unions = self._filter_dict(</span>
<span class="line-number">261</span><span class="context">                filtered_model.unions, self.element_filters[&quot;unions&quot;]</span>
<span class="line-number">262</span><span class="context">            )</span>
<span class="line-number">263</span><span class="context"></span>
<span class="line-number">264</span><span class="context">        # Filter functions</span>
<span class="line-number">265</span><span class="context">        if &quot;functions&quot; in self.element_filters:</span>
</pre>
<h4>Function: _filter_list - Lines 361-362</h4>
<pre>
<span class="line-number">356</span><span class="context"></span>
<span class="line-number">357</span><span class="context">            # Check exclude patterns</span>
<span class="line-number">358</span><span class="context">            should_exclude = False</span>
<span class="line-number">359</span><span class="context">            for pattern in exclude_patterns:</span>
<span class="line-number">360</span><span class="context">                if pattern.search(name):</span>
<span class="line-number">361</span><span class="uncovered">                    should_exclude = True</span>
<span class="line-number">362</span><span class="uncovered">                    break</span>
<span class="line-number">363</span><span class="context">            if should_exclude:</span>
<span class="line-number">364</span><span class="context">                continue</span>
<span class="line-number">365</span><span class="context"></span>
<span class="line-number">366</span><span class="context">            filtered_items.append(item)</span>
<span class="line-number">367</span><span class="context"></span>
</pre>
<h4>Function: _filter_list - Line 364</h4>
<pre>
<span class="line-number">359</span><span class="context">            for pattern in exclude_patterns:</span>
<span class="line-number">360</span><span class="context">                if pattern.search(name):</span>
<span class="line-number">361</span><span class="context">                    should_exclude = True</span>
<span class="line-number">362</span><span class="context">                    break</span>
<span class="line-number">363</span><span class="context">            if should_exclude:</span>
<span class="line-number">364</span><span class="uncovered">                continue</span>
<span class="line-number">365</span><span class="context"></span>
<span class="line-number">366</span><span class="context">            filtered_items.append(item)</span>
<span class="line-number">367</span><span class="context"></span>
<span class="line-number">368</span><span class="context">        return filtered_items</span>
<span class="line-number">369</span><span class="context"></span>
</pre>
<h4>Function: __eq__ - Line 386</h4>
<pre>
<span class="line-number">381</span><span class="context">        }</span>
<span class="line-number">382</span><span class="context"></span>
<span class="line-number">383</span><span class="context">    def __eq__(self, other: Any) -&gt; bool:</span>
<span class="line-number">384</span><span class="context">        &quot;&quot;&quot;Check if two configurations are equal&quot;&quot;&quot;</span>
<span class="line-number">385</span><span class="context">        if not isinstance(other, Config):</span>
<span class="line-number">386</span><span class="uncovered">            return False</span>
<span class="line-number">387</span><span class="context"></span>
<span class="line-number">388</span><span class="context">        return (</span>
<span class="line-number">389</span><span class="context">            self.project_name == other.project_name</span>
<span class="line-number">390</span><span class="context">            and self.source_folders == other.source_folders</span>
<span class="line-number">391</span><span class="context">            and self.output_dir == other.output_dir</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/verifier.py - 84.17% coverage (117/139 lines)
</div>
<h4>Function: _verify_file - Line 67</h4>
<pre>
<span class="line-number"> 62</span><span class="context"></span>
<span class="line-number"> 63</span><span class="context">    def _verify_file(self, file_path: str, file_model: FileModel) -&gt; None:</span>
<span class="line-number"> 64</span><span class="context">        &quot;&quot;&quot;Verify a single file model&quot;&quot;&quot;</span>
<span class="line-number"> 65</span><span class="context">        # Verify file-level data</span>
<span class="line-number"> 66</span><span class="context">        if not file_model.file_path or not file_model.file_path.strip():</span>
<span class="line-number"> 67</span><span class="uncovered">            self.issues.append(f&quot;File path is empty in {file_path}&quot;)</span>
<span class="line-number"> 68</span><span class="context"></span>
<span class="line-number"> 69</span><span class="context">        if not file_model.relative_path or not file_model.relative_path.strip():</span>
<span class="line-number"> 70</span><span class="context">            self.issues.append(f&quot;Relative path is empty in {file_path}&quot;)</span>
<span class="line-number"> 71</span><span class="context"></span>
<span class="line-number"> 72</span><span class="context">        # Verify structs</span>
</pre>
<h4>Function: _verify_file - Line 70</h4>
<pre>
<span class="line-number"> 65</span><span class="context">        # Verify file-level data</span>
<span class="line-number"> 66</span><span class="context">        if not file_model.file_path or not file_model.file_path.strip():</span>
<span class="line-number"> 67</span><span class="context">            self.issues.append(f&quot;File path is empty in {file_path}&quot;)</span>
<span class="line-number"> 68</span><span class="context"></span>
<span class="line-number"> 69</span><span class="context">        if not file_model.relative_path or not file_model.relative_path.strip():</span>
<span class="line-number"> 70</span><span class="uncovered">            self.issues.append(f&quot;Relative path is empty in {file_path}&quot;)</span>
<span class="line-number"> 71</span><span class="context"></span>
<span class="line-number"> 72</span><span class="context">        # Verify structs</span>
<span class="line-number"> 73</span><span class="context">        for struct_name, struct in file_model.structs.items():</span>
<span class="line-number"> 74</span><span class="context">            self._verify_struct(file_path, struct_name, struct)</span>
<span class="line-number"> 75</span><span class="context"></span>
</pre>
<h4>Function: _verify_enum - Line 111</h4>
<pre>
<span class="line-number">106</span><span class="context">            self._verify_field(file_path, f&quot;struct {struct_name}&quot;, field)</span>
<span class="line-number">107</span><span class="context"></span>
<span class="line-number">108</span><span class="context">    def _verify_enum(self, file_path: str, enum_name: str, enum: Enum) -&gt; None:</span>
<span class="line-number">109</span><span class="context">        &quot;&quot;&quot;Verify an enum definition&quot;&quot;&quot;</span>
<span class="line-number">110</span><span class="context">        if not self._is_valid_identifier(enum_name):</span>
<span class="line-number">111</span><span class="uncovered">            self.issues.append(f&quot;Invalid enum name &#x27;{enum_name}&#x27; in {file_path}&quot;)</span>
<span class="line-number">112</span><span class="context"></span>
<span class="line-number">113</span><span class="context">        if not enum.name or not enum.name.strip():</span>
<span class="line-number">114</span><span class="context">            self.issues.append(f&quot;Enum name is empty in {file_path}&quot;)</span>
<span class="line-number">115</span><span class="context"></span>
<span class="line-number">116</span><span class="context">        # Verify enum values</span>
</pre>
<h4>Function: _verify_enum - Line 114</h4>
<pre>
<span class="line-number">109</span><span class="context">        &quot;&quot;&quot;Verify an enum definition&quot;&quot;&quot;</span>
<span class="line-number">110</span><span class="context">        if not self._is_valid_identifier(enum_name):</span>
<span class="line-number">111</span><span class="context">            self.issues.append(f&quot;Invalid enum name &#x27;{enum_name}&#x27; in {file_path}&quot;)</span>
<span class="line-number">112</span><span class="context"></span>
<span class="line-number">113</span><span class="context">        if not enum.name or not enum.name.strip():</span>
<span class="line-number">114</span><span class="uncovered">            self.issues.append(f&quot;Enum name is empty in {file_path}&quot;)</span>
<span class="line-number">115</span><span class="context"></span>
<span class="line-number">116</span><span class="context">        # Verify enum values</span>
<span class="line-number">117</span><span class="context">        for enum_value in enum.values:</span>
<span class="line-number">118</span><span class="context">            if not enum_value.name or not enum_value.name.strip():</span>
<span class="line-number">119</span><span class="context">                self.issues.append(</span>
</pre>
<h4>Function: _verify_enum - Line 119</h4>
<pre>
<span class="line-number">114</span><span class="context">            self.issues.append(f&quot;Enum name is empty in {file_path}&quot;)</span>
<span class="line-number">115</span><span class="context"></span>
<span class="line-number">116</span><span class="context">        # Verify enum values</span>
<span class="line-number">117</span><span class="context">        for enum_value in enum.values:</span>
<span class="line-number">118</span><span class="context">            if not enum_value.name or not enum_value.name.strip():</span>
<span class="line-number">119</span><span class="uncovered">                self.issues.append(</span>
<span class="line-number">120</span><span class="context">                    f&quot;Enum value name is empty in enum {enum_name} in {file_path}&quot;</span>
<span class="line-number">121</span><span class="context">                )</span>
<span class="line-number">122</span><span class="context">            elif not self._is_valid_identifier(enum_value.name):</span>
<span class="line-number">123</span><span class="context">                self.issues.append(</span>
<span class="line-number">124</span><span class="context">                    f&quot;Invalid enum value name &#x27;{enum_value.name}&#x27; in enum {enum_name} in {file_path}&quot;</span>
</pre>
<h4>Function: _verify_enum - Line 123</h4>
<pre>
<span class="line-number">118</span><span class="context">            if not enum_value.name or not enum_value.name.strip():</span>
<span class="line-number">119</span><span class="context">                self.issues.append(</span>
<span class="line-number">120</span><span class="context">                    f&quot;Enum value name is empty in enum {enum_name} in {file_path}&quot;</span>
<span class="line-number">121</span><span class="context">                )</span>
<span class="line-number">122</span><span class="context">            elif not self._is_valid_identifier(enum_value.name):</span>
<span class="line-number">123</span><span class="uncovered">                self.issues.append(</span>
<span class="line-number">124</span><span class="context">                    f&quot;Invalid enum value name &#x27;{enum_value.name}&#x27; in enum {enum_name} in {file_path}&quot;</span>
<span class="line-number">125</span><span class="context">                )</span>
<span class="line-number">126</span><span class="context"></span>
<span class="line-number">127</span><span class="context">    def _verify_union(self, file_path: str, union_name: str, union: Union) -&gt; None:</span>
<span class="line-number">128</span><span class="context">        &quot;&quot;&quot;Verify a union definition&quot;&quot;&quot;</span>
</pre>
<h4>Function: _verify_union - Line 130</h4>
<pre>
<span class="line-number">125</span><span class="context">                )</span>
<span class="line-number">126</span><span class="context"></span>
<span class="line-number">127</span><span class="context">    def _verify_union(self, file_path: str, union_name: str, union: Union) -&gt; None:</span>
<span class="line-number">128</span><span class="context">        &quot;&quot;&quot;Verify a union definition&quot;&quot;&quot;</span>
<span class="line-number">129</span><span class="context">        if not self._is_valid_identifier(union_name):</span>
<span class="line-number">130</span><span class="uncovered">            self.issues.append(f&quot;Invalid union name &#x27;{union_name}&#x27; in {file_path}&quot;)</span>
<span class="line-number">131</span><span class="context"></span>
<span class="line-number">132</span><span class="context">        if not union.name or not union.name.strip():</span>
<span class="line-number">133</span><span class="context">            self.issues.append(f&quot;Union name is empty in {file_path}&quot;)</span>
<span class="line-number">134</span><span class="context"></span>
<span class="line-number">135</span><span class="context">        # Verify fields</span>
</pre>
<h4>Function: _verify_union - Line 133</h4>
<pre>
<span class="line-number">128</span><span class="context">        &quot;&quot;&quot;Verify a union definition&quot;&quot;&quot;</span>
<span class="line-number">129</span><span class="context">        if not self._is_valid_identifier(union_name):</span>
<span class="line-number">130</span><span class="context">            self.issues.append(f&quot;Invalid union name &#x27;{union_name}&#x27; in {file_path}&quot;)</span>
<span class="line-number">131</span><span class="context"></span>
<span class="line-number">132</span><span class="context">        if not union.name or not union.name.strip():</span>
<span class="line-number">133</span><span class="uncovered">            self.issues.append(f&quot;Union name is empty in {file_path}&quot;)</span>
<span class="line-number">134</span><span class="context"></span>
<span class="line-number">135</span><span class="context">        # Verify fields</span>
<span class="line-number">136</span><span class="context">        for field in union.fields:</span>
<span class="line-number">137</span><span class="context">            self._verify_field(file_path, f&quot;union {union_name}&quot;, field)</span>
<span class="line-number">138</span><span class="context"></span>
</pre>
<h4>Function: _verify_function - Line 142</h4>
<pre>
<span class="line-number">137</span><span class="context">            self._verify_field(file_path, f&quot;union {union_name}&quot;, field)</span>
<span class="line-number">138</span><span class="context"></span>
<span class="line-number">139</span><span class="context">    def _verify_function(self, file_path: str, function: Function) -&gt; None:</span>
<span class="line-number">140</span><span class="context">        &quot;&quot;&quot;Verify a function definition&quot;&quot;&quot;</span>
<span class="line-number">141</span><span class="context">        if not function.name or not function.name.strip():</span>
<span class="line-number">142</span><span class="uncovered">            self.issues.append(f&quot;Function name is empty in {file_path}&quot;)</span>
<span class="line-number">143</span><span class="context">        elif not self._is_valid_identifier(function.name):</span>
<span class="line-number">144</span><span class="context">            self.issues.append(</span>
<span class="line-number">145</span><span class="context">                f&quot;Invalid function name &#x27;{function.name}&#x27; in {file_path}&quot;</span>
<span class="line-number">146</span><span class="context">            )</span>
<span class="line-number">147</span><span class="context"></span>
</pre>
<h4>Function: _verify_function - Line 144</h4>
<pre>
<span class="line-number">139</span><span class="context">    def _verify_function(self, file_path: str, function: Function) -&gt; None:</span>
<span class="line-number">140</span><span class="context">        &quot;&quot;&quot;Verify a function definition&quot;&quot;&quot;</span>
<span class="line-number">141</span><span class="context">        if not function.name or not function.name.strip():</span>
<span class="line-number">142</span><span class="context">            self.issues.append(f&quot;Function name is empty in {file_path}&quot;)</span>
<span class="line-number">143</span><span class="context">        elif not self._is_valid_identifier(function.name):</span>
<span class="line-number">144</span><span class="uncovered">            self.issues.append(</span>
<span class="line-number">145</span><span class="context">                f&quot;Invalid function name &#x27;{function.name}&#x27; in {file_path}&quot;</span>
<span class="line-number">146</span><span class="context">            )</span>
<span class="line-number">147</span><span class="context"></span>
<span class="line-number">148</span><span class="context">        if not function.return_type or not function.return_type.strip():</span>
<span class="line-number">149</span><span class="context">            self.issues.append(</span>
</pre>
<h4>Function: _verify_function - Line 149</h4>
<pre>
<span class="line-number">144</span><span class="context">            self.issues.append(</span>
<span class="line-number">145</span><span class="context">                f&quot;Invalid function name &#x27;{function.name}&#x27; in {file_path}&quot;</span>
<span class="line-number">146</span><span class="context">            )</span>
<span class="line-number">147</span><span class="context"></span>
<span class="line-number">148</span><span class="context">        if not function.return_type or not function.return_type.strip():</span>
<span class="line-number">149</span><span class="uncovered">            self.issues.append(</span>
<span class="line-number">150</span><span class="context">                f&quot;Function return type is empty for &#x27;{function.name}&#x27; in {file_path}&quot;</span>
<span class="line-number">151</span><span class="context">            )</span>
<span class="line-number">152</span><span class="context"></span>
<span class="line-number">153</span><span class="context">        # Verify parameters (skip variadic parameter &#x27;...&#x27;)</span>
<span class="line-number">154</span><span class="context">        for param in function.parameters:</span>
</pre>
<h4>Function: _verify_alias - Line 166</h4>
<pre>
<span class="line-number">161</span><span class="context">        self._verify_field(file_path, &quot;global&quot;, global_var)</span>
<span class="line-number">162</span><span class="context"></span>
<span class="line-number">163</span><span class="context">    def _verify_alias(self, file_path: str, alias_name: str, alias: Alias) -&gt; None:</span>
<span class="line-number">164</span><span class="context">        &quot;&quot;&quot;Verify a type alias (typedef)&quot;&quot;&quot;</span>
<span class="line-number">165</span><span class="context">        if not self._is_valid_identifier(alias_name):</span>
<span class="line-number">166</span><span class="uncovered">            self.issues.append(f&quot;Invalid alias name &#x27;{alias_name}&#x27; in {file_path}&quot;)</span>
<span class="line-number">167</span><span class="context"></span>
<span class="line-number">168</span><span class="context">        if not alias.name or not alias.name.strip():</span>
<span class="line-number">169</span><span class="context">            self.issues.append(f&quot;Alias name is empty in {file_path}&quot;)</span>
<span class="line-number">170</span><span class="context"></span>
<span class="line-number">171</span><span class="context">        if not alias.original_type or not alias.original_type.strip():</span>
</pre>
<h4>Function: _verify_alias - Line 169</h4>
<pre>
<span class="line-number">164</span><span class="context">        &quot;&quot;&quot;Verify a type alias (typedef)&quot;&quot;&quot;</span>
<span class="line-number">165</span><span class="context">        if not self._is_valid_identifier(alias_name):</span>
<span class="line-number">166</span><span class="context">            self.issues.append(f&quot;Invalid alias name &#x27;{alias_name}&#x27; in {file_path}&quot;)</span>
<span class="line-number">167</span><span class="context"></span>
<span class="line-number">168</span><span class="context">        if not alias.name or not alias.name.strip():</span>
<span class="line-number">169</span><span class="uncovered">            self.issues.append(f&quot;Alias name is empty in {file_path}&quot;)</span>
<span class="line-number">170</span><span class="context"></span>
<span class="line-number">171</span><span class="context">        if not alias.original_type or not alias.original_type.strip():</span>
<span class="line-number">172</span><span class="context">            self.issues.append(</span>
<span class="line-number">173</span><span class="context">                f&quot;Alias original type is empty for &#x27;{alias_name}&#x27; in {file_path}&quot;</span>
<span class="line-number">174</span><span class="context">            )</span>
</pre>
<h4>Function: _verify_alias - Line 172</h4>
<pre>
<span class="line-number">167</span><span class="context"></span>
<span class="line-number">168</span><span class="context">        if not alias.name or not alias.name.strip():</span>
<span class="line-number">169</span><span class="context">            self.issues.append(f&quot;Alias name is empty in {file_path}&quot;)</span>
<span class="line-number">170</span><span class="context"></span>
<span class="line-number">171</span><span class="context">        if not alias.original_type or not alias.original_type.strip():</span>
<span class="line-number">172</span><span class="uncovered">            self.issues.append(</span>
<span class="line-number">173</span><span class="context">                f&quot;Alias original type is empty for &#x27;{alias_name}&#x27; in {file_path}&quot;</span>
<span class="line-number">174</span><span class="context">            )</span>
<span class="line-number">175</span><span class="context"></span>
<span class="line-number">176</span><span class="context">    def _verify_field(self, file_path: str, context: str, field: Field) -&gt; None:</span>
<span class="line-number">177</span><span class="context">        &quot;&quot;&quot;Verify a field (struct field, function parameter, global variable)&quot;&quot;&quot;</span>
</pre>
<h4>Function: _verify_field - Line 180</h4>
<pre>
<span class="line-number">175</span><span class="context"></span>
<span class="line-number">176</span><span class="context">    def _verify_field(self, file_path: str, context: str, field: Field) -&gt; None:</span>
<span class="line-number">177</span><span class="context">        &quot;&quot;&quot;Verify a field (struct field, function parameter, global variable)&quot;&quot;&quot;</span>
<span class="line-number">178</span><span class="context">        # Check for invalid names</span>
<span class="line-number">179</span><span class="context">        if not field.name or not field.name.strip():</span>
<span class="line-number">180</span><span class="uncovered">            self.issues.append(f&quot;Field name is empty in {context} in {file_path}&quot;)</span>
<span class="line-number">181</span><span class="context">        elif not self._is_valid_identifier(field.name):</span>
<span class="line-number">182</span><span class="context">            self.issues.append(</span>
<span class="line-number">183</span><span class="context">                f&quot;Invalid field name &#x27;{field.name}&#x27; in {context} in {file_path}&quot;</span>
<span class="line-number">184</span><span class="context">            )</span>
<span class="line-number">185</span><span class="context"></span>
</pre>
<h4>Function: _verify_field - Line 188</h4>
<pre>
<span class="line-number">183</span><span class="context">                f&quot;Invalid field name &#x27;{field.name}&#x27; in {context} in {file_path}&quot;</span>
<span class="line-number">184</span><span class="context">            )</span>
<span class="line-number">185</span><span class="context"></span>
<span class="line-number">186</span><span class="context">        # Check for invalid types</span>
<span class="line-number">187</span><span class="context">        if not field.type or not field.type.strip():</span>
<span class="line-number">188</span><span class="uncovered">            self.issues.append(</span>
<span class="line-number">189</span><span class="context">                f&quot;Field type is empty for &#x27;{field.name}&#x27; in {context} in {file_path}&quot;</span>
<span class="line-number">190</span><span class="context">            )</span>
<span class="line-number">191</span><span class="context">        elif self._is_suspicious_type(field.type):</span>
<span class="line-number">192</span><span class="context">            self.issues.append(</span>
<span class="line-number">193</span><span class="context">                f&quot;Suspicious field type &#x27;{field.type}&#x27; for &#x27;{field.name}&#x27; in {context} in {file_path}&quot;</span>
</pre>
<h4>Function: _is_suspicious_type - Line 213</h4>
<pre>
<span class="line-number">208</span><span class="context">        return bool(re.match(r&quot;^[a-zA-Z_][a-zA-Z0-9_]*$&quot;, name.strip()))</span>
<span class="line-number">209</span><span class="context"></span>
<span class="line-number">210</span><span class="context">    def _is_suspicious_type(self, type_str: str) -&gt; bool:</span>
<span class="line-number">211</span><span class="context">        &quot;&quot;&quot;Check if a type string looks suspicious&quot;&quot;&quot;</span>
<span class="line-number">212</span><span class="context">        if not type_str or not type_str.strip():</span>
<span class="line-number">213</span><span class="uncovered">            return True</span>
<span class="line-number">214</span><span class="context"></span>
<span class="line-number">215</span><span class="context">        type_str = type_str.strip()</span>
<span class="line-number">216</span><span class="context"></span>
<span class="line-number">217</span><span class="context">        # Check for obvious parsing errors</span>
<span class="line-number">218</span><span class="context">        suspicious_patterns = [</span>
</pre>
<h4>Function: _is_suspicious_type - Line 227</h4>
<pre>
<span class="line-number">222</span><span class="context">            r&quot;^[\[\]\{\}\(\)\s\\\n]*[\[\]\{\}\(\)\s\\\n]*[\[\]\{\}\(\)\s\\\n]*$&quot;,  # Excessive brackets/whitespace</span>
<span class="line-number">223</span><span class="context">        ]</span>
<span class="line-number">224</span><span class="context"></span>
<span class="line-number">225</span><span class="context">        for pattern in suspicious_patterns:</span>
<span class="line-number">226</span><span class="context">            if re.match(pattern, type_str):</span>
<span class="line-number">227</span><span class="uncovered">                return True</span>
<span class="line-number">228</span><span class="context"></span>
<span class="line-number">229</span><span class="context">        # Check for unbalanced brackets</span>
<span class="line-number">230</span><span class="context">        if self._has_unbalanced_brackets(type_str):</span>
<span class="line-number">231</span><span class="context">            return True</span>
<span class="line-number">232</span><span class="context"></span>
</pre>
<h4>Function: _is_suspicious_type - Line 235</h4>
<pre>
<span class="line-number">230</span><span class="context">        if self._has_unbalanced_brackets(type_str):</span>
<span class="line-number">231</span><span class="context">            return True</span>
<span class="line-number">232</span><span class="context"></span>
<span class="line-number">233</span><span class="context">        # Check for excessive newlines or backslashes</span>
<span class="line-number">234</span><span class="context">        if type_str.count(&quot;\n&quot;) &gt; 5 or type_str.count(&quot;\\&quot;) &gt; 10:</span>
<span class="line-number">235</span><span class="uncovered">            return True</span>
<span class="line-number">236</span><span class="context"></span>
<span class="line-number">237</span><span class="context">        return False</span>
<span class="line-number">238</span><span class="context"></span>
<span class="line-number">239</span><span class="context">    def _is_suspicious_value(self, value: str) -&gt; bool:</span>
<span class="line-number">240</span><span class="context">        &quot;&quot;&quot;Check if a value string looks suspicious&quot;&quot;&quot;</span>
</pre>
<h4>Function: _is_suspicious_value - Line 242</h4>
<pre>
<span class="line-number">237</span><span class="context">        return False</span>
<span class="line-number">238</span><span class="context"></span>
<span class="line-number">239</span><span class="context">    def _is_suspicious_value(self, value: str) -&gt; bool:</span>
<span class="line-number">240</span><span class="context">        &quot;&quot;&quot;Check if a value string looks suspicious&quot;&quot;&quot;</span>
<span class="line-number">241</span><span class="context">        if not value or not value.strip():</span>
<span class="line-number">242</span><span class="uncovered">            return True</span>
<span class="line-number">243</span><span class="context"></span>
<span class="line-number">244</span><span class="context">        value = value.strip()</span>
<span class="line-number">245</span><span class="context"></span>
<span class="line-number">246</span><span class="context">        # Check for obvious parsing errors</span>
<span class="line-number">247</span><span class="context">        suspicious_patterns = [</span>
</pre>
<h4>Function: _is_suspicious_value - Line 254</h4>
<pre>
<span class="line-number">249</span><span class="context">            r&quot;^[\[\]\{\}\(\)\s\\\n]*[\[\]\{\}\(\)\s\\\n]+$&quot;,  # Mostly brackets and whitespace</span>
<span class="line-number">250</span><span class="context">        ]</span>
<span class="line-number">251</span><span class="context"></span>
<span class="line-number">252</span><span class="context">        for pattern in suspicious_patterns:</span>
<span class="line-number">253</span><span class="context">            if re.match(pattern, value):</span>
<span class="line-number">254</span><span class="uncovered">                return True</span>
<span class="line-number">255</span><span class="context"></span>
<span class="line-number">256</span><span class="context">        # Check for unbalanced brackets</span>
<span class="line-number">257</span><span class="context">        if self._has_unbalanced_brackets(value):</span>
<span class="line-number">258</span><span class="context">            return True</span>
<span class="line-number">259</span><span class="context"></span>
</pre>
<h4>Function: _is_suspicious_value - Line 262</h4>
<pre>
<span class="line-number">257</span><span class="context">        if self._has_unbalanced_brackets(value):</span>
<span class="line-number">258</span><span class="context">            return True</span>
<span class="line-number">259</span><span class="context"></span>
<span class="line-number">260</span><span class="context">        # Check for excessive newlines or backslashes</span>
<span class="line-number">261</span><span class="context">        if value.count(&quot;\n&quot;) &gt; 3 or value.count(&quot;\\&quot;) &gt; 5:</span>
<span class="line-number">262</span><span class="uncovered">            return True</span>
<span class="line-number">263</span><span class="context"></span>
<span class="line-number">264</span><span class="context">        return False</span>
<span class="line-number">265</span><span class="context"></span>
<span class="line-number">266</span><span class="context">    def _has_unbalanced_brackets(self, text: str) -&gt; bool:</span>
<span class="line-number">267</span><span class="context">        &quot;&quot;&quot;Check if text has unbalanced brackets&quot;&quot;&quot;</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/generator.py - 85.91% coverage (250/291 lines)
</div>
<h4>Function: find_file_key - Line 79</h4>
<pre>
<span class="line-number"> 74</span><span class="context">                return file_name</span>
<span class="line-number"> 75</span><span class="context"></span>
<span class="line-number"> 76</span><span class="context">            # Try matching by filename</span>
<span class="line-number"> 77</span><span class="context">            filename = Path(file_name).name</span>
<span class="line-number"> 78</span><span class="context">            if filename in project_model.files:</span>
<span class="line-number"> 79</span><span class="uncovered">                return filename</span>
<span class="line-number"> 80</span><span class="context"></span>
<span class="line-number"> 81</span><span class="context">            # Try matching by relative path</span>
<span class="line-number"> 82</span><span class="context">            for key in project_model.files.keys():</span>
<span class="line-number"> 83</span><span class="context">                if Path(key).name == filename:</span>
<span class="line-number"> 84</span><span class="context">                    return key</span>
</pre>
<h4>Function: add_file_to_tree - Line 91</h4>
<pre>
<span class="line-number"> 86</span><span class="context">            # If not found, return the filename (will be handled gracefully)</span>
<span class="line-number"> 87</span><span class="context">            return filename</span>
<span class="line-number"> 88</span><span class="context"></span>
<span class="line-number"> 89</span><span class="context">        def add_file_to_tree(file_name: str, depth: int):</span>
<span class="line-number"> 90</span><span class="context">            if depth &gt; include_depth or file_name in visited:</span>
<span class="line-number"> 91</span><span class="uncovered">                return</span>
<span class="line-number"> 92</span><span class="context"></span>
<span class="line-number"> 93</span><span class="context">            visited.add(file_name)</span>
<span class="line-number"> 94</span><span class="context">            file_key = find_file_key(file_name)</span>
<span class="line-number"> 95</span><span class="context"></span>
<span class="line-number"> 96</span><span class="context">            if file_key in project_model.files:</span>
</pre>
<h4>Function: _generate_c_file_class - Line 152</h4>
<pre>
<span class="line-number">147</span><span class="context">        # Find the UML ID for this file using filename</span>
<span class="line-number">148</span><span class="context">        filename = Path(file_model.relative_path).name</span>
<span class="line-number">149</span><span class="context">        uml_id = uml_ids.get(filename)</span>
<span class="line-number">150</span><span class="context"></span>
<span class="line-number">151</span><span class="context">        if not uml_id:</span>
<span class="line-number">152</span><span class="uncovered">            return  # Skip if no UML ID found</span>
<span class="line-number">153</span><span class="context"></span>
<span class="line-number">154</span><span class="context">        lines.append(f&#x27;class &quot;{basename}&quot; as {uml_id} &lt;&lt;source&gt;&gt; #LightBlue&#x27;)</span>
<span class="line-number">155</span><span class="context">        lines.append(&quot;{&quot;)</span>
<span class="line-number">156</span><span class="context"></span>
<span class="line-number">157</span><span class="context">        # Add macros</span>
</pre>
<h4>Function: _generate_c_file_class - Lines 163-165</h4>
<pre>
<span class="line-number">158</span><span class="context">        if file_model.macros:</span>
<span class="line-number">159</span><span class="context">            lines.append(&quot;    -- Macros --&quot;)</span>
<span class="line-number">160</span><span class="context">            for macro in sorted(file_model.macros):</span>
<span class="line-number">161</span><span class="context">                if &quot;(&quot; in macro and &quot;)&quot; in macro:</span>
<span class="line-number">162</span><span class="context">                    # Function-like macro</span>
<span class="line-number">163</span><span class="uncovered">                    macro_name = macro.split(&quot;(&quot;)[0].replace(&quot;#define &quot;, &quot;&quot;)</span>
<span class="line-number">164</span><span class="uncovered">                    params = macro.split(&quot;(&quot;)[1].split(&quot;)&quot;)[0]</span>
<span class="line-number">165</span><span class="uncovered">                    lines.append(f&quot;    - #define {macro_name}({params})&quot;)</span>
<span class="line-number">166</span><span class="context">                else:</span>
<span class="line-number">167</span><span class="context">                    # Simple macro</span>
<span class="line-number">168</span><span class="context">                    macro_name = macro.replace(&quot;#define &quot;, &quot;&quot;)</span>
<span class="line-number">169</span><span class="context">                    lines.append(f&quot;    - #define {macro_name}&quot;)</span>
<span class="line-number">170</span><span class="context"></span>
</pre>
<h4>Function: _generate_c_file_class - Line 185</h4>
<pre>
<span class="line-number">180</span><span class="context">            for func in sorted(file_model.functions, key=lambda x: x.name):</span>
<span class="line-number">181</span><span class="context">                if not func.is_declaration:  # Only implementation, not declarations</span>
<span class="line-number">182</span><span class="context">                    params = []</span>
<span class="line-number">183</span><span class="context">                    for p in func.parameters:</span>
<span class="line-number">184</span><span class="context">                        if p.name == &quot;...&quot; and p.type == &quot;...&quot;:</span>
<span class="line-number">185</span><span class="uncovered">                            params.append(&quot;...&quot;)</span>
<span class="line-number">186</span><span class="context">                        else:</span>
<span class="line-number">187</span><span class="context">                            params.append(f&quot;{p.type} {p.name}&quot;)</span>
<span class="line-number">188</span><span class="context">                    param_str = &quot;, &quot;.join(params)</span>
<span class="line-number">189</span><span class="context">                    lines.append(f&quot;    {func.return_type} {func.name}({param_str})&quot;)</span>
<span class="line-number">190</span><span class="context"></span>
</pre>
<h4>Function: _generate_header_class - Line 205</h4>
<pre>
<span class="line-number">200</span><span class="context">        # Find the UML ID for this file using filename</span>
<span class="line-number">201</span><span class="context">        filename = Path(file_model.relative_path).name</span>
<span class="line-number">202</span><span class="context">        uml_id = uml_ids.get(filename)</span>
<span class="line-number">203</span><span class="context"></span>
<span class="line-number">204</span><span class="context">        if not uml_id:</span>
<span class="line-number">205</span><span class="uncovered">            return  # Skip if no UML ID found</span>
<span class="line-number">206</span><span class="context"></span>
<span class="line-number">207</span><span class="context">        lines.append(f&#x27;class &quot;{basename}&quot; as {uml_id} &lt;&lt;header&gt;&gt; #LightGreen&#x27;)</span>
<span class="line-number">208</span><span class="context">        lines.append(&quot;{&quot;)</span>
<span class="line-number">209</span><span class="context"></span>
<span class="line-number">210</span><span class="context">        # Add macros</span>
</pre>
<h4>Function: _generate_header_class - Lines 216-218</h4>
<pre>
<span class="line-number">211</span><span class="context">        if file_model.macros:</span>
<span class="line-number">212</span><span class="context">            lines.append(&quot;    -- Macros --&quot;)</span>
<span class="line-number">213</span><span class="context">            for macro in sorted(file_model.macros):</span>
<span class="line-number">214</span><span class="context">                if &quot;(&quot; in macro and &quot;)&quot; in macro:</span>
<span class="line-number">215</span><span class="context">                    # Function-like macro</span>
<span class="line-number">216</span><span class="uncovered">                    macro_name = macro.split(&quot;(&quot;)[0].replace(&quot;#define &quot;, &quot;&quot;)</span>
<span class="line-number">217</span><span class="uncovered">                    params = macro.split(&quot;(&quot;)[1].split(&quot;)&quot;)[0]</span>
<span class="line-number">218</span><span class="uncovered">                    lines.append(f&quot;    + #define {macro_name}({params})&quot;)</span>
<span class="line-number">219</span><span class="context">                else:</span>
<span class="line-number">220</span><span class="context">                    # Simple macro</span>
<span class="line-number">221</span><span class="context">                    macro_name = macro.replace(&quot;#define &quot;, &quot;&quot;)</span>
<span class="line-number">222</span><span class="context">                    lines.append(f&quot;    + #define {macro_name}&quot;)</span>
<span class="line-number">223</span><span class="context"></span>
</pre>
<h4>Function: _generate_typedef_classes - Line 274</h4>
<pre>
<span class="line-number">269</span><span class="context">                    f&#x27;class &quot;{enum_name}&quot; as {uml_id} &lt;&lt;typedef&gt;&gt; #LightYellow&#x27;</span>
<span class="line-number">270</span><span class="context">                )</span>
<span class="line-number">271</span><span class="context">                lines.append(&quot;{&quot;)</span>
<span class="line-number">272</span><span class="context">                for value in sorted(enum_data.values, key=lambda x: x.name):</span>
<span class="line-number">273</span><span class="context">                    if value.value:</span>
<span class="line-number">274</span><span class="uncovered">                        lines.append(f&quot;    + {value.name} = {value.value}&quot;)</span>
<span class="line-number">275</span><span class="context">                    else:</span>
<span class="line-number">276</span><span class="context">                        lines.append(f&quot;    + {value.name}&quot;)</span>
<span class="line-number">277</span><span class="context">                lines.append(&quot;}&quot;)</span>
<span class="line-number">278</span><span class="context">                lines.append(&quot;&quot;)</span>
<span class="line-number">279</span><span class="context"></span>
</pre>
<h4>Function: _generate_typedef_classes - Line 298</h4>
<pre>
<span class="line-number">293</span><span class="context">                for i, line in enumerate(alias_lines):</span>
<span class="line-number">294</span><span class="context">                    line = line.strip()</span>
<span class="line-number">295</span><span class="context"></span>
<span class="line-number">296</span><span class="context">                    if i == 0:</span>
<span class="line-number">297</span><span class="context">                        lines.append(f&quot;    + {line}&quot;)</span>
<span class="line-number">298</span><span class="uncovered">                    elif line.startswith(&quot;struct {&quot;):</span>
<span class="line-number">299</span><span class="context">                        # Start collecting nested struct content</span>
<span class="line-number">300</span><span class="context">                        inside_struct = True</span>
<span class="line-number">301</span><span class="context">                        nested_content = []</span>
<span class="line-number">302</span><span class="context">                    elif line == &quot;}&quot;:</span>
<span class="line-number">303</span><span class="context">                        if inside_struct:</span>
</pre>
<h4>Function: _generate_typedef_classes - Lines 300-303</h4>
<pre>
<span class="line-number">295</span><span class="context"></span>
<span class="line-number">296</span><span class="context">                    if i == 0:</span>
<span class="line-number">297</span><span class="context">                        lines.append(f&quot;    + {line}&quot;)</span>
<span class="line-number">298</span><span class="context">                    elif line.startswith(&quot;struct {&quot;):</span>
<span class="line-number">299</span><span class="context">                        # Start collecting nested struct content</span>
<span class="line-number">300</span><span class="uncovered">                        inside_struct = True</span>
<span class="line-number">301</span><span class="uncovered">                        nested_content = []</span>
<span class="line-number">302</span><span class="uncovered">                    elif line == &quot;}&quot;:</span>
<span class="line-number">303</span><span class="uncovered">                        if inside_struct:</span>
<span class="line-number">304</span><span class="context">                            # Close nested struct with flattened content</span>
<span class="line-number">305</span><span class="context">                            if nested_content:</span>
<span class="line-number">306</span><span class="context">                                content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">307</span><span class="context">                                lines.append(f&quot;    + struct {{ {content_str} }}&quot;)</span>
<span class="line-number">308</span><span class="context">                            else:</span>
</pre>
<h4>Function: _generate_typedef_classes - Lines 305-307</h4>
<pre>
<span class="line-number">300</span><span class="context">                        inside_struct = True</span>
<span class="line-number">301</span><span class="context">                        nested_content = []</span>
<span class="line-number">302</span><span class="context">                    elif line == &quot;}&quot;:</span>
<span class="line-number">303</span><span class="context">                        if inside_struct:</span>
<span class="line-number">304</span><span class="context">                            # Close nested struct with flattened content</span>
<span class="line-number">305</span><span class="uncovered">                            if nested_content:</span>
<span class="line-number">306</span><span class="uncovered">                                content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">307</span><span class="uncovered">                                lines.append(f&quot;    + struct {{ {content_str} }}&quot;)</span>
<span class="line-number">308</span><span class="context">                            else:</span>
<span class="line-number">309</span><span class="context">                                lines.append(f&quot;    + struct {{ }}&quot;)</span>
<span class="line-number">310</span><span class="context">                            inside_struct = False</span>
<span class="line-number">311</span><span class="context">                            nested_content = []</span>
<span class="line-number">312</span><span class="context">                        else:</span>
</pre>
<h4>Function: _generate_typedef_classes - Lines 309-311</h4>
<pre>
<span class="line-number">304</span><span class="context">                            # Close nested struct with flattened content</span>
<span class="line-number">305</span><span class="context">                            if nested_content:</span>
<span class="line-number">306</span><span class="context">                                content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">307</span><span class="context">                                lines.append(f&quot;    + struct {{ {content_str} }}&quot;)</span>
<span class="line-number">308</span><span class="context">                            else:</span>
<span class="line-number">309</span><span class="uncovered">                                lines.append(f&quot;    + struct {{ }}&quot;)</span>
<span class="line-number">310</span><span class="uncovered">                            inside_struct = False</span>
<span class="line-number">311</span><span class="uncovered">                            nested_content = []</span>
<span class="line-number">312</span><span class="context">                        else:</span>
<span class="line-number">313</span><span class="context">                            lines.append(f&quot;    }}&quot;)</span>
<span class="line-number">314</span><span class="context">                    elif line and line != &quot;}&quot;:</span>
<span class="line-number">315</span><span class="context">                        if inside_struct:</span>
<span class="line-number">316</span><span class="context">                            nested_content.append(line)  # Collect nested content</span>
</pre>
<h4>Function: _generate_typedef_classes - Lines 313-316</h4>
<pre>
<span class="line-number">308</span><span class="context">                            else:</span>
<span class="line-number">309</span><span class="context">                                lines.append(f&quot;    + struct {{ }}&quot;)</span>
<span class="line-number">310</span><span class="context">                            inside_struct = False</span>
<span class="line-number">311</span><span class="context">                            nested_content = []</span>
<span class="line-number">312</span><span class="context">                        else:</span>
<span class="line-number">313</span><span class="uncovered">                            lines.append(f&quot;    }}&quot;)</span>
<span class="line-number">314</span><span class="uncovered">                    elif line and line != &quot;}&quot;:</span>
<span class="line-number">315</span><span class="uncovered">                        if inside_struct:</span>
<span class="line-number">316</span><span class="uncovered">                            nested_content.append(line)  # Collect nested content</span>
<span class="line-number">317</span><span class="context">                        else:</span>
<span class="line-number">318</span><span class="context">                            lines.append(f&quot;+ {line}&quot;)</span>
<span class="line-number">319</span><span class="context"></span>
<span class="line-number">320</span><span class="context">                # If we were inside a struct but didn&#x27;t find a closing brace, add one</span>
<span class="line-number">321</span><span class="context">                if inside_struct and nested_content:</span>
</pre>
<h4>Function: _generate_typedef_classes - Line 318</h4>
<pre>
<span class="line-number">313</span><span class="context">                            lines.append(f&quot;    }}&quot;)</span>
<span class="line-number">314</span><span class="context">                    elif line and line != &quot;}&quot;:</span>
<span class="line-number">315</span><span class="context">                        if inside_struct:</span>
<span class="line-number">316</span><span class="context">                            nested_content.append(line)  # Collect nested content</span>
<span class="line-number">317</span><span class="context">                        else:</span>
<span class="line-number">318</span><span class="uncovered">                            lines.append(f&quot;+ {line}&quot;)</span>
<span class="line-number">319</span><span class="context"></span>
<span class="line-number">320</span><span class="context">                # If we were inside a struct but didn&#x27;t find a closing brace, add one</span>
<span class="line-number">321</span><span class="context">                if inside_struct and nested_content:</span>
<span class="line-number">322</span><span class="context">                    content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">323</span><span class="context">                    lines.append(f&quot;    + struct {{ {content_str} }}&quot;)</span>
</pre>
<h4>Function: _generate_typedef_classes - Lines 322-323</h4>
<pre>
<span class="line-number">317</span><span class="context">                        else:</span>
<span class="line-number">318</span><span class="context">                            lines.append(f&quot;+ {line}&quot;)</span>
<span class="line-number">319</span><span class="context"></span>
<span class="line-number">320</span><span class="context">                # If we were inside a struct but didn&#x27;t find a closing brace, add one</span>
<span class="line-number">321</span><span class="context">                if inside_struct and nested_content:</span>
<span class="line-number">322</span><span class="uncovered">                    content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">323</span><span class="uncovered">                    lines.append(f&quot;    + struct {{ {content_str} }}&quot;)</span>
<span class="line-number">324</span><span class="context">                lines.append(&quot;}&quot;)</span>
<span class="line-number">325</span><span class="context">                lines.append(&quot;&quot;)</span>
<span class="line-number">326</span><span class="context"></span>
<span class="line-number">327</span><span class="context">        # Unions</span>
<span class="line-number">328</span><span class="context">        for union_name, union_data in sorted(file_model.unions.items()):</span>
</pre>
<h4>Function: _generate_field_with_nested_structs - Line 347</h4>
<pre>
<span class="line-number">342</span><span class="context">        field_text = f&quot;{field.type} {field.name}&quot;</span>
<span class="line-number">343</span><span class="context"></span>
<span class="line-number">344</span><span class="context">        # Check if this is a nested struct field</span>
<span class="line-number">345</span><span class="context">        if field.type.startswith(&quot;struct {&quot;) and &#x27;\n&#x27; in field.type:</span>
<span class="line-number">346</span><span class="context">            # Parse the nested struct content and flatten it</span>
<span class="line-number">347</span><span class="uncovered">            struct_parts = field.type.split(&#x27;\n&#x27;)</span>
<span class="line-number">348</span><span class="context"></span>
<span class="line-number">349</span><span class="context">            # For nested structs, flatten them to avoid PlantUML parsing issues</span>
<span class="line-number">350</span><span class="context">            # Format as: + struct { field_type field_name }</span>
<span class="line-number">351</span><span class="context">            nested_content = []</span>
<span class="line-number">352</span><span class="context">            for part in struct_parts[1:]:</span>
</pre>
<h4>Function: _generate_field_with_nested_structs - Lines 351-355</h4>
<pre>
<span class="line-number">346</span><span class="context">            # Parse the nested struct content and flatten it</span>
<span class="line-number">347</span><span class="context">            struct_parts = field.type.split(&#x27;\n&#x27;)</span>
<span class="line-number">348</span><span class="context"></span>
<span class="line-number">349</span><span class="context">            # For nested structs, flatten them to avoid PlantUML parsing issues</span>
<span class="line-number">350</span><span class="context">            # Format as: + struct { field_type field_name }</span>
<span class="line-number">351</span><span class="uncovered">            nested_content = []</span>
<span class="line-number">352</span><span class="uncovered">            for part in struct_parts[1:]:</span>
<span class="line-number">353</span><span class="uncovered">                part = part.strip()</span>
<span class="line-number">354</span><span class="uncovered">                if part and part != &quot;}&quot;:</span>
<span class="line-number">355</span><span class="uncovered">                    nested_content.append(part)</span>
<span class="line-number">356</span><span class="context"></span>
<span class="line-number">357</span><span class="context">            if nested_content:</span>
<span class="line-number">358</span><span class="context">                # Create a flattened representation</span>
<span class="line-number">359</span><span class="context">                content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">360</span><span class="context">                lines.append(f&quot;{base_indent}+ struct {{ {content_str} }} {field.name}&quot;)</span>
</pre>
<h4>Function: _generate_field_with_nested_structs - Line 357</h4>
<pre>
<span class="line-number">352</span><span class="context">            for part in struct_parts[1:]:</span>
<span class="line-number">353</span><span class="context">                part = part.strip()</span>
<span class="line-number">354</span><span class="context">                if part and part != &quot;}&quot;:</span>
<span class="line-number">355</span><span class="context">                    nested_content.append(part)</span>
<span class="line-number">356</span><span class="context"></span>
<span class="line-number">357</span><span class="uncovered">            if nested_content:</span>
<span class="line-number">358</span><span class="context">                # Create a flattened representation</span>
<span class="line-number">359</span><span class="context">                content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">360</span><span class="context">                lines.append(f&quot;{base_indent}+ struct {{ {content_str} }} {field.name}&quot;)</span>
<span class="line-number">361</span><span class="context">            else:</span>
<span class="line-number">362</span><span class="context">                lines.append(f&quot;{base_indent}+ struct {{ }} {field.name}&quot;)</span>
</pre>
<h4>Function: _generate_field_with_nested_structs - Lines 359-360</h4>
<pre>
<span class="line-number">354</span><span class="context">                if part and part != &quot;}&quot;:</span>
<span class="line-number">355</span><span class="context">                    nested_content.append(part)</span>
<span class="line-number">356</span><span class="context"></span>
<span class="line-number">357</span><span class="context">            if nested_content:</span>
<span class="line-number">358</span><span class="context">                # Create a flattened representation</span>
<span class="line-number">359</span><span class="uncovered">                content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">360</span><span class="uncovered">                lines.append(f&quot;{base_indent}+ struct {{ {content_str} }} {field.name}&quot;)</span>
<span class="line-number">361</span><span class="context">            else:</span>
<span class="line-number">362</span><span class="context">                lines.append(f&quot;{base_indent}+ struct {{ }} {field.name}&quot;)</span>
<span class="line-number">363</span><span class="context">        else:</span>
<span class="line-number">364</span><span class="context">            # Handle regular multi-line field types</span>
<span class="line-number">365</span><span class="context">            field_lines = field_text.split(&#x27;\n&#x27;)</span>
</pre>
<h4>Function: _generate_field_with_nested_structs - Line 362</h4>
<pre>
<span class="line-number">357</span><span class="context">            if nested_content:</span>
<span class="line-number">358</span><span class="context">                # Create a flattened representation</span>
<span class="line-number">359</span><span class="context">                content_str = &quot;; &quot;.join(nested_content)</span>
<span class="line-number">360</span><span class="context">                lines.append(f&quot;{base_indent}+ struct {{ {content_str} }} {field.name}&quot;)</span>
<span class="line-number">361</span><span class="context">            else:</span>
<span class="line-number">362</span><span class="uncovered">                lines.append(f&quot;{base_indent}+ struct {{ }} {field.name}&quot;)</span>
<span class="line-number">363</span><span class="context">        else:</span>
<span class="line-number">364</span><span class="context">            # Handle regular multi-line field types</span>
<span class="line-number">365</span><span class="context">            field_lines = field_text.split(&#x27;\n&#x27;)</span>
<span class="line-number">366</span><span class="context">            for i, line in enumerate(field_lines):</span>
<span class="line-number">367</span><span class="context">                if i == 0:</span>
</pre>
<h4>Function: _generate_field_with_nested_structs - Line 370</h4>
<pre>
<span class="line-number">365</span><span class="context">            field_lines = field_text.split(&#x27;\n&#x27;)</span>
<span class="line-number">366</span><span class="context">            for i, line in enumerate(field_lines):</span>
<span class="line-number">367</span><span class="context">                if i == 0:</span>
<span class="line-number">368</span><span class="context">                    lines.append(f&quot;{base_indent}+ {line}&quot;)</span>
<span class="line-number">369</span><span class="context">                else:</span>
<span class="line-number">370</span><span class="uncovered">                    lines.append(f&quot;+ {line}&quot;)</span>
<span class="line-number">371</span><span class="context"></span>
<span class="line-number">372</span><span class="context">    def _generate_relationships(</span>
<span class="line-number">373</span><span class="context">        self,</span>
<span class="line-number">374</span><span class="context">        lines: List[str],</span>
<span class="line-number">375</span><span class="context">        include_tree: Dict[str, FileModel],</span>
</pre>
</div>

    <div class="footer">
        <p>Generated by Test Report System</p>
    </div>
</body>
</html>