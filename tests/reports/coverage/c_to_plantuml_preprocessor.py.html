<!DOCTYPE html>
<html>
<head>
    <title>Coverage Report: c_to_plantuml/preprocessor.py</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 24px;
        }
        .stats {
            display: flex;
            gap: 30px;
            margin-top: 20px;
        }
        .stat {
            display: flex;
            flex-direction: column;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .coverage-bar {
            width: 200px;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }
        .coverage-fill {
            height: 100%;
            background: #ff9800;
            transition: width 0.3s ease;
        }
        .code-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .code-header {
            background: #333;
            color: white;
            padding: 10px 20px;
            font-size: 14px;
        }
        .code-lines {
            display: table;
            width: 100%;
        }
        .code-line {
            display: table-row;
            transition: background-color 0.2s;
        }
        .code-line:hover {
            background-color: #f0f0f0;
        }
        .line-number {
            display: table-cell;
            width: 50px;
            padding: 0 10px;
            text-align: right;
            background: #f8f8f8;
            color: #999;
            border-right: 1px solid #e0e0e0;
            user-select: none;
            font-size: 12px;
            vertical-align: top;
        }
        .line-status {
            display: table-cell;
            width: 30px;
            text-align: center;
            font-size: 14px;
            vertical-align: top;
            padding: 0 5px;
        }
        .line-content {
            display: table-cell;
            padding: 0 20px;
            white-space: pre;
            font-size: 14px;
            vertical-align: top;
        }
        .covered {
            background-color: #e8f5e9;
        }
        .covered .line-status {
            color: #4caf50;
        }
        .missing {
            background-color: #ffebee;
        }
        .missing .line-status {
            color: #f44336;
        }
        .excluded {
            background-color: #f5f5f5;
            color: #999;
        }
        .excluded .line-status {
            color: #999;
        }
        .legend {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .legend-item {
            display: inline-block;
            margin-right: 20px;
        }
        .legend-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            vertical-align: middle;
            margin-right: 5px;
            border-radius: 3px;
        }
        .timestamp {
            color: #666;
            font-size: 12px;
        }
        /* Syntax highlighting */
        .keyword { color: #0000ff; font-weight: bold; }
        .string { color: #008000; }
        .comment { color: #808080; font-style: italic; }
        .number { color: #098658; }
        .function { color: #795E26; }
        .class { color: #267F99; font-weight: bold; }
        .back-link {
            margin-bottom: 20px;
        }
        .back-link a {
            color: #0066cc;
            text-decoration: none;
        }
        .back-link a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="back-link">
        <a href="index.html">‚Üê Back to Coverage Index</a>
    </div>

    <div class="header">
        <h1>Coverage Report: c_to_plantuml/preprocessor.py</h1>
        <div class="timestamp">Generated: 2025-07-27 09:47:27</div>

        <div class="stats">
            <div class="stat">
                <span class="stat-label">Coverage</span>
                <span class="stat-value">68.9%</span>
                <div class="coverage-bar">
                    <div class="coverage-fill" style="width: 68.89632107023411%"></div>
                </div>
            </div>
            <div class="stat">
                <span class="stat-label">Statements</span>
                <span class="stat-value">299</span>
            </div>
            <div class="stat">
                <span class="stat-label">Covered</span>
                <span class="stat-value" style="color: #4caf50">206</span>
            </div>
            <div class="stat">
                <span class="stat-label">Missing</span>
                <span class="stat-value" style="color: #f44336">93</span>
            </div>
            <div class="stat">
                <span class="stat-label">Excluded</span>
                <span class="stat-value" style="color: #999">0</span>
            </div>
        </div>
    </div>

    <div class="code-container">
        <div class="code-header">Source Code</div>
        <div class="code-lines">
            <div class="code-line ">
                <div class="line-number">1</div>
                <div class="line-status"></div>
                <div class="line-content">#!/usr/bin/env python3</div>
            </div>
            <div class="code-line ">
                <div class="line-number">2</div>
                <div class="line-status"></div>
                <div class="line-content">&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">3</div>
                <div class="line-status"></div>
                <div class="line-content">Preprocessor module for C to PlantUML converter.</div>
            </div>
            <div class="code-line ">
                <div class="line-number">4</div>
                <div class="line-status"></div>
                <div class="line-content">Handles #if, #elif, #else, #endif directives and conditional compilation.</div>
            </div>
            <div class="code-line ">
                <div class="line-number">5</div>
                <div class="line-status"></div>
                <div class="line-content">&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">6</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">7</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">import logging</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">8</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">import re</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">9</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">from dataclasses import dataclass</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">10</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">from enum import Enum</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">11</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">from typing import Dict, List, Optional, Set, Tuple</div>
            </div>
            <div class="code-line ">
                <div class="line-number">12</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">13</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">from c_to_plantuml.parser_tokenizer import Token, TokenType</div>
            </div>
            <div class="code-line ">
                <div class="line-number">14</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">15</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">16</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">class PreprocessorDirective(Enum):</div>
            </div>
            <div class="code-line ">
                <div class="line-number">17</div>
                <div class="line-status"></div>
                <div class="line-content">    &quot;&quot;&quot;Types of preprocessor directives.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">18</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">19</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    IF = &quot;if&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">20</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    ELIF = &quot;elif&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">21</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    ELSE = &quot;else&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">22</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    ENDIF = &quot;endif&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">23</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    IFDEF = &quot;ifdef&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">24</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    IFNDEF = &quot;ifndef&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">25</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    DEFINE = &quot;define&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">26</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    UNDEF = &quot;undef&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">27</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">28</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">29</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">@dataclass</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">30</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">class PreprocessorBlock:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">31</div>
                <div class="line-status"></div>
                <div class="line-content">    &quot;&quot;&quot;Represents a preprocessor conditional block.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">32</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">33</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    directive: PreprocessorDirective</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">34</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    condition: str</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">35</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    start_token: int</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">36</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    end_token: int</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">37</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    is_active: bool</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">38</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    children: List[&quot;PreprocessorBlock&quot;]</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">39</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    parent: Optional[&quot;PreprocessorBlock&quot;] = None</div>
            </div>
            <div class="code-line ">
                <div class="line-number">40</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">41</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">42</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">class PreprocessorEvaluator:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">43</div>
                <div class="line-status"></div>
                <div class="line-content">    &quot;&quot;&quot;Evaluates preprocessor conditions and manages conditional compilation.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">44</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">45</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def __init__(self):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">46</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.logger = logging.getLogger(__name__)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">47</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.defined_macros: Set[str] = set()</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">48</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.macro_values: Dict[str, str] = {}</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">49</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.blocks: List[PreprocessorBlock] = []</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">50</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.current_block_stack: List[PreprocessorBlock] = []</div>
            </div>
            <div class="code-line ">
                <div class="line-number">51</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">52</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def add_define(self, name: str, value: str = &quot;&quot;):</div>
            </div>
            <div class="code-line ">
                <div class="line-number">53</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Add a defined macro.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">54</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        self.defined_macros.add(name)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">55</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        if value:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">56</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            self.macro_values[name] = value</div>
            </div>
            <div class="code-line ">
                <div class="line-number">57</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">58</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def add_undef(self, name: str):</div>
            </div>
            <div class="code-line ">
                <div class="line-number">59</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Remove a defined macro.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">60</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        self.defined_macros.discard(name)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">61</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        self.macro_values.pop(name, None)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">62</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">63</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def is_defined(self, name: str) -&gt; bool:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">64</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Check if a macro is defined.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">65</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return name in self.defined_macros</div>
            </div>
            <div class="code-line ">
                <div class="line-number">66</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">67</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def get_macro_value(self, name: str) -&gt; str:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">68</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Get the value of a defined macro.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">69</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        return self.macro_values.get(name, &quot;&quot;)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">70</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">71</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def evaluate_condition(self, condition: str) -&gt; bool:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">72</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Evaluate a preprocessor condition.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">73</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if not condition.strip():</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">74</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return True</div>
            </div>
            <div class="code-line ">
                <div class="line-number">75</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">76</div>
                <div class="line-status"></div>
                <div class="line-content">        # Handle defined() operator</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">77</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        condition = self._expand_defined_operator(condition)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">78</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">79</div>
                <div class="line-status"></div>
                <div class="line-content">        # Handle macro expansions</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">80</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        condition = self._expand_macros(condition)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">81</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">82</div>
                <div class="line-status"></div>
                <div class="line-content">        # Simple evaluation for common patterns</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">83</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return self._evaluate_simple_expression(condition)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">84</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">85</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _expand_defined_operator(self, condition: str) -&gt; str:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">86</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Expand defined() operators in the condition.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">87</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">88</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        def replace_defined(match):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">89</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            macro_name = match.group(1)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">90</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return &quot;1&quot; if self.is_defined(macro_name) else &quot;0&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">91</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">92</div>
                <div class="line-status"></div>
                <div class="line-content">        # Replace defined(macro) with 1 or 0</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">93</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        condition = re.sub(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">94</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            r&quot;defined\s*\(\s*([a-zA-Z_][a-zA-Z0-9_]*)\s*\)&quot;, replace_defined, condition</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">95</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        )</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">96</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return condition</div>
            </div>
            <div class="code-line ">
                <div class="line-number">97</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">98</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _expand_macros(self, condition: str) -&gt; str:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">99</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Expand macros in the condition.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">100</div>
                <div class="line-status"></div>
                <div class="line-content">        # Simple macro expansion for common cases</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">101</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        for macro_name, macro_value in self.macro_values.items():</div>
            </div>
            <div class="code-line ">
                <div class="line-number">102</div>
                <div class="line-status"></div>
                <div class="line-content">            # Replace macro name with its value</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">103</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            pattern = r&quot;\b&quot; + re.escape(macro_name) + r&quot;\b&quot;</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">104</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            condition = re.sub(pattern, macro_value, condition)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">105</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return condition</div>
            </div>
            <div class="code-line ">
                <div class="line-number">106</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">107</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _evaluate_simple_expression(self, condition: str) -&gt; bool:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">108</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Evaluate simple expressions like comparisons and logical operators.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">109</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        try:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">110</div>
                <div class="line-status"></div>
                <div class="line-content">            # Handle common comparison operators</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">111</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            condition = condition.strip()</div>
            </div>
            <div class="code-line ">
                <div class="line-number">112</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">113</div>
                <div class="line-status"></div>
                <div class="line-content">            # Handle simple boolean values</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">114</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if condition.lower() in [&quot;1&quot;, &quot;true&quot;, &quot;yes&quot;]:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">115</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                return True</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">116</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if condition.lower() in [&quot;0&quot;, &quot;false&quot;, &quot;no&quot;]:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">117</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                return False</div>
            </div>
            <div class="code-line ">
                <div class="line-number">118</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">119</div>
                <div class="line-status"></div>
                <div class="line-content">            # Handle simple comparisons</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">120</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;==&quot; in condition:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">121</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                left, right = condition.split(&quot;==&quot;, 1)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">122</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                left_val = left.strip()</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">123</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                right_val = right.strip()</div>
            </div>
            <div class="code-line ">
                <div class="line-number">124</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">125</div>
                <div class="line-status"></div>
                <div class="line-content">                # If both sides are known macros, compare their values</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">126</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                if left_val in self.defined_macros and right_val in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">127</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return self.get_macro_value(left_val) == self.get_macro_value(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">128</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        right_val</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">129</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    )</div>
            </div>
            <div class="code-line ">
                <div class="line-number">130</div>
                <div class="line-status"></div>
                <div class="line-content">                # If one side is a known macro, compare with the other side</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">131</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                elif left_val in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">132</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return self.get_macro_value(left_val) == right_val</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">133</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                elif right_val in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">134</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return left_val == self.get_macro_value(right_val)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">135</div>
                <div class="line-status"></div>
                <div class="line-content">                # If neither side is a known macro, both are undefined, so they&#x27;re equal</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">136</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                else:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">137</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return True  # Both undefined macros are considered equal</div>
            </div>
            <div class="code-line ">
                <div class="line-number">138</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">139</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;!=&quot; in condition:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">140</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                left, right = condition.split(&quot;!=&quot;, 1)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">141</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                left_val = left.strip()</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">142</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                right_val = right.strip()</div>
            </div>
            <div class="code-line ">
                <div class="line-number">143</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">144</div>
                <div class="line-status"></div>
                <div class="line-content">                # If both sides are known macros, compare their values</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">145</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                if left_val in self.defined_macros and right_val in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">146</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return self.get_macro_value(left_val) != self.get_macro_value(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">147</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        right_val</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">148</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    )</div>
            </div>
            <div class="code-line ">
                <div class="line-number">149</div>
                <div class="line-status"></div>
                <div class="line-content">                # If one side is a known macro, compare with the other side</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">150</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                elif left_val in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">151</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return self.get_macro_value(left_val) != right_val</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">152</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                elif right_val in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">153</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return left_val != self.get_macro_value(right_val)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">154</div>
                <div class="line-status"></div>
                <div class="line-content">                # If neither side is a known macro, do string comparison</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">155</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                else:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">156</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return left_val != right_val</div>
            </div>
            <div class="code-line ">
                <div class="line-number">157</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">158</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;&gt;&quot; in condition:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">159</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                left, right = condition.split(&quot;&gt;&quot;, 1)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">160</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                try:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">161</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    left_val = self._evaluate_operand(left.strip())</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">162</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    right_val = self._evaluate_operand(right.strip())</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">163</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    return float(left_val) &gt; float(right_val)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">164</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                except ValueError:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">165</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    return False</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">166</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;&lt;&quot; in condition:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">167</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                left, right = condition.split(&quot;&lt;&quot;, 1)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">168</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                try:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">169</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    left_val = self._evaluate_operand(left.strip())</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">170</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    right_val = self._evaluate_operand(right.strip())</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">171</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return float(left_val) &lt; float(right_val)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">172</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                except ValueError:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">173</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return False</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">174</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;&gt;=&quot; in condition:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">175</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                left, right = condition.split(&quot;&gt;=&quot;, 1)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">176</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                try:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">177</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    left_val = self._evaluate_operand(left.strip())</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">178</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    right_val = self._evaluate_operand(right.strip())</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">179</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return float(left_val) &gt;= float(right_val)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">180</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                except ValueError:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">181</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return False</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">182</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;&lt;=&quot; in condition:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">183</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                left, right = condition.split(&quot;&lt;=&quot;, 1)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">184</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                try:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">185</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    left_val = self._evaluate_operand(left.strip())</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">186</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    right_val = self._evaluate_operand(right.strip())</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">187</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return float(left_val) &lt;= float(right_val)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">188</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                except ValueError:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">189</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    return False</div>
            </div>
            <div class="code-line ">
                <div class="line-number">190</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">191</div>
                <div class="line-status"></div>
                <div class="line-content">            # Handle logical operators</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">192</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;&amp;&amp;&quot; in condition:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">193</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                parts = condition.split(&quot;&amp;&amp;&quot;)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">194</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                return all(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">195</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    self._evaluate_simple_expression(part.strip()) for part in parts</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">196</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                )</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">197</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;||&quot; in condition:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">198</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                parts = condition.split(&quot;||&quot;)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">199</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                return any(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">200</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    self._evaluate_simple_expression(part.strip()) for part in parts</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">201</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                )</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">202</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if &quot;!&quot; in condition:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">203</div>
                <div class="line-status"></div>
                <div class="line-content">                # Simple negation</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">204</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                negated = condition.replace(&quot;!&quot;, &quot;&quot;).strip()</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">205</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                return not self._evaluate_simple_expression(negated)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">206</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">207</div>
                <div class="line-status"></div>
                <div class="line-content">            # If it&#x27;s just a macro name, check if it&#x27;s defined</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">208</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if condition in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">209</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                return True</div>
            </div>
            <div class="code-line ">
                <div class="line-number">210</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">211</div>
                <div class="line-status"></div>
                <div class="line-content">            # Try to evaluate as a number</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">212</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            try:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">213</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                return bool(int(condition))</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">214</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            except ValueError:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">215</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                pass</div>
            </div>
            <div class="code-line ">
                <div class="line-number">216</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">217</div>
                <div class="line-status"></div>
                <div class="line-content">            # Default to True for unknown conditions (backward compatibility)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">218</div>
                <div class="line-status"></div>
                <div class="line-content">            # This ensures existing tests continue to work</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">219</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return True</div>
            </div>
            <div class="code-line ">
                <div class="line-number">220</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line missing">
                <div class="line-number">221</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        except ValueError as e:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">222</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            self.logger.warning(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">223</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                &quot;Error evaluating preprocessor condition &#x27;%s&#x27;: %s&quot;, condition, e</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">224</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            )</div>
            </div>
            <div class="code-line ">
                <div class="line-number">225</div>
                <div class="line-status"></div>
                <div class="line-content">            # Default to True for unknown conditions (backward compatibility)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">226</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return True</div>
            </div>
            <div class="code-line ">
                <div class="line-number">227</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">228</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _evaluate_operand(self, operand: str) -&gt; str:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">229</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Evaluate an operand, expanding macros if they are defined.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">230</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        operand = operand.strip()</div>
            </div>
            <div class="code-line ">
                <div class="line-number">231</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">232</div>
                <div class="line-status"></div>
                <div class="line-content">        # If it&#x27;s a defined macro, return its value</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">233</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if operand in self.defined_macros:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">234</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return self.get_macro_value(operand)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">235</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">236</div>
                <div class="line-status"></div>
                <div class="line-content">        # Otherwise, return the operand as-is</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">237</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return operand</div>
            </div>
            <div class="code-line ">
                <div class="line-number">238</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">239</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def parse_preprocessor_blocks(self, tokens: List[Token]) -&gt; List[PreprocessorBlock]:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">240</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Parse preprocessor blocks from tokens.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">241</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        blocks = []</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">242</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        stack = []</div>
            </div>
            <div class="code-line ">
                <div class="line-number">243</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">244</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        i = 0</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">245</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        while i &lt; len(tokens):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">246</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            token = tokens[i]</div>
            </div>
            <div class="code-line ">
                <div class="line-number">247</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">248</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if token.type == TokenType.PREPROCESSOR:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">249</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                directive = self._parse_directive(token.value)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">250</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">251</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                if (</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">252</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    directive == PreprocessorDirective.IF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">253</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    or directive == PreprocessorDirective.IFDEF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">254</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    or directive == PreprocessorDirective.IFNDEF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">255</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                ):</div>
            </div>
            <div class="code-line ">
                <div class="line-number">256</div>
                <div class="line-status"></div>
                <div class="line-content">                    # Start new block</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">257</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    condition = self._extract_condition(token.value, directive)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">258</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    block = PreprocessorBlock(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">259</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        directive=directive,</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">260</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        condition=condition,</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">261</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        start_token=i,</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">262</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        end_token=-1,  # Will be set when we find #endif</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">263</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        is_active=self._should_activate_block(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">264</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                            directive, condition, stack</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">265</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        ),</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">266</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        children=[],</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">267</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        parent=stack[-1] if stack else None,</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">268</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    )</div>
            </div>
            <div class="code-line ">
                <div class="line-number">269</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">270</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    if stack:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">271</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        stack[-1].children.append(block)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">272</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    else:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">273</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        blocks.append(block)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">274</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">275</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    stack.append(block)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">276</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">277</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                elif directive == PreprocessorDirective.ELIF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">278</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    if stack:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">279</div>
                <div class="line-status"></div>
                <div class="line-content">                        # Update current block</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">280</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        current_block = stack[-1]</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">281</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        condition = self._extract_condition(token.value, directive)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">282</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        current_block.is_active = self._should_activate_block(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">283</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                            directive, condition, stack</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">284</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        )</div>
            </div>
            <div class="code-line ">
                <div class="line-number">285</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">286</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                elif directive == PreprocessorDirective.ELSE:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">287</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    if stack:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">288</div>
                <div class="line-status"></div>
                <div class="line-content">                        # Update current block</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">289</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        current_block = stack[-1]</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">290</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        current_block.is_active = self._should_activate_block(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">291</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                            directive, &quot;&quot;, stack</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">292</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        )</div>
            </div>
            <div class="code-line ">
                <div class="line-number">293</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">294</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                elif directive == PreprocessorDirective.ENDIF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">295</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    if stack:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">296</div>
                <div class="line-status"></div>
                <div class="line-content">                        # End current block</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">297</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        current_block = stack.pop()</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">298</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        current_block.end_token = i</div>
            </div>
            <div class="code-line ">
                <div class="line-number">299</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line missing">
                <div class="line-number">300</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                elif directive == PreprocessorDirective.DEFINE:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">301</div>
                <div class="line-status"></div>
                <div class="line-content">                    # Handle #define</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">302</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    macro_name, macro_value = self._parse_define(token.value)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">303</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    self.add_define(macro_name, macro_value)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">304</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line missing">
                <div class="line-number">305</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                elif directive == PreprocessorDirective.UNDEF:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">306</div>
                <div class="line-status"></div>
                <div class="line-content">                    # Handle #undef</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">307</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    macro_name = self._parse_undef(token.value)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">308</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    self.add_undef(macro_name)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">309</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">310</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            i += 1</div>
            </div>
            <div class="code-line ">
                <div class="line-number">311</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">312</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return blocks</div>
            </div>
            <div class="code-line ">
                <div class="line-number">313</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">314</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _parse_directive(self, value: str) -&gt; PreprocessorDirective:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">315</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Parse the directive type from a preprocessor token.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">316</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        value = value.strip()</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">317</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if value.startswith(&quot;#ifdef&quot;):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">318</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return PreprocessorDirective.IFDEF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">319</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif value.startswith(&quot;#ifndef&quot;):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">320</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return PreprocessorDirective.IFNDEF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">321</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif value.startswith(&quot;#if&quot;):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">322</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return PreprocessorDirective.IF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">323</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif value.startswith(&quot;#elif&quot;):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">324</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return PreprocessorDirective.ELIF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">325</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif value.startswith(&quot;#else&quot;):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">326</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return PreprocessorDirective.ELSE</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">327</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif value.startswith(&quot;#endif&quot;):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">328</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return PreprocessorDirective.ENDIF</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">329</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        elif value.startswith(&quot;#define&quot;):</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">330</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return PreprocessorDirective.DEFINE</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">331</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        elif value.startswith(&quot;#undef&quot;):</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">332</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return PreprocessorDirective.UNDEF</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">333</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        else:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">334</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return PreprocessorDirective.IF  # Default</div>
            </div>
            <div class="code-line ">
                <div class="line-number">335</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">336</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _extract_condition(self, value: str, directive: PreprocessorDirective) -&gt; str:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">337</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Extract the condition from a preprocessor directive.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">338</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        value = value.strip()</div>
            </div>
            <div class="code-line ">
                <div class="line-number">339</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">340</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if directive == PreprocessorDirective.IFDEF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">341</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            match = re.search(r&quot;#ifdef\s+([a-zA-Z_][a-zA-Z0-9_]*)&quot;, value)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">342</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return match.group(1) if match else &quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">343</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif directive == PreprocessorDirective.IFNDEF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">344</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            match = re.search(r&quot;#ifndef\s+([a-zA-Z_][a-zA-Z0-9_]*)&quot;, value)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">345</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return match.group(1) if match else &quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">346</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif directive == PreprocessorDirective.IF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">347</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            match = re.search(r&quot;#if\s+(.+)&quot;, value)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">348</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return match.group(1).strip() if match else &quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">349</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif directive == PreprocessorDirective.ELIF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">350</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            match = re.search(r&quot;#elif\s+(.+)&quot;, value)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">351</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return match.group(1).strip() if match else &quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">352</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        else:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">353</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return &quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">354</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">355</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _parse_define(self, value: str) -&gt; Tuple[str, str]:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">356</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Parse #define directive.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">357</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        value = value.strip()</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">358</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        match = re.search(r&quot;#define\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*(.+)&quot;, value)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">359</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        if match:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">360</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            name = match.group(1)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">361</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            macro_value = match.group(2).strip()</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">362</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return name, macro_value</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">363</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        return &quot;&quot;, &quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">364</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">365</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _parse_undef(self, value: str) -&gt; str:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">366</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Parse #undef directive.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">367</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        value = value.strip()</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">368</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        match = re.search(r&quot;#undef\s+([a-zA-Z_][a-zA-Z0-9_]*)&quot;, value)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">369</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">        return match.group(1) if match else &quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">370</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">371</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _should_activate_block(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">372</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self,</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">373</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        directive: PreprocessorDirective,</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">374</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        condition: str,</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">375</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        stack: List[PreprocessorBlock],</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">376</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    ) -&gt; bool:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">377</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Determine if a block should be active based on its directive and condition.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">378</div>
                <div class="line-status"></div>
                <div class="line-content">        # Check if parent blocks are active</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">379</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if stack and not stack[-1].is_active:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">380</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return False</div>
            </div>
            <div class="code-line ">
                <div class="line-number">381</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">382</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if directive == PreprocessorDirective.IFDEF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">383</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return self.is_defined(condition)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">384</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif directive == PreprocessorDirective.IFNDEF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">385</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return not self.is_defined(condition)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">386</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif directive == PreprocessorDirective.IF:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">387</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return self.evaluate_condition(condition)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">388</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif directive == PreprocessorDirective.ELIF:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">389</div>
                <div class="line-status"></div>
                <div class="line-content">            # For #elif, we need to check if no previous branch was taken</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">390</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if stack:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">391</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                parent = stack[-1]</div>
            </div>
            <div class="code-line ">
                <div class="line-number">392</div>
                <div class="line-status"></div>
                <div class="line-content">                # Check if any previous child was active</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">393</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                for child in parent.children:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">394</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    if child.is_active:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">395</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                        return False</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">396</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                return self.evaluate_condition(condition)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">397</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return False</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">398</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        elif directive == PreprocessorDirective.ELSE:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">399</div>
                <div class="line-status"></div>
                <div class="line-content">            # For #else, we need to check if no previous branch was taken</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">400</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if stack:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">401</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                parent = stack[-1]</div>
            </div>
            <div class="code-line ">
                <div class="line-number">402</div>
                <div class="line-status"></div>
                <div class="line-content">                # Check if any previous child was active</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">403</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                for child in parent.children:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">404</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    if child.is_active:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">405</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                        return False</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">406</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                return True</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">407</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return False</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">408</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        else:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">409</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            return False</div>
            </div>
            <div class="code-line ">
                <div class="line-number">410</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">411</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def filter_tokens(self, tokens: List[Token]) -&gt; List[Token]:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">412</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Filter tokens based on preprocessor blocks, keeping only active content.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">413</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        blocks = self.parse_preprocessor_blocks(tokens)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">414</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        filtered_tokens = []</div>
            </div>
            <div class="code-line ">
                <div class="line-number">415</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">416</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        i = 0</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">417</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        while i &lt; len(tokens):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">418</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            token = tokens[i]</div>
            </div>
            <div class="code-line ">
                <div class="line-number">419</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">420</div>
                <div class="line-status"></div>
                <div class="line-content">            # Check if this token is inside a preprocessor block</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">421</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            in_active_block = self._is_token_in_active_block(i, blocks)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">422</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">423</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if in_active_block:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">424</div>
                <div class="line-status"></div>
                <div class="line-content">                # Include the token if it&#x27;s not a preprocessor directive</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">425</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                if token.type != TokenType.PREPROCESSOR:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">426</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    filtered_tokens.append(token)</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">427</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            else:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">428</div>
                <div class="line-status"></div>
                <div class="line-content">                # Skip tokens that are not in active blocks</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">429</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                pass</div>
            </div>
            <div class="code-line ">
                <div class="line-number">430</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">431</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            i += 1</div>
            </div>
            <div class="code-line ">
                <div class="line-number">432</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">433</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return filtered_tokens</div>
            </div>
            <div class="code-line ">
                <div class="line-number">434</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">435</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _is_token_in_active_block(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">436</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self, token_index: int, blocks: List[PreprocessorBlock]</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">437</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    ) -&gt; bool:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">438</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Check if a token is inside an active preprocessor block.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">439</div>
                <div class="line-status"></div>
                <div class="line-content">        # Check all blocks recursively</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">440</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        for block in blocks:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">441</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if self._is_token_in_block(token_index, block):</div>
            </div>
            <div class="code-line ">
                <div class="line-number">442</div>
                <div class="line-status"></div>
                <div class="line-content">                # If token is in this block, return whether the block is active</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">443</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                return block.is_active</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">444</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return True  # Default to True if not in any block</div>
            </div>
            <div class="code-line ">
                <div class="line-number">445</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">446</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def _is_token_in_block(self, token_index: int, block: PreprocessorBlock) -&gt; bool:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">447</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Check if a token is inside a specific block.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">448</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if block.start_token &lt;= token_index &lt;= block.end_token:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">449</div>
                <div class="line-status"></div>
                <div class="line-content">            # Check if any child block contains this token</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">450</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            for child in block.children:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">451</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                if self._is_token_in_block(token_index, child):</div>
            </div>
            <div class="code-line ">
                <div class="line-number">452</div>
                <div class="line-status"></div>
                <div class="line-content">                    # If token is in a child block, return whether the child is active</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">453</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                    return child.is_active</div>
            </div>
            <div class="code-line ">
                <div class="line-number">454</div>
                <div class="line-status"></div>
                <div class="line-content">            # Token is in this block but not in any child block</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">455</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            return True</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">456</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return False</div>
            </div>
            <div class="code-line ">
                <div class="line-number">457</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">458</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">459</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">class PreprocessorManager:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">460</div>
                <div class="line-status"></div>
                <div class="line-content">    &quot;&quot;&quot;High-level interface for preprocessor management.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line ">
                <div class="line-number">461</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">462</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def __init__(self):</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">463</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.evaluator = PreprocessorEvaluator()</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">464</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.logger = logging.getLogger(__name__)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">465</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">466</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def process_file(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">467</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self, tokens: List[Token], defines: Optional[Dict[str, str]] = None</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">468</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    ) -&gt; List[Token]:</div>
            </div>
            <div class="code-line ">
                <div class="line-number">469</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Process a file&#x27;s tokens through the preprocessor.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">470</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        if defines:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">471</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">            for name, value in defines.items():</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">472</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                self.evaluator.add_define(name, value)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">473</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line ">
                <div class="line-number">474</div>
                <div class="line-status"></div>
                <div class="line-content">        # Filter tokens based on preprocessor directives</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">475</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        filtered_tokens = self.evaluator.filter_tokens(tokens)</div>
            </div>
            <div class="code-line ">
                <div class="line-number">476</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">477</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        self.logger.debug(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">478</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            f&quot;Preprocessor: {len(tokens)} tokens -&gt; {len(filtered_tokens)} tokens&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">479</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        )</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">480</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        return filtered_tokens</div>
            </div>
            <div class="code-line ">
                <div class="line-number">481</div>
                <div class="line-status"></div>
                <div class="line-content"></div>
            </div>
            <div class="code-line covered">
                <div class="line-number">482</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">    def add_defines_from_content(self, tokens: List[Token]):</div>
            </div>
            <div class="code-line ">
                <div class="line-number">483</div>
                <div class="line-status"></div>
                <div class="line-content">        &quot;&quot;&quot;Extract #define directives from tokens and add them to the evaluator.&quot;&quot;&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">484</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">        for token in tokens:</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">485</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            if token.type == TokenType.PREPROCESSOR and token.value.startswith(</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">486</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">                &quot;#define&quot;</div>
            </div>
            <div class="code-line covered">
                <div class="line-number">487</div>
                <div class="line-status">&#10004;</div>
                <div class="line-content">            ):</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">488</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                name, value = self.evaluator._parse_define(token.value)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">489</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                if name:</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">490</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    self.evaluator.add_define(name, value)</div>
            </div>
            <div class="code-line missing">
                <div class="line-number">491</div>
                <div class="line-status">&#10008;</div>
                <div class="line-content">                    self.logger.debug(&quot;Preprocessor: Added define %s = %s&quot;, name, value)</div>
            </div>
        </div>
    </div>

    <div class="legend">
        <h3 style="margin-top: 0;">Legend</h3>
        <div class="legend-item">
            <span class="legend-color" style="background: #e8f5e9;"></span>
            <span>&#10004; Covered</span>
        </div>
        <div class="legend-item">
            <span class="legend-color" style="background: #ffebee;"></span>
            <span>&#10008; Not Covered</span>
        </div>
        <div class="legend-item">
            <span class="legend-color" style="background: #f5f5f5;"></span>
            <span>&#8212; Excluded</span>
        </div>
    </div>
</body>
</html>
