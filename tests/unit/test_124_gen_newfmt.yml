test:
  name: "Generator â€“ New Formatting Stereotypes Comprehensive"
  description: Validate stereotypes and content for enums, structs, unions, function pointers, and aliases
  category: unit
  id: '124'
  steps: ["generate"]
---
source_files:
  model.json: |
    {
      "project_name": "test_project",
      "source_folder": "/test",
      "files": {
        "test.c": {
          "file_path": "test.c",
          "name": "test.c",
          "includes": [],
          "macros": [],
          "enums": {
            "Color": {
              "name": "Color",
              "values": [
                {"name": "RED", "value": "0"},
                {"name": "GREEN", "value": "1"},
                {"name": "BLUE", "value": "2"}
              ]
            }
          },
          "structs": {
            "Person": {
              "name": "Person",
              "fields": [
                {"name": "id", "type": "int"},
                {"name": "name", "type": "char*"},
                {"name": "age", "type": "int"}
              ]
            }
          },
          "unions": {
            "Data": {
              "name": "Data",
              "fields": [
                {"name": "as_int", "type": "int"},
                {"name": "as_float", "type": "float"},
                {"name": "as_char", "type": "char"}
              ]
            }
          },
          "aliases": {
            "callback_t": {"name": "callback_t", "original_type": "int(* callback_t)(int, int)"},
            "log_callback_t": {"name": "log_callback_t", "original_type": "void(* log_callback_t)(const char*)"},
            "String": {"name": "String", "original_type": "char*"},
            "Integer": {"name": "Integer", "original_type": "int"}
          },
          "functions": [],
          "globals": []
        }
      },
      "include_relations": []
    }
---
config.json: |
  {
    "project_name": "test_project",
    "source_folders": ["src"],
    "output_dir": "output",
    "use_short_names": false,
    "group_by_visibility": true
  }
---
assertions:
  execution:
    exit_code: 0
  puml:
    syntax_valid: true
    files:
      test.c.puml:
        contains_lines:
          - 'class "Color" as TYPEDEF_COLOR <<enumeration>> #LightYellow'
          - 'RED = 0'
          - 'GREEN = 1'
          - 'BLUE = 2'
          - 'class "Person" as STRUCT_PERSON <<struct>>'
          - '+ int id'
          - '+ char* name'
          - '+ int age'
          - 'class "Data" as UNION_DATA <<union>>'
          - '+ int as_int'
          - '+ float as_float'
          - '+ char as_char'
          - 'class "callback_t" as TYPEDEF_CALLBACK_T <<function pointer>> #LightYellow'
          - 'class "log_callback_t" as TYPEDEF_LOG_CALLBACK_T <<function pointer>> #LightYellow'
          - 'alias of int(* callback_t)(int, int)'
          - 'alias of void(* log_callback_t)(const char*)'
          - 'class "String" as ALIAS_STRING <<typedef>>'
          - 'class "Integer" as ALIAS_INTEGER <<typedef>>'
          - 'original_type: char*'
          - 'original_type: int'
